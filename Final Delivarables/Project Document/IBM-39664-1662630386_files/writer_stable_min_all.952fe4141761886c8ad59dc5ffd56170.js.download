function defineWithValue(t){return{enumerable:!1,writable:!1,value:t}}function DTContextUtils(){}function Utils(){}function DocUtil(){}function DocOp(){this.characters=null,this.retain_count=null,this.delete_characters=null,this.styles=null,this.insertStyles=[],this.integralStyles=[],this.isPriorityOp=!1,this.lock_data=null,this._len=0}function _docop(){var t;return{type:t}}function InsertOp(t){this.type=DOCOP_TYPE_INSERT,this.chars=t,this.cut=function(t,e){var n=this.chars.substring(t,e);return this.chars=this.chars.substring(e),new InsertOp(n)},this.length=function(){return this.chars.length()},this.toString=function(){return"{'is':'"+Utils.escapeSplChars(this.chars)+"'}"},this.toJSON=function(){return{is:this.chars}},this.clone=function(){return new InsertOp(this.chars)}}function RetainOp(t){this.type=DOCOP_TYPE_RETAIN,this.retain=t,this.cut=function(t){return this.retain-=t,new RetainOp(t)},this.length=function(){return t},this.toString=function(){return"{'r':"+this.retain+"}"},this.toJSON=function(){return{r:this.retain}},this.clone=function(){return new RetainOp(this.retain)}}function DeleteOp(t,e){this.type=DOCOP_TYPE_DELETE,this.chars=t,this.priority=!!e,this.cut=function(t,e){var n=this.chars.substring(t,e);return this.chars=this.chars.substring(e),new DeleteOp(n)},this.length=function(){return this.chars.length()},this.toString=function(){return"{'ds':'"+Utils.escapeSplChars(this.chars)+"'}"},this.toJSON=function(){return{ds:this.chars}},this.clone=function(){return new DeleteOp(this.chars,this.priority)}}function StartStyleOp(t){this.type=DOCOP_TYPE_STYLESTART,this.styles=DocUtil.copyStyle(t),this.toString=function(){return"{'as':{'start':"+JSON.stringify(this.styles)+"}}"},this.toJSON=function(){return{as:{start:this.styles}}},this.clone=function(){return new StartStyleOp(this.styles)}}function EndStyleOp(t){this.type=DOCOP_TYPE_STYLEEND,this.styles=DocUtil.copyStyle(t),this.toString=function(){return"{'as':{'end':"+JSON.stringify(this.styles)+"}}"},this.clone=function(){return new EndStyleOp(this.styles)},this.toJSON=function(){return{as:{end:this.styles}}}}function HiddenRangeOp(t,e,n,r,i,o,s){this.range=t,this.originalRange=t,this.chars=e,this.rangeTypes=n&&n.length?this.cloneRangeTypes(n):n,this.contentStyleOp=r,this.style=i,this.originAction=o,this.id=s||Utils.randomString(),this.prevOp=null,this.nextOp=null}function TCOp(t,e,n,r,i,o,s){this.range=t,this.action=e,this.zuid=n,this.chars=r,this.style=i,this.originAction=o,this.contentStyleOp=s}function LockOp(t,e){this.type=DOCOP_TYPE_LOCK,this.lockData=DocUtil.copyStyle(e),this.range=t,this.origRange=t,this.cut=function(t){return this.range-=t,new LockOp(t,this.lockData)},this.clone=function(){return new LockOp(this.range,this.lockData)},this.length=function(){return this.range},this.toString=function(){return"{'lk':'"+JSON.stringify(this.lockData)+"'}"},this.toJSON=function(){return{lk:{range:this.range,data:this.lockData}}}}function HiddenRangeCharOp(t,e,n,r){this.range=1,this.rangeChar=t,this.rangeTypes=e&&e.length?this.cloneRangeTypes(e):e,this.id=n||Utils.randomString(),this.prevOp=null,this.nextOp=null,this.isIfConditionShown=r||!1}function DocOpBuilder(){this.docOps=[],this.zuid=null,this.isLock=!1,this.isRedact=!1,this.redactContent="",this.isInsideRedact=!1,this.cursor=[]}function DTUpdateQueue(){this.nodesMap={},this.length=0}function PUtil(){}function BucketArray(){function t(){this.start=0,this.array=[],this.next=null,this.prev=null}function e(t){if(s&&s.start<t&&t<s.start+s.array.length)return s;for(var e=0,n=c.length;e<n&&c[e].start<=t;e++);return s=c[e-1],c[e-1]}function n(n,i){var o=new t;o.start=n,o.array=i;var s=e(n);return r(s,o),c.splice(s?c.indexOf(s)+1:0,0,o),o}function r(t,e){return t?(e.prev=t,e.next=t.next,e.next&&(e.next.prev=e),void(t.next=e)):e}function i(t,e){for(;t;)t.start+=e,t=t.next}function o(t){if(t&&t.array.length>=d){var e=t.array.splice(l),r=t.start+l;bkt_new=n(r,e)}}var s,a=1e4,l=a,d=2*a,c=[];return{getbuckets:function(){return c},initBucketSize:function(t){var e=a;t>4e5&&(e=1e5),l=e,d=2*l},init:function(t){if(t&&t.splice){c=[];var e=t,r=0;do{var i=e.splice(l);n(r,e),r+=e.length,e=i}while(0!=Math.round(e.length/l))}},get:function(t){var n=e(t);if(!n)throw ZWLogger.log("Index out of bounds. Invalid index. Idx : "+t),"Index out of bounds. Invalid index.";return n.array[t-n.start]},set:function(t,n){var r=e(t);if(!r)throw ZWLogger.log("Index out of bounds. Invalid index. Idx : "+t),"Index out of bounds. Invalid index.";var i=t-r.start;r.array[i]=n},remove:function(t,n){var r=e(t);if(!r)throw ZWLogger.log("Index out of bounds. Invalid index. Idx : "+t),"Index out of bounds. Invalid index.";for(;n&&r;){var o=t-r.start,s=r.array.length-o,a=n>s?s:n;if(r.array.splice(o,a),i(r.next,-a),0==r.array.length){var l=r.next;if(r.prev&&(r.prev.next=r.next),r.next&&(r.next.prev=r.prev),c.splice(r?c.indexOf(r):0,1),r=l,!r)break;t=r.start}else r=r.next,t=r?r.start:0;n-=a}},put:function(t,n){var r=e(t);if(!r)throw ZWLogger.log("Index out of bounds. Invalid index. Idx : "+t),"Index out of bounds. Invalid index.";var s=r.array,a=t-r.start;s.splice(a,0,n),i(r.next,1),o(r)},push:function(t){var e=c[c.length-1];e||(e=n(0,[])),e.array.push(t),o(e)},getBetweenIdx:function(t,n){var r,i,o,s=[];for(r=e(t);r&&(i=r.start,o=i+r.array.length,o=n<o?n-i:r.array.length,s=s.concat(r.array.slice(t-i,o)),t=i+r.array.length,r=r.next,o+i!=n););return s},getFormats:function(){var t,e,n,r,i=[],o=[],s=this.getbuckets(),a=s.length;for(t=0;t<a;t++)for(n=s[t],o=n.array,e=0,r=n.array.length;e<r;e++)i.push(o[e]);return i}}}var isV8Engine="undefined"==typeof window||"undefined"==typeof navigator,_stopPagination=isV8Engine;if(isV8Engine){window=this;var fingerPrintObj={};docsComponentjsMoveSource="",docsComponentcssMoveSource="",docsComponentjsSaveasSource="",docsComponentjsSource="",docsComponentcssSource="",pasteHtmlSanitizerJs=""}var U=_.noConflict();window.isHeadlessPDF=!(!window.editorProps||!editorProps.isHeadlessPDF),window.isHeadlessHTML=!(!window.editorProps||!editorProps.isHeadlessHTML);for(var mmPreviewWithFormula=!1,CONST=JSON.parse('{"MERGEFIELD":"mergeField","NEXTRECORD":"nextrecord","SKIPRECORD":"skiprecord","TOC_PREV_PARA":"tocBr","TOC_MAIN_DIV":"toc","TOC_REGENERATE":"tocRegenerate","TOC_CLOSE":"tocClose","TOC_SETTINGS":"tocSettings","ZERO_WIDTH_SPACE":"&#8203;","ZERO_WIDTH_JOINER":"&zwj;","ZERO_WIDTH_NON_JOINER":"&zwnj;","PG_SPLIT_NODE":"pagesplitnode","PG_SPLIT_LAYER":"split-layer","PG_BRK_LAYER":"pagebreaklayer","FN_LAYER":"footnoteslayer","FIELD_TEXT_NODE":"field_text_node","FTR_LAYER":"footerlayer","PRI_PG_FTR":"primarypagefooter","HDR_LAYER":"headerlayer","PRI_PG_HDR":"primarypageheader","MUST_PAGINATE":-1,"STATE_STARTED":0,"HEADER_EVEN":0,"HEADER_PRIMARY":1,"FOOTER_EVEN":2,"FOOTER_PRIMARY":3,"HEADER_FIRST":4,"FOOTER_FIRST":5,"STATE_COMPLETE":1,"PASTE_SOURCEFORMAT":0,"PORTION_END_WITHOUT_TAB":"PORTION_END_WITHOUT_TAB","PASTE_DESTINATIONFORMAT":1,"PASTE_TEXTONLYFORMAT":2,"PASTE_CONTINUELIST":3,"PASTE_ASNEWLIST":4,"PASTE_MERGELIST":5,"PASTE_DONT_MERGELIST":6,"PASTE_CHART":7,"PASTE_SHEET_TABLE":8,"PASTE_SCREENPLAY_PASTE" : 9,"DEFAULT_AUTO_CORRECTS":["(c)","(r)","(tm)","1/4","1/2","3/4","-->","<--","<->","==>","<==","<=>"],"CLEAN_MODE":0,"RICH_EDIT_MODE":1,"REVIEW_MODE":2,"MSG_TYPE_CONFIRM":1,"MSG_TYPE_RELOAD":2,"MSG_TYPE_RELOADCANCEL":3,"MSG_TYPE_YESNO":4,"MSG_TYPE_ALERT":5,"MSG_TYPE_CUSTOM":6,"MSG_TYPE_REPORT":7,"MSG_TYPE_DELETECANCEL":8,"SEVERITY_WARNING":"warning","SEVERITY_ALERT":"alert","SEVERITY_INFO":"info","SEVERITY_ERROR":"error","SEVERITY_SUCCESS":"success","BUTTON_1_CLICKED":1,"BUTTON_2_CLICKED":2,"BUTTON_3_CLICKED":3,"BUTTON_OK_CLICKED":1,"BUTTON_RELOAD_CLICKED":1,"BUTTON_YES_CLICKED":1,"BUTTON_CANCEL_CLICKED":2,"BUTTON_NO_CLICKED":2,"PAGE_BOTTOM_MARGIN_BORDERS":25,"DEFAULT_PAPER":"Letter","DEFAULT_ORIENTATION":"Portrait","MIN_COLUMN_WIDTH":"1.27cm","MIN_CELL_WIDTH":"20px","MIN_PAPER_HEIGHT":"0.1in","MIN_PAPER_WIDTH":"0.5in","MAX_PAPER_SIZE":"22in","MIN_READING_TIME":"2000"}'),FILLABLEFIELD_TYPE=JSON.parse('{"CHECKBOX":"checkbox","CURRENCY":"currency","DATE":"date","EMAIL":"email","NUMBER":"number","PHONE":"phone","PERCENT":"percent","SELECTBOX":"selectbox","SINGLELINE":"singleline","IMAGE":"image","INITIAL":"initial","SIGNATURE":"signature","MULTILINE" : "multiline", "MULTIPLECHOICE": "multiplechoice", "RADIO": "radio"}'),FILLABLEFIELD_PROPS=JSON.parse('{"CHECKED_SYMBOL":"☑","UNCHECKED_SYMBOL":"☐","DATE_FORMAT":"dd/MM/yyyy, HH:mm", "CIRCLE_SYMBOL":"○", "DISC_SYMBOL" : "◉"}'),DOC_PARA_STYLES=["h0","h101","h102","h1","h2","h3","h4","h5","h6","h103"],SUPPORTED_SUPPORTED_MIME_TYPES=["application/msword","application/x-tika-msoffice","application/vnd.ms-word","application/msoffice","application/x-msoffice","application/x-tika-ooxml","application/vnd.ms-word.document.macroenabled.12","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/zip","application/ooxml","application/x-xliff+zip","application/x-ooxml","application/rtf","application/vnd.oasis.opendocument.text","application/pdf","text/plain","text/html","application/xml","application/xhtml+xml","application/x-tex","application/x-latex","application/octet-stream","message/rfc822","application/vnd.openxmlformats-officedocument.wordprocessingml.template","application/vnd.ms-word.document.macroEnabled.12","application/vnd.ms-word.template.macroEnabled.12"],CHAR_TAG_MAPPING=JSON.parse('{"1":"Subtle Emphasis","2":"Emphasis","3":"Intense Emphasis","4":"Strong","5":"Subtle Reference","6":"Intense Reference","7":"Book Title"}'),NODE_NAME=JSON.parse('{"HTML":"html","HEAD":"head","META":"meta","LINK":"link","STYLE":"style","BODY":"body","DIV":"div","HR":"hr","P":"p","SPAN":"span","TABLE":"table","TBODY":"tbody","TR":"tr","TD":"td","A":"a","IMAGE":"img"}'),DISPLAY_TYPE={BUTTON:"button"},NODE_TYPE=JSON.parse('{"BODY":"body","PARA":"para","PARAGRAPH":"paragraph","TAB":"tab","TEXT":"text","IMAGE":"image","IFRAME":"iframe","HR":"hr","BR":"br","TABLE":"table","TABLEEND":"tableend","TBODY":"tbody","ROW":"row","RUN":"run","BOOKMARK":"bookmark","FIELD_START":"fieldstart","FIELD_END":"fieldend","CELL":"cell","LINK":"link","WORD":"word","HEADER_PRIMARY":"header_primary","HEADER_FIRST":13,"HEADER_ODD":14,"FOOTER_PRIMARY":"footer_primary","FOOTER_FIRST":16,"FOOTER_ODD":17,"FOOTNOTE":"footnote","ENDNOTE":"endnote","COMMENT":"comment","SECTION":"section","AUTOFIELD":"autofield","FILLABLEFIELD":"fillablefield","MAILMERGEFIELD":"mergeField","NEXTRECORD":"nextrecord","PLACEHOLDER":"placeholder","TOC":"toc","TOCEND":"tocend","WIDGET":"widget","SIGNERFIELD":"signerfield","CONDITIONAL_IF_START":"conditional_if_start","CONDITIONAL_IF_END":"conditional_if_end","CONDITIONAL_ELSE_SEPARATOR":"conditional_else_seperator","SHAPE":"shape","CHART":"chart","NAMED_RANGE":"namedrange","QRCODE":"QRCode","BARCODE":"BarCode","TEXTBOX":"textbox","REPEAT_START":"repeat_start","REPEAT_END":"repeat_end","TAG":"tag"}'),LIST_TYPE=JSON.parse('{"TOC_TYPE_1":128,"NONE":255,"DECIMAL":0,"LOWER_ALPHA":4,"UPPER_ALPHA":3,"LOWER_ROMAN":2,"UPPER_ROMAN":1,"ORDINAL":5,"DISC":6,"CIRCLE":7,"BOX":8,"SYMBOL":9,"IMAGE":10,"RECENT_ORDER":0,"RECENT_UNORDER":6,"CHECKLIST":256, "IDEOGROPHICAL_TRADITIONAL": 30}'),MAX_LIST_LEVELS=8,LIST={LIST_ADDED:"List/newList/added"},LIST_PNG_PATH="images/common/list/png/bullet-",SVG_FOR_LISTS={},SVG_LIST_MAPPING={1:'<svg viewBox="0 0 32 32"><polygon fill="#658aaa" points="1 28 8 16 31 16 1 28"/><polygon fill="#8ac4e0" points="8 16 1 4 31 16 8 16"/></svg>',2:'<svg viewBox="0 0 32 32"><path fill="#585b70" d="M30.67,3.25a1,1,0,0,0-1.39.06L10,23.57,4.71,18.29a1,1,0,0,0-1.54.15l-2,3A1,1,0,0,0,1.4,22.8l8,6a1,1,0,0,0,1.37-.16l20-24A1,1,0,0,0,30.67,3.25Z"/></svg>',3:'<svg viewBox="0 0 32 32"><rect fill="#ff6d7a" x="2.05" y="11.06" width="9.9" height="9.9" transform="translate(-9.27 9.64) rotate(-45)"/><rect fill="#fbb900" x="20.05" y="11.05" width="9.9" height="9.9" transform="translate(-3.99 22.37) rotate(-45)"/><rect fill="#94afeb" x="11.05" y="2.05" width="9.9" height="9.9" transform="translate(-0.26 13.37) rotate(-45)"/><rect fill="#5ec78f" x="11.05" y="20.06" width="9.9" height="9.9" transform="translate(-13 18.64) rotate(-45)"/></svg>',4:'<svg viewBox="0 0 32 32"><rect fill="#78c56c" x="4.69" y="4.68" width="22.63" height="22.63" transform="translate(-6.63 16) rotate(-45)"/><polygon fill="#009440" points="19 15.99 16 12.99 16 4.99 27 15.99 19 15.99"/><polygon fill="#31b644" points="16 26.99 16 18.99 19 15.99 27 15.99 16 26.99"/><polygon fill="#009440" points="16 26.99 5 15.99 13 15.99 16 18.99 16 26.99"/><polygon fill="#31b644" points="13 15.99 5 15.99 16 4.99 16 12.99 13 15.99"/></svg>',5:'<svg viewBox="0 0 32 32"><circle fill="#7ed3fc" cx="16" cy="16" r="15"/><path fill="#51c8f7" d="M16,1A15,15,0,0,0,1,16H16V1Z"/><path fill="#51c8f7" d="M16,31A15,15,0,0,0,31,16H16V31Z"/><circle fill="#d2f0ff" cx="16" cy="16" r="8"/></svg>',6:'<svg viewBox="0 0 32 32"><polygon fill="#ffbc3a" points="15.99 3.83 20.05 11.7 28.8 13.13 22.57 19.42 23.91 28.17 15.99 24.18 8.1 28.17 9.44 19.42 3.21 13.13 11.95 11.7 15.99 3.83"/><path fill="#ffa73d" d="M29.75,12.82A1,1,0,0,0,29,12.14l-8.24-1.35L16.88,3.37a1,1,0,0,0-1.78,0l-3.82,7.42L3,12.14a1,1,0,0,0-.55,1.69l5.88,5.93L7.11,28a1,1,0,0,0,1.44,1L16,25.3l7.46,3.76a1,1,0,0,0,1.44-1l-1.26-8.25,5.88-5.93A1,1,0,0,0,29.75,12.82Zm-7.89,5.9a1,1,0,0,0-.28.86l1,6.83-6.18-3.12a1,1,0,0,0-.9,0L9.38,26.4l1-6.83a1,1,0,0,0-.28-0.86L5.28,13.8l6.83-1.12a1,1,0,0,0,.73-0.53L16,6l3.17,6.15a1,1,0,0,0,.73.53l6.83,1.12Z"/></svg>',7:'<svg viewBox="0 0 32 32"><circle fill="#d31317" cx="16" cy="16.01" r="14"/><polygon fill="#fff" points="24.32 27.32 16.02 21.43 7.81 27.5 10.38 17.73 2.55 11.84 12.31 11.48 15.81 2 19.48 11.4 29.26 11.56 21.57 17.61 24.32 27.32"/></svg>',8:'<svg viewBox="0 0 32 32"><polygon points="16.01 3 16.01 3.01 16.02 3.04 16.01 3"/><polygon fill="#f3b7b9" points="16.01 3.01 16 3 16 3.05 16.01 3.01"/><polygon fill="#00b390" points="16 20 31 29 19.76 18.17 16.02 3.04 16.01 3.01 16 3.05 16 20"/><polygon fill="#00c1aa" points="31 29 16 20 1 29 16.01 24.66 31 29"/><polygon fill="#75d68e" points="16 3.05 12.26 18.17 1 29 16 20 16 3.05"/></svg>',9:'<svg viewBox="0 0 32 32"><circle fill="#3d3d47" cx="16" cy="16" r="15"/><circle fill="#008fd0" cx="16" cy="16" r="11"/><circle fill="#e93f4b" cx="16" cy="16" r="7"/><circle fill="#fce300" cx="16" cy="16" r="3"/></svg>',10:'<svg viewBox="0 0 32 32"><path fill="#ff7284" d="M25.91,2V2.91Q17.85,6,17,15v2q0.89,9,8.94,12.1V30H6.09V29.06Q14.15,26,15,17V15Q14.15,6,6.09,2.91V2H25.91Z"/><path fill="#c14768" d="M17,15q9-.89,12.12-8.94H30V25.91H29.09Q25.88,17.88,17,17c0.59,6-2.52,6-1.93,0Q6,17.9,2.94,25.91H2V6.09H2.94Q6.07,14.15,15,15C14.45,9,17.56,9,17,15Z"/></svg>',11:'<svg viewBox="0 0 32 32"><path fill="#5079c0" d="M7,0A1,1,0,0,0,6,1V31a1,1,0,0,0,2,0V1A1,1,0,0,0,7,0Z"/><path fill="#fe5c42" d="M25.41,9.09l-18-8A1,1,0,0,0,6,2V18a1,1,0,0,0,1.41.91l18-8A1,1,0,0,0,25.41,9.09Z"/></svg>',12:'<svg viewBox="0 0 32 32"><path fill="#c2919c" d="M1,23H9.26A8,8,0,0,1,17,17h5c-2.28,3.36-1,8-1,8,2.08-5.27,10-9,10-9H5.13A8,8,0,0,0,1,23Z"/><path fill="#a4707b" d="M21,7s-1.28,4.64,1,8H17A8,8,0,0,1,9.26,9H1a8,8,0,0,0,4.13,7H31S23.08,12.27,21,7Z"/></svg>',13:'<svg viewBox="0 0 32 32"><circle fill="#ff846f" cx="16" cy="16" r="13"/><path fill="#2889af" d="M3,16a13,13,0,0,1,26,0,6.51,6.51,0,0,1-13,0A6.53,6.53,0,0,0,3,16Z"/><circle fill="#2889af" cx="9" cy="16" r="2"/><circle fill="#ff846f" cx="23" cy="16" r="2"/></svg>',14:'<svg viewBox="0 0 32 32"><defs><style>.a{fill:#bfa58b;}.b{fill:#585b70;}</style></defs><title>bullets</title><path fill="#bfa58b" d="M29.09,7.26A0.91,0.91,0,0,0,27.6,7L24.75,9.8,23.6,9.4,23.21,8.25,26,5.4a0.91,0.91,0,0,0-.31-1.49,5.89,5.89,0,0,0-7.5,8l-6.32,6.32A5.9,5.9,0,0,0,3.5,23.58a6,6,0,0,0,.41,2.17,0.91,0.91,0,0,0,1.49.31l2.85-2.85L9.4,23.6l0.39,1.16L6.95,27.6a0.91,0.91,0,0,0,.31,1.49,5.89,5.89,0,0,0,7.5-8l6.32-6.32A5.9,5.9,0,0,0,29.5,9.42,6,6,0,0,0,29.09,7.26Z"/><path fill="#585b70" d="M28.09,6.26A0.91,0.91,0,0,0,26.6,6L23.75,8.79,22.6,8.4,22.21,7.25,25,4.4a0.91,0.91,0,0,0-.31-1.49,5.89,5.89,0,0,0-7.5,8l-6.32,6.32A5.9,5.9,0,0,0,2.5,22.58a6,6,0,0,0,.41,2.17,0.91,0.91,0,0,0,1.49.31l2.85-2.85L8.4,22.6l0.39,1.16L5.95,26.6a0.91,0.91,0,0,0,.31,1.49,5.89,5.89,0,0,0,7.5-8l6.32-6.32A5.9,5.9,0,0,0,28.5,8.42,6,6,0,0,0,28.09,6.26Z"/></svg>',15:'<svg viewBox="0 0 32 32"><path fill="#de7800" d="M12.12,6s-4,6.52,0,13c0,0-2.71.1-7-3a24.13,24.13,0,0,1,1-11l2,4Z"/><path fill="#cf6800" d="M12.64,18.94a11.31,11.31,0,0,1-1.77-6.14,14,14,0,0,1,.84-4.68,13.83,13.83,0,0,1,.58-1.38l0.19-.37,0.05-.09v0a0.5,0.5,0,0,0-.73-0.66L8.3,8.24,6.57,4.78a0.5,0.5,0,0,0-.92.07,24.63,24.63,0,0,0-1,11.23,0.5,0.5,0,1,0,1-.14h0a23.31,23.31,0,0,1,.63-9.56L7.67,9.22a0.5,0.5,0,0,0,.75.18l2.43-1.82a15.07,15.07,0,0,0-1,5.23,12.32,12.32,0,0,0,1.93,6.67A0.5,0.5,0,0,0,12.64,18.94Z"/><path fill="#fdaf33" d="M27.12,20l-6-6v4s-9,4-16-2c0,0,1.35,11,16,8v3Z"/><path fill="#e68900" d="M27.47,19.65l-6-6a0.5,0.5,0,0,0-.85.35v3.66a18.25,18.25,0,0,1-6.26,1.14,13.37,13.37,0,0,1-8.91-3.19,0.5,0.5,0,0,0-.82.44,10.64,10.64,0,0,0,1.89,4.49C8.13,22.79,11.14,25,16.4,25a23.55,23.55,0,0,0,4.22-.42V27a0.5,0.5,0,0,0,.88.33l6-7A0.5,0.5,0,0,0,27.47,19.65Zm-6,4a0.5,0.5,0,0,0-.42-0.1A23.08,23.08,0,0,1,16.4,24c-5,0-7.6-2-9.07-4.05A10,10,0,0,1,6,17.27a14.52,14.52,0,0,0,8.4,2.53,18.82,18.82,0,0,0,7-1.35,0.5,0.5,0,0,0,.3-0.46V15.21L26.44,20l-4.82,5.62V24A0.5,0.5,0,0,0,21.44,23.61Z"/></svg>',16:'<svg viewBox="0 0 32 32"><path fill="#866887" d="M1,21H2l4-4,9,2L8,31l4-1L22,19s9-.46,9-3H2Z"/><path fill="#9386aa" d="M22,13L12,2,8,1l7,12L6,15,2,11H1l1,5H31C31,13.46,22,13,22,13Z"/></svg>',17:'<svg viewBox="0 0 32 32"><path fill="#00b680" d="M28.87,22.5l-12-21a1,1,0,0,0-1.74,0l-12,21A1,1,0,0,0,4,24H28A1,1,0,0,0,28.87,22.5ZM5.72,22L16,4,26.28,22H5.72Z"/><path fill="#f3928a" d="M28.86,8.5A1,1,0,0,0,28,8H4a1,1,0,0,0-.87,1.5l12,21a1,1,0,0,0,1.74,0l12-21A1,1,0,0,0,28.86,8.5ZM16,28L5.72,10H26.28Z"/><path fill="#00b680" d="M22.13,14.75l2,3.5a1,1,0,0,0,1.74-1l-2-3.5a1,1,0,0,0-1.74,1"/><path fill="#00b680" d="M10,24h4a1,1,0,0,0,0-2H10a1,1,0,0,0,0,2"/><path fill="#f3928a" d="M12.28,6.5l-2.15,3.76a1,1,0,1,0,1.74,1L14,7.5a1,1,0,1,0-1.74-1"/></svg>',18:'<svg viewBox="0 0 32 32"><rect fill="#f998b3" x="2" y="11.5" width="4" height="12"/><path fill="#a2416a" d="M29,9.5H22a3,3,0,0,0-3-3H14.88A7,7,0,0,0,9.42,9.13L8,10.9V10.5a1,1,0,0,0-1-1H1a1,1,0,0,0-1,1v14a1,1,0,0,0,1,1H7a1,1,0,0,0,1-1H8a5,5,0,0,0,3,1h8.5a2.48,2.48,0,0,0,2.33-3.39,2.47,2.47,0,0,0,.92-3.18,2.94,2.94,0,0,0,1.07-3.43H29a3,3,0,0,0,0-6h0Zm-27,2H6v12H2v-12Zm27,2H21a1,1,0,0,0,0,2,1,1,0,0,1,0,2H20a1,1,0,0,0,0,2h0.5a0.5,0.5,0,0,1,0,1H19a1,1,0,0,0,0,2h0.5a0.5,0.5,0,0,1,0,1H11a3,3,0,0,1-3-3v-7a1,1,0,0,0,.78-0.38L11,10.38A5,5,0,0,1,14.88,8.5H19a1,1,0,0,1,1,1H19a1,1,0,0,0,0,2H29A1,1,0,0,1,29,13.5Z"/></svg>',19:'<svg viewBox="0 0 32 32"><path fill="#00c16b" d="M15.8,4.59L11.39,9l4,4H4.8v6H15.39l-4,4L15.8,27.4,27.2,16Z"/><polygon fill="#e6fcd7" points="15.79 7.42 14.21 8.99 20.2 14.99 6.79 14.99 6.79 17 20.2 17 14.21 23 15.79 24.59 24.39 15.99 15.79 7.42"/><polygon fill="#00af77" points="6.79 14.99 6.79 15.41 8.38 17 11.21 17 9.21 14.99 6.79 14.99"/><polygon fill="#00af77" points="11.38 14.99 13.38 17 16.2 17 14.21 14.99 11.38 14.99"/></svg>',20:'<svg viewBox="0 0 32 32"><path fill="#8dc3e0" d="M29.49,22.63L18,16,29.49,9.37a1,1,0,0,0-1-1.73L17,14.27V1a1,1,0,0,0-2,0V14.27L3.51,7.63a1,1,0,0,0-1,1.73L14,16,2.51,22.63a1,1,0,0,0,1,1.73L15,17.73V31a1,1,0,0,0,2,0V17.73l11.49,6.63A1,1,0,0,0,29.49,22.63Z"/><path fill="#54b2df" d="M19.29,2.29l-4,4a1,1,0,0,0,1.41,1.41l4-4a1,1,0,1,0-1.41-1.41"/><path fill="#54b2df" d="M15.29,24.29l-4,4a1,1,0,0,0,1.41,1.41l4-4a1,1,0,1,0-1.41-1.41"/><path fill="#73bbdd" d="M16.71,6.29l-4-4a1,1,0,0,0-1.41,1.41l4,4a1,1,0,0,0,1.41-1.41"/><path fill="#73bbdd" d="M20.71,28.29l-4-4a1,1,0,1,0-1.41,1.41l4,4a1,1,0,0,0,1.41-1.41"/><path fill="#73bbdd" d="M15,12h2a1,1,0,0,0,0-2H15a1,1,0,0,0,0,2"/><path fill="#54b2df" d="M15,22h2a1,1,0,0,0,0-2H15a1,1,0,0,0,0,2"/><path fill="#54b2df" d="M5.77,6.3l1.46,5.46a1,1,0,1,0,1.93-.52L7.71,5.78a1,1,0,1,0-1.93.52"/><path fill="#54b2df" d="M22.82,20.76l1.47,5.46a1,1,0,1,0,1.93-.52l-1.47-5.46a1,1,0,1,0-1.93.52"/><path fill="#73bbdd" d="M7.94,10.53L2.48,12A1,1,0,0,0,3,13.93l5.46-1.46a1,1,0,0,0-.52-1.93"/><path fill="#73bbdd" d="M29,18.07l-5.47,1.46A1,1,0,0,0,24,21.47L29.52,20A1,1,0,0,0,29,18.07"/><path fill="#73bbdd" d="M12,14.87l1-1.74a1,1,0,0,0-1.73-1l-1,1.74a1,1,0,0,0,1.73,1"/><path fill="#54b2df" d="M20.7,19.87l1-1.74a1,1,0,0,0-1.73-1l-1,1.74a1,1,0,0,0,1.73,1"/><path fill="#54b2df" d="M2.48,20l5.46,1.46a1,1,0,0,0,.52-1.93L3,18.07A1,1,0,0,0,2.48,20"/><path fill="#54b2df" d="M23.53,12.47L29,13.93A1,1,0,0,0,29.52,12L24,10.53a1,1,0,0,0-.52,1.93"/><path fill="#73bbdd" d="M7.23,20.24L5.77,25.7a1,1,0,1,0,1.93.52l1.46-5.46a1,1,0,1,0-1.93-.52"/><path fill="#73bbdd" d="M24.29,5.78l-1.47,5.46a1,1,0,1,0,1.93.52L26.23,6.3a1,1,0,1,0-1.93-.52"/><path fill="#73bbdd" d="M13,18.87l-1-1.74a1,1,0,0,0-1.73,1l1,1.74a1,1,0,0,0,1.73-1"/><path fill="#54b2df" d="M21.7,13.87l-1-1.74a1,1,0,0,0-1.73,1l1,1.74a1,1,0,0,0,1.73-1"/></svg>',21:'<svg viewBox="0 0 32 32"><path fill="#41576a" d="M28.71,3.29A1,1,0,0,0,28,3H4A1,1,0,0,0,3,4V28a1,1,0,0,0,1,1H28a1,1,0,0,0,1-1V4A1,1,0,0,0,28.71,3.29ZM5,5H27V27H5V5Z"/><path fill="#3c8df4" d="M21.59,9.59L13,18.17l-2.59-2.59a2,2,0,1,0-2.83,2.83l4,4a2,2,0,0,0,2.83,0l10-10a2,2,0,0,0-2.83-2.83h0Z"/></svg>',22:'<svg viewBox="0 0 32 32"><path fill="#41576a" d="M28.71,3.29A1,1,0,0,0,28,3H4A1,1,0,0,0,3,4V28a1,1,0,0,0,1,1H28a1,1,0,0,0,1-1V4A1,1,0,0,0,28.71,3.29ZM5,5H27V27H5V5Z"/></svg>',23:'<svg viewBox="0 0 32 32"><circle fill="#3c8df4" cx="16" cy="16" r="14"/><path fill="#ffffff" d="M24.41,9.59a2,2,0,0,0-2.83,0h0L13,18.17l-2.59-2.59a2,2,0,0,0-2.83,2.83l4,4a2,2,0,0,0,2.83,0l10-10A2,2,0,0,0,24.41,9.59Z"/></svg>',24:'<svg viewBox="0 0 32 32"><circle cx="16" cy="16" r="13" fill="none" stroke="#3c8df4" stroke-width="2px" stroke-miterlimit="10"/></svg>'},i=1;i<=24;i++)SVG_FOR_LISTS[i]={},SVG_FOR_LISTS[i].png=LIST_PNG_PATH+i+".png",SVG_FOR_LISTS[i].svg=SVG_LIST_MAPPING[i];var SYMBOL_LIST_MAPPING=JSON.parse('{"1":"□","2":"➤","3":"♢","4":"☆","5":"◎"}'),SYMBOL_SEARCH_KEYS=JSON.parse('{"JSON_RESPONSE":"response","NO_OF_RESULTS":"total_no_of_results","SEARCH_RESULTS":"results","SYMBOL_NAME":"name","SYMBOL_VALUE":"symbol","SYMBOL_UNICODE":"unicode"}'),CHECKLIST_TYPE=JSON.parse('{"1":{"checked":{"svg_id":21},"unchecked":{"svg_id":22}},"2":{"checked":{"svg_id":23},"unchecked":{"svg_id":24}}}'),CHECKLIST_STATES=JSON.parse('{"CHECKED":"checked","UNCHECKED":"unchecked"}'),CHECKLIST_IMG_DIMENSIONS=18.67,H_LIST_TYPE=JSON.parse('{"ARTICLE":16,"LEGAL_STYLE":17,"LIST_STYLE":18,"CHAPTER":19}'),LIST_STYLE_OBJECT={0:{level0:{type:0,startsWith:1,c:"\0."},level1:{type:4,startsWith:1,c:"."},level2:{type:2,startsWith:1,c:"."},level3:{type:0,startsWith:1,c:"."},level4:{type:4,startsWith:1,c:"."},level5:{type:2,startsWith:1,c:"."},level6:{type:0,startsWith:1,c:"."},level7:{type:4,startsWith:1,c:"."},level8:{type:2,startsWith:1,c:"\b."}},4:{level0:{type:4,startsWith:1,c:"\0."},level1:{type:2,startsWith:1,c:"."},level2:{type:0,startsWith:1,c:"."},level3:{type:4,startsWith:1,c:"."},level4:{type:2,startsWith:1,c:"."},level5:{type:0,startsWith:1,c:"."},level6:{type:4,startsWith:1,c:"."},level7:{type:2,startsWith:1,c:"."},level8:{type:0,startsWith:1,c:"\b."}},3:{level0:{type:3,startsWith:1,c:"\0."},level1:{type:2,startsWith:1,c:"."},level2:{type:0,startsWith:1,c:"."},level3:{type:4,startsWith:1,c:"."},level4:{type:2,startsWith:1,c:"."},level5:{type:0,startsWith:1,c:"."},level6:{type:4,startsWith:1,c:"."},level7:{type:2,startsWith:1,c:"."},level8:{type:0,startsWith:1,c:"\b."}},2:{level0:{type:2,startsWith:1,c:"\0."},level1:{type:0,startsWith:1,c:"."},level2:{type:4,startsWith:1,c:"."},level3:{type:2,startsWith:1,c:"."},level4:{type:0,startsWith:1,c:"."},level5:{type:4,startsWith:1,c:"."},level6:{type:2,startsWith:1,c:"."},level7:{type:0,startsWith:1,c:"."},level8:{type:4,startsWith:1,c:"\b."}},1:{level0:{type:1,startsWith:1,c:"\0."},level1:{type:2,startsWith:1,c:"."},level2:{type:0,startsWith:1,c:"."},level3:{type:4,startsWith:1,c:"."},level4:{type:2,startsWith:1,c:"."},level5:{type:0,startsWith:1,c:"."},level6:{type:4,startsWith:1,c:"."},level7:{type:2,startsWith:1,c:"."},level8:{type:0,startsWith:1,c:"\b."}},6:{level0:{type:6,startsWith:1},level1:{type:7,startsWith:1},level2:{type:8,startsWith:1},level3:{type:6,startsWith:1},level4:{type:7,startsWith:1},level5:{type:8,startsWith:1},level6:{type:6,startsWith:1},level7:{type:7,startsWith:1},level8:{type:8,startsWith:1}},7:{level0:{type:7,startsWith:1},level1:{type:8,startsWith:1},level2:{type:6,startsWith:1},level3:{type:7,startsWith:1},level4:{type:8,startsWith:1},level5:{type:6,startsWith:1},level6:{type:7,startsWith:1},level7:{type:8,startsWith:1},level8:{type:6,startsWith:1}},8:{level0:{type:8,startsWith:1},level1:{type:6,startsWith:1},level2:{type:7,startsWith:1},level3:{type:8,startsWith:1},level4:{type:6,startsWith:1},level5:{type:7,startsWith:1},level6:{type:8,startsWith:1},level7:{type:6,startsWith:1},level8:{type:7,startsWith:1}},11:{level0:{type:0,startsWith:1,c:"\0."},level1:{type:0,startsWith:1,c:"\0.."},level2:{type:0,startsWith:1,c:"\0..."},level3:{type:0,startsWith:1,c:"\0...."},level4:{type:0,startsWith:1,c:"\0....."},level5:{type:0,startsWith:1,c:"\0......"},level6:{type:0,startsWith:1,c:"\0......."},level7:{type:0,startsWith:1,c:"\0........"},level8:{type:0,startsWith:1,c:"\0........\b."}},255:{level0:{type:255,startsWith:1},level1:{type:255,startsWith:1},level2:{type:255,startsWith:1},level3:{type:255,startsWith:1},level4:{type:255,startsWith:1},level5:{type:255,startsWith:1},level6:{type:255,startsWith:1},level7:{type:255,startsWith:1},level8:{type:255,startsWith:1}}},DIRECTION=JSON.parse('{"LEFT_TO_RIGHT":1,"RIGHT_TO_LEFT":2,"TOP_TO_BOTTOM":3,"BOTTOM_TO_TOP":4}'),TEXT_ALIGN=JSON.parse('{"0":"left","1":"center","2":"right","3":"justify"}'),PARA_DIR=JSON.parse('{"RTL":"rtl","LTR":"ltr"}'),UNICODE={TABLE:"",ROW:"",CELL:"",TABLEEND:"",IMAGE:"",IFRAME:"",BR:"\v",PARA:"\n",PARAGRAPH:"\n",TAB:"\t",RANGE_START:"",RANGE_END:"",FIELD_SEPARATOR:"",SPACE:" ",MULTIBYTE_SPACE:"　",SECTION_START:"",SECTION:"",HR:"\r",TOCEND:"",TOCSTART:"",MERGEFIELD_START:"«",MERGEFIELD_END:"»"},DOC_INVISIBLE_CHARS;!function(){var t=[];for(var e in UNICODE)"MULTIBYTE_SPACE"!=e&&"SPACE"!=e&&"MERGEFIELD_START"!=e&&"MERGEFIELD_END"!=e&&t.push(UNICODE[e]);DOC_INVISIBLE_CHARS=t.join("")}();var CONT_REGEX_REDACT_EXCLUDE="";!function(){for(var t in UNICODE)CONT_REGEX_REDACT_EXCLUDE+=UNICODE[t]}();var DOC_CHARS={paragraph:UNICODE.PARA,table:UNICODE.TABLE,row:UNICODE.ROW,cell:UNICODE.CELL,hr:UNICODE.HR,section:UNICODE.SECTION_START,image:UNICODE.IMAGE,br:UNICODE.BR},AUTOFIELD_TYPE=JSON.parse('{"AUTO_PAGENUMBER":"autopno","AUTO_TOC_PAGENUMBER":"autopno_toc","AUTO_PAGECOUNT":"autopcnt","AUTO_DATE":"autodate","AUTO_DOCNAME":"autodocname","AUTO_DOCVERSION":"autodocversion","AUTO_AUTHOR":"autoauthor","AUTO_FORMULA":"autoformula","CREATED_DATE":"createddate","LAST_MODIFIED_DATE":"lastmodifieddate","AUTO_PAGE_REF":"autopageref","USER_FIRST_NAME":"first_name","USER_LAST_NAME":"last_name","USER_EMAIL":"user_email","USER_PHONE":"user_phone","DOC_SEQUENCE_NUMBER":"doc_sequence_number"}'),SIGNERFIELD_TYPE=JSON.parse('{"SIGNATURE":"signature","INITIAL":"initial","COMPANY":"company","DATE":"date","JOB_TITLE":"jobTitle","FIRST_NAME":"firstName","LAST_NAME":"lastName","FULL_NAME":"fullName","EMAIL":"email","TEXTBOX":"textbox","CHECKBOX":"checkbox","CUSTOMDATE":"customdate","DROPDOWN":"dropdown","ATTACHMENT":"attachment","RADIO":"radio","STAMP":"stamp","IMAGE":"image"}'),COMMAND=JSON.parse('{"ANY":0,"UNDO":1,"REDO":2,"TYPING":3,"PASTE":4,"RE_PASTE":5,"IMAGE_STYLE_OP":6}'),CONT_REGEXP={PARASTART:UNICODE.PARA+"|"+UNICODE.TABLE+"|"+UNICODE.HR+"|"+UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND+"|"+UNICODE.SECTION_START+"|"+UNICODE.TOCSTART+"|"+UNICODE.TOCEND,BLOCKSTART:UNICODE.PARA+"|"+UNICODE.TABLE+"|"+UNICODE.HR+"|"+UNICODE.CELL+"|"+UNICODE.ROW,TABLEEND:UNICODE.TABLEEND,TABLESTART:UNICODE.TABLE,ROWSTART:UNICODE.ROW+"|"+UNICODE.TABLE,ROWEND:UNICODE.ROW+"|"+UNICODE.TABLEEND,CELLSTART:UNICODE.CELL,CELLEND:UNICODE.CELL+"|"+UNICODE.ROW+"|"+UNICODE.TABLEEND,SECTIONSTART:UNICODE.SECTION_START,SECTIONEND:UNICODE.SECTION_START,TC_BLOCK_CHARS:UNICODE.TABLEEND+"|"+UNICODE.TOCEND};CONT_REGEXP.PARAEND=CONT_REGEXP.BLOCKSTART+"|"+UNICODE.TABLEEND+"|"+UNICODE.SECTION_START+"|"+UNICODE.HR+"|"+UNICODE.TOCSTART+"|"+UNICODE.TOCEND,CONT_REGEXP.PORTION_END=CONT_REGEXP.PARAEND+"|"+UNICODE.TAB+"|"+UNICODE.RANGE_START+"|"+UNICODE.RANGE_END+"|"+UNICODE.HR+"|"+UNICODE.BR+"|"+UNICODE.IMAGE+"|"+UNICODE.FIELD_SEPARATOR,CONT_REGEXP[CONST.PORTION_END_WITHOUT_TAB]=CONT_REGEXP.PARAEND+"|"+UNICODE.RANGE_START+"|"+UNICODE.RANGE_END+"|"+UNICODE.HR+"|"+UNICODE.BR+"|"+UNICODE.IMAGE,CONT_REGEXP.AUTOFIELD_PAGE_NO_COUNT=new RegExp(AUTOFIELD_TYPE.AUTO_PAGENUMBER+"|"+AUTOFIELD_TYPE.AUTO_PAGECOUNT),CONT_REGEXP.AUTOFIELD_WITHOUT_FORMULA=AUTOFIELD_TYPE.AUTO_PAGENUMBER+"|"+AUTOFIELD_TYPE.AUTO_PAGECOUNT+"|"+AUTOFIELD_TYPE.AUTO_AUTHOR+"|"+AUTOFIELD_TYPE.AUTO_DOCNAME+"|"+AUTOFIELD_TYPE.AUTO_DOCVERSION+"|"+AUTOFIELD_TYPE.AUTO_DATE,CONT_REGEXP.AUTOFIELD_WITHOUT_PAGENO_COUNT=AUTOFIELD_TYPE.AUTO_FORMULA+"|"+AUTOFIELD_TYPE.AUTO_AUTHOR+"|"+AUTOFIELD_TYPE.AUTO_DOCNAME+"|"+AUTOFIELD_TYPE.AUTO_DOCVERSION+"|"+AUTOFIELD_TYPE.AUTO_DATE,CONT_REGEXP.AUTOFIELD_USER_FIELD=AUTOFIELD_TYPE.USER_FIRST_NAME+"|"+AUTOFIELD_TYPE.USER_LAST_NAME+"|"+AUTOFIELD_TYPE.USER_EMAIL+"|"+AUTOFIELD_TYPE.USER_PHONE,CONT_REGEXP.AUTOFIELD=CONT_REGEXP.AUTOFIELD_WITHOUT_FORMULA+"|"+AUTOFIELD_TYPE.AUTO_FORMULA,CONT_REGEXP.NONEDITABLE_BLOCK_FIELDS=NODE_TYPE.MAILMERGEFIELD+"|"+NODE_TYPE.FILLABLEFIELD+"|"+NODE_TYPE.SIGNERFIELD+"|"+NODE_TYPE.FOOTNOTE+"|"+NODE_TYPE.ENDNOTE+"|"+NODE_TYPE.PLACEHOLDER+"|"+NODE_TYPE.AUTOFIELD+"|"+AUTOFIELD_TYPE.AUTO_DOCVERSION+"|"+DISPLAY_TYPE.BUTTON,CONT_REGEXP.AUTOUPDATE_DOC_FIELDS=AUTOFIELD_TYPE.AUTO_AUTHOR+"|"+AUTOFIELD_TYPE.AUTO_DOCNAME+"|"+AUTOFIELD_TYPE.AUTO_DOCVERSION,PREDEFINED_NOTE_REFERENCE_SYMBOLS=["*","†","‡","§"];var KEYS=JSON.parse('{"SPACE":32,"CAPS":20,"BACKSPACE":8,"TAB":9,"ENTER":13,"ESC":27,"INSERT":45,"DELETE":46,"PAGEUP":33,"PAGEDOWN":34,"END":35,"HOME":36,"NAV_LEFT":37,"NAV_UP":38,"NAV_RIGHT":39,"NAV_DOWN":40,"LEFTWINDOW":91,"RIGHTWINDOW":92,"F7":118,"SHIFT":16,"C":67,"V":86,"COMMA":188,"Q":81,"CTRL":17,"ALT":18,"F1":112,"F2":113,"F3":114,"F4":115,"F5":116,"F6":117,"F8":119,"F9":120,"F10":121,"F11":122,"F12":123}'),SavedDesign={},SavedStyles={},DocDesignName="",DefaultDesignName=window.editorProps&&window.editorProps.viewInfo&&window.editorProps.viewInfo.design&&window.editorProps.viewInfo.design.default_design_name,MAX_REVISION=99,REGEX={docUnicodes:/[\u000e\u000f\u0010\u0011\u0012\u000b\u001c\u0013\u0014\t]/g,allUnicodes:/[\u000e\u000f\u0010\u0011\u0012\u000b\u001c\u0013\u0014\u0003\ueeff\ueefe\u00AB\u00BB\t\r]/g},HEADER_ALLOWENCE={top:"0.2in",right:"0in",bottom:"0.1in",left:"0in"},FOOTER_ALLOWENCE={top:"0.1in",right:"0in",bottom:"0.2in",left:"0in"},PAPER_HEIGHT_ALLOWENCE="0.1in";REMOTE_MESSAGE={},REMOTE_MESSAGE.probleminRemoteclient="writer.remotesave.REMOTESAVE_ERR_MSG2",REMOTE_MESSAGE.ExportResultNull="writer.remotesave.REMOTESAVE_ERR_MSG3",REMOTE_MESSAGE.postexception="writer.remotesave.REMOTESAVE_ERR_MSG4",REMOTE_MESSAGE.exportContentNull="writer.remotesave.REMOTESAVE_ERR_MSG4",REMOTE_MESSAGE.publicexportError="writer.remotesave.REMOTESAVE_ERR_MSG5",REMOTE_MESSAGE.connectionrefused="writer.remotesave.REMOTESAVE_ERR_MSG6",REMOTE_MESSAGE["Invalid session. Save not allowed."]="writer.remotesave.REMOTESAVE_ERR_MSG7",REMOTE_MESSAGE["Document info not present"]="writer.remotesave.REMOTESAVE_ERR_MSG8",REMOTE_MESSAGE["Access denied"]="writer.remotesave.REMOTESAVE_ERR_MSG9",REMOTE_MESSAGE.readonlyuser="writer.remotesave.REMOTESAVE_ERR_MSG9",REMOTE_MESSAGE["Save url not provided"]="writer.remotesave.REMOTESAVE_ERR_MSG10";var ListLevelNo=[];ListLevelNo[0]="\0",ListLevelNo[1]="",ListLevelNo[2]="",ListLevelNo[3]="",ListLevelNo[4]="",ListLevelNo[5]="",ListLevelNo[6]="",ListLevelNo[7]="",ListLevelNo[8]="\b";var TCConstants=JSON.parse('{"ID":"id","MOVEMENT_ID":"movementId","MOVED_FROM": "movedFrom","MOVED_TO": "movedTo","UPDATE_MODE":"update","CREATE_MODE":"create","DELETE_MODE":"delete","INSERT":"ins","DELETE":"del","ALL":"all","REPLACE":"replace","UPDATE":"upd","TASK":"task","REMOVE":"remove","DETAILS":"details","VALUE":"value","FF_VALUE_UPDATE":"ffValueUpdate","ACTION":"action","ZUID":"zuid","TIME":"time","TC":"tc","TC_NULL":"tc_null","ROW":"row","TC_VIEW":"tc_view","ALL_MARKUP_VIEW":1,"NO_MARKUP_VIEW":2,"ORIGINAL_MARKUP_VIEW":3,"ORIGINAL_VIEW":4,"ALL_FILTER":1,"ADDED_FILTER":2,"DELETED_FILTER":3,"AUTHOR_BY_FILTER":4,"REPLACED_FILTER":5,"FF_VALUE_UPDATE_FILTER":6}'),LINK_TYPES=JSON.parse('{"WEBURL":1,"BOOKMARK":2,"MAILTO":3,"ZWDOC":4,"MMFIELD":5}'),EDITOR_VIEWS=JSON.parse('{"EDITOR":1,"HISTORY":2,"PRINT_PREVIEW":3,"MAILMERGE_PREVIEW":4,"TEMPLATEI_EDIT":5,"VERSIONVIEW":6,"FILLABLEFIELDS_PREVIEW":7}'),HEADER_FOOTER_TYPE=JSON.parse('{"PRIMARY":0,"DIFF_FIRST_PAGE":1,"DIFF_ODD_EVEN_PAGE":2,"DIFF_FIRST_ODD_EVEN_PAGE":3}'),WARNING_MSG=JSON.parse('{"NEW_VERSION_UPLOADED":"NEW_VERSION_UPLOADED","HEADING_NOT_FOUND":"NOHEADINGFOUND","LOWER_HEADING_FOUND":"LOWER_HEADING_FOUND","MERGE_IS_NOT_POSSIBLE":"MERGE_IS_NOT_POSSIBLE","BOOKMARK_REMOVED":"BOOKMARK_REMOVED","HEADING_REMOVED":"HEADING_REMOVED","UNABLE_TO_PREVIEW_TEMPLATE":"UNABLE_TO_PREVIEW_TEMPLATE","UNABLE_TO_LOAD_VERSION":"UNABLE_TO_LOAD_VERSION","UNABLE_TO_LOAD_VERSION_IN_HISTORY":"UNABLE_TO_LOAD_VERSION_IN_HISTORY","UNABLE_TO_LOAD_CONTENT_IN_MAILMERGE_PREVIEW":"UNABLE_TO_LOAD_CONTENT_IN_MAILMERGE_PREVIEW","REPLACE_NO_MATCHES_FOUND":"REPLACE_NO_MATCHES_FOUND","REPLACE_SEARCH_COMPLETED_MSG":"REPLACE_SEARCH_COMPLETED_MSG","COLUMN_WIDTH_IS_LESS":"COLUMN_WIDTH_IS_LESS","OPERATION_NOT_ALLOWED":"OPERATION_NOT_ALLOWED","SERVER_BUSY":"SERVER_BUSY","NO_IMAGE_FOUND":"NO_IMAGE_FOUND","MERGE_CELLS_FOUND":"MERGE_CELLS_FOUND","PARTIAL_TABLE_SELECTED":"PARTIAL_TABLE_SELECTED","HEADER_ROW_ONLY_SELECTED_FOR_SORTING":"HEADER_ROW_ONLY_SELECTED_FOR_SORTING","NOHEADINGFOUND_FOR_OPTION_CHOOSED":"NOHEADINGFOUND_FOR_OPTION_CHOOSED"}'),WORD_BREAK_CHAR="[\\u0028\\u005B\\u00AB\\u2018\\u201C\\u3008\\u300A\\u300C\\u300E\\u3010\\u3014\\u3016\\u3018\\u301D\\uFF08\\uFF3B\\uFF5F\\uFF5B]*[\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u3AEF\\u4E00-\\u9FCF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF][\\u002C\\u0029\\u005D\\u00BB\\u2019\\u201D\\u3001\\u3009\\u300B\\u300D\\u300F\\u3011\\u3015\\u3017\\u3019\\u301F\\u3005\\u303B\\u30FC\\u30FD\\u30FE\\u30A1\\u30A3\\u30A5\\u30A7\\u30A9\\u30C3\\u30E3\\u30E5\\u30E7\\u30EE\\u30F5\\u30F6\\u3041\\u3043\\u3045\\u3047\\u3049\\u3063\\u3083\\u3085\\u3087\\u308E\\u3095\\u3096\\u31F0\\u31F1\\u31F2\\u31F3\\u31F4\\u31F5\\u31F6\\u31F7\\u31F8\\u31F9\\u31FA\\u31FB\\u31FC\\u31FD\\u31FE\\u31FF\\u2010\\u2013\\u301C\\u30A0\\u0021\\u002E\\u003A\\u003B\\u003F\\u203C\\u2047\\u2048\\u2049\\u3001\\u3002\\u30FB\\uFF01\\uFF1F\\uFF09\\uFF3D\\uFF5D\\uFF60]*",ARABIC_UNICODES=["\\u0600-\\u065F","\\u066A-\\u06EF","\\u0750-\\u077F","\\u08A0-\\u08FF","\\uFB50-\\uFDFF","\\uFE70-\\uFEFF"],HEBREW_UNICODES=["\\u0590-\\u05FF","\\uFB1D-\\uFB4F"],SYRIAC_UNICODES=["\\u0700-\\u074F"],SAMARATIAN_UNICODES=["\\u0800-\\u083F"],MANDAIC_UNICODES=["\\u0840-\\u085F"],RTL_UNICODES=ARABIC_UNICODES.concat(HEBREW_UNICODES).concat(SYRIAC_UNICODES).concat(SAMARATIAN_UNICODES).concat(MANDAIC_UNICODES),CJK_SYMBOLS=["\\u2F00-\\u30FF","\\u3190-\\u319F","\\u31C0-\\u3AEF","\\u4E00-\\u9FCF","\\uF900-\\uFAFF","\\uFE10-\\uFE1F","\\uFE30-\\uFE4F","\\uFF00-\\uFFEF"],STRICT_RTL_REGEX=new RegExp("^["+RTL_UNICODES.join("")+"]+$",""),STARTS_WITH_RTL_REGEX=new RegExp("^["+RTL_UNICODES.join("")+"]+(\\s{0,1}["+RTL_UNICODES.join("")+"]|.*)*$",""),STARTS_WITH_LTR_REGEX=new RegExp("^[^"+RTL_UNICODES.join("")+"]+(\\s{0,1}["+RTL_UNICODES.join("")+"])+["+RTL_UNICODES.join("")+"]*$",""),ENDS_WITH_RTL_REGEX=new RegExp("^[^"+RTL_UNICODES.join("")+"].*["+RTL_UNICODES.join("")+"]$",""),ARABIC_REGEX=new RegExp("^["+ARABIC_UNICODES.join("")+"]+$",""),WORD_BREAK_ENTITY=[" ",UNICODE.FIELD_SEPARATOR,UNICODE.TAB,UNICODE.PARA,UNICODE.IMAGE,"\v","\f"],HYPHEN_UNICODE="\\u002D",HYPHEN_WORD_BREAK="[^\\u2F00-\\u30FF\\u3190-\\u319F\\u31C0-\\u3AEF\\u4E00-\\u9FCF\\uF900-\\uFAFF\\uFE10-\\uFE1F\\uFE30-\\uFE4F\\uFF00-\\uFFEF"+WORD_BREAK_ENTITY.join("")+HYPHEN_UNICODE+"]*"+HYPHEN_UNICODE,WORD_BREAK_REGEX_FOR_LINE=new RegExp(WORD_BREAK_CHAR+"|"+HYPHEN_WORD_BREAK+"|"+("[^"+CJK_SYMBOLS.join("")+WORD_BREAK_ENTITY.join("")+"]+")+"| +\f?|[\t\n\v\f\\u000e\\u000f\\u0013\\u0014]|","mg"),RANGE_CHARS_REGEX=new RegExp(UNICODE.RANGE_START+"|"+UNICODE.RANGE_END,"mg"),IMAGE_RANGE_START_REGEX=new RegExp(UNICODE.IMAGE+"|"+UNICODE.RANGE_START,"mg"),Themesetnames=["Default","Architecture","Bold","Brushstrokes","Bubbles","Bulletin","Chalkboard","Civil","Community","Dormitory","Elemental","Essential","Executive","Guidebook","Lightbox","Luxury","Motion","Oblique","Orbit","Perspective","Pinstripes","Pulp","Sheer","Tradition","Treasury","Universal","Watercolor"],SORT_TYPES=JSON.parse('{"TEXT":"text","NUMBER":"number","DATE":"date","CHECKED":"checked"}'),EDITOR_MODES=JSON.parse('{"COMPOSE":1,"COLLABORATE":2,"COMPLETE":3}'),ELEM_ID=JSON.parse('{"EDITORPANE":"editorpane","EDITORPANEWRAPPER":"editorpane-wrapper","EDITORPANECONTAINER":"editorpane-container","EDITORRIGHTPANEL":"editor-rightPanel","EDITOROUTERDIV":"ui-editor-outer-div","MAINOUTERDIV":"mainOuterDiv","TOPBANDWRAPPER":"topband-wrapper","REVIEWRIGHTPANE":"review_Rightpane","BOTTOMBAR":"bottombar","DESIGNPANEL":"designpanel","STYLESMENU":"styles-menu"}'),LAYOUTS=JSON.parse('{"COMPOSE":1,"COLLABORATE":2,"COMPLETE":3,"RICHEDIT":4,"VERSIONHISTORY":5,"MAILMERGEPREVIEW":6,"READONLY":7,"READCOMMENT":8,"REMOTE":10,"USERTEMPLATE":11,"PRINTPREVIEW":12,"VERSIONVIEW":13,"HISTORYDIFFVIEW":14,"FILLABLEFIELDSPREVIEW":15,"FULLSCREEN":16, "SCREENPLAY": 17, "SCREENPLAY_REPORT": 18, "SCREENPLAY_BREAKDOWN": 19, "SCREENPLAY_SCENES_GRID_VIEW": 20}'),ANIMATIONS=JSON.parse('{"SLIDEIN":"SLIDEIN","FADEIN":"FADEIN","FLIPIN":"FLIPIN","FLIPOUT":"FLIPOUT","FADEOUT":"FADEOUT","SLIDEOUT":"SLIDEOUT","RIGHT_PANEL_SLIDEIN":"RIGHT_PANEL_SLIDEIN","RIGHT_PANEL_SLIDEOUT":"RIGHT_PANEL_SLIDEOUT"}'),SCROLLDIRECTION=JSON.parse('{"UP":"UP","DOWN":"DOWN"}'),COMPONENTS_INIT_DONE=[],SHAPE=JSON.parse('{"THEME":{"BGC_COLOR":"zwaccent3","BR_COLOR":"zwaccent3*50","FF_ZWMINOR":"zwminor","FF_ZWMAJOR":"zwmajor"}}'),PREPARE_DOCUMENT=JSON.parse('{"OPERATION":{"MERGE":"merge","FILL":"fill","SIGN":"sign"},"LAST_OPERATION":"last_operation","LAST_ACTION":"last_action","SEQUENCE_NUMBERS":"sequence_numbers"}'),LIST_KEYS=JSON.parse('{"LIST":"list","NON_LIST":"normal"}'),HISTORY_CONST=JSON.parse('{"ACTION":"history_action","ZUID":"history_zuid","ACTION_INS":"ins","ACTION_DEL":"del","ACTION_ALL":"all"}'),NOTIFICATION_RULE_CONSTANTS=JSON.parse('{"ALL_CHANGES":8,"ALL_COMMENTS":16,"NEW_COMMENTS":64,"PARTICIPATED_COMMENTS":32,"NO_NOTIFICATION":4}'),ZERO_RECT={};Object.defineProperties(ZERO_RECT,{bottom:defineWithValue(0),height:defineWithValue(0),left:defineWithValue(0),right:defineWithValue(0),top:defineWithValue(0),width:defineWithValue(0)});var PAGE_BORDER_WIDTH=isHeadlessPDF?0:2,PAGE_LEFT_BORDER_WIDTH=1,TOC_BORDER_WIDTH=2,USER_STATS={ZW_4_STATS:"ZW_4_STATS",HMBG:"hmbg"},SEL_AUTO_GEN=0,SEL_MOUSE=1,SEL_KEYBOARD=2,SEL_OP_GEN=3,SEL_CONTEXT=4,USER_ROLE=JSON.parse('{"PUBLIC":"PUBLIC","TEMPLATE_USER":"TEMPLATE_USER","REMOTE_PUBLIC_USER":"TRYEDITOR_WRITER"}'),DISABLED_OPERATIONS_ONLIST=["copy","cut","paste"],IMAGELIBRARY_MAXCOUNT_TOBEUPLOAD=50,ESIGN=JSON.parse('{"ADOBESIGN":"adobesign","DOCUSIGN":"docusign","SIGNEASY":"signeasy","ZOHOSIGN":"zohosign"}'),CONST_VIEW=JSON.parse('{"EOP_WIDTH":24,"EOP_SELECT_WIDTH":14,"LINE_DIV_CHILDREN":"div.spell-error,div.grammar-error,div.wq-error,div.replace-overlay,div.float-div,div.writer-glyphs-tab,div.bMark,div.lock-overlay,div.lock-icon-class,div.redact-icon-class,div.imgMark","SEPARATOR_HEIGHT":6}'),NOTE_CLASS=JSON.parse('{"endnote":"zw-endnotecontainer","footnote":"zw-footnotecontainer"}'),TAG_CLASS="zw-tag",ZINDEX=JSON.parse('{"TEXT_BACKGROUND":-2,"COMMENT_HIGHLIGHT":-1,"LINEDIV":4,"FLOAT_IMG_FRONT":5,"FLOAT_IMG_BEHIND":3,"IMG_TC_VIEW":5,"PARA_BACKGROUND":-3}');ZINDEX.FLOAT_IMG_FRONT=ZINDEX.LINEDIV+1,ZINDEX.FLOAT_IMG_BEHIND=ZINDEX.LINEDIV-1,ZINDEX.IMG_TC_VIEW=ZINDEX.FLOAT_IMG_FRONT+1,ZINDEX.PARA_BACKGROUND=ZINDEX.TEXT_BACKGROUND-1;var shouldNotCarryParaStyle=[ATTR_COMMON.TYPE,ATTR_PARAGRAPH.PS_HD,ATTR_PARAGRAPH.PS_TS,ATTR_PARAGRAPH.LS_DATA,ATTR_PARAGRAPH.PS_TYPE,ATTR_PARAGRAPH.TEXTFORMAT,TCConstants.TC,ATTR_PARAGRAPH.PS_CODE],shouldNotCarryTextStyle=[ATTR_COMMON.TYPE,ATTR_TEXT.TS_VA,ATTR_TEXT.CHAR_STY,TCConstants.TC,ATTR_LINK.LINK_TARGET,ATTR_LINK.LINK_TOOLTIP,ATTR_LINK.LINK_TYPE,ATTR_LINK.LINK_URL,ATTR_COMMON.CLS],HISTORYVIEW_PERMISSION=["document.download","document.print","document.content.copy","document.copy","review.comment.view"],MAILMERGE_PERMISSION=["document.download","document.print","document.content.copy"],FILLABLEFIELDS_PERMISSION=["document.download","document.print","document.content.copy"],PRINTVIEW_PERMISSION=["document.download","document.print","document.content.copy"],MARKASFINAL_PERMISSION=["document.download","document.print","document.publish.external","document.publish.internal","document.content.copy","workflow.state.view","collab.chat","document.create","document.copy"],TRACKCHANGE_PERMISSION=["document.download","document.print","document.content.copy","review.changes.view","collab.chat"],OFFLINE_PERMISSION=["document.download","document.print","document.content.copy"],LOCK_PERMISSION=["document.download","document.print","document.content.copy"],COLLAB_PERMISSION=["document.download","document.print","document.content.copy"],EDITOR_PERMISSION=["document.download","document.print","document.content.copy"],ONRELOAD_PERMISSION=["document.download","document.print","document.content.copy"],ERROR_PERMISSION=["document.download","document.print","document.content.copy"],EMAILID_REGEX=new RegExp(/^[\w]([\w\-\.\+\']*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/),WIDGET={VIDEO_REGEX:{YOUTUBE:/^((http|https)?:\/\/)?(www\.)?(?:youtu\.be\/|youtube\.com(?:\/embed\/|\/v\/|\/watch\?v=|\/user\/\S+|\/ytscreeningroom\?v=))([\w-]{10,12})\b/,VIMEO:/^(?:(?:https|http):\/\/)?(?:www\.)?(?:player.)?(?:vimeo.com)\/(?:video\/)?(?:embed\/)?([\w]{6,9})\b/,DAILYMOTION:/^(?:(?:https|http):\/\/)?(?:www\.)?(?:dailymotion.com|dai.)(?:|\/embed)?(?:\/video|ly)\/([\w]{6,9})\b/}},FONT_WEIGHT=JSON.parse('{"100":"Thin","200":"Extralight","300":"Light","400":"Regular","500":"Medium","600":"Semibold","700":"Bold","800":"Extrabold","900":"Black","thin":100,"extralight":200,"light":300,"normal":400,"none":400,"regular":400,"medium":500,"semibold":600,"bold":700,"extrabold":800,"black":900}');SHOW_FONT_WEIGHT_MAP=JSON.parse('{"100":"THIN","200":"EXTRA_LIGHT","300":"LIGHT","400":"NORMAL","500":"MEDIUM","600":"SEMI_BOLD","700":"BOLD","800":"HEAVY","900":"BLACK"}'),WRITER_FONT_WEIGHT_MAP=JSON.parse('{"THIN":100,"EXTRA_LIGHT":200,"LIGHT":300,"NORMAL":400,"MEDIUM":500,"SEMI_BOLD":600,"BOLD":700,"HEAVY":800,"BLACK":900}');var CHARS_FOLLOWED_BY_RTL=" '.:;!+-»\"",PUBLISH_TYPE=JSON.parse('{"PRIVATE":0,"INTERNAL":1,"EXTERNAL":2}'),PAGE={TOP:1,RIGHT:1,BOTTOM:1,LEFT:1,GAP:20},RANDOM_CODE_BLOCK_INS_REGEX=new RegExp(/^=code\(([\w#+ ]*,?[\w- ]*)\)$/),BLOCK_TYPE=JSON.parse('{"RANGE_START":"RANGE_START","RANGE_END":"RANGE_END","IMAGE":"IMAGE","FIELD_SEPARATOR":"FIELD_SEPARATOR","TAB":"TAB","DIGISIGN":"DIGISIGN","BR":"BR","EOP":"EOP","TEXT":"TEXT"}'),FILLABLEFIELD_REGEX={};FILLABLEFIELD_REGEX[ATTR_FILLABLEFIELD.FF_NAME]=new RegExp(/[`~^*()"{}\[\]<>|;&#%+=\\]/),FILLABLEFIELD_REGEX[FILLABLEFIELD_TYPE.SINGLELINE]=new RegExp(/[\[(){}%\\\/\]]/),FILLABLEFIELD_REGEX[FILLABLEFIELD_TYPE.EMAIL]=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/),FILLABLEFIELD_REGEX[FILLABLEFIELD_TYPE.CURRENCY]=new RegExp(/[^0-9.]/),FILLABLEFIELD_REGEX[FILLABLEFIELD_TYPE.NUMBER]=new RegExp(/[^0-9,.]/),FILLABLEFIELD_REGEX[FILLABLEFIELD_TYPE.PHONE]=new RegExp(/[^0-9,-. +()]/);var ZOHOSIGN_TAG={};ZOHOSIGN_TAG[SIGNERFIELD_TYPE.SIGNATURE]="Signature",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.INITIAL]="Initial",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.COMPANY]="Company",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.FULL_NAME]="Fullname",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.EMAIL]="Email",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.JOB_TITLE]="Jobtitle",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.DATE]="Signdate",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.TEXTBOX]="Textfield",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.CHECKBOX]="Checkbox",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.CUSTOMDATE]="Customdate",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.DROPDOWN]="Dropdown",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.ATTACHMENT]="Attachment",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.RADIO]="Radio",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.STAMP]="Stamp",ZOHOSIGN_TAG[SIGNERFIELD_TYPE.IMAGE]="Image";var QRCODE=JSON.parse('{"DEFAULT":{"BG_COLOR":"#ffffff","FG_COLOR":"#000000","MERGEFIELD_VALUE":"Merge Field"}}'),EDITORVIEW_TYPE={PAGE_VIEW:"Page View",WEB_VIEW:"Web View",FIXED_VIEW:"Fixed View",PUBLISH_VIEW:"Publish View",HTML_VIEW:"Html View"},HTMLVIEW_TYPE={WEB_VIEW:"Web View",FIXED_VIEW:"Fixed View"},DEFAULT_COLUMN_SPACE_WIDTH=48,BARCODE=JSON.parse('{"DEFAULT":{"BG_COLOR":"#ffffff","FG_COLOR":"#000000","FORMAT":"CODE128"}}'),TEMPLATE=JSON.parse('{"SETTINGS":"template_settings","FILLABLE_SETTINGS":"fill"}'),OP_TYPE={CREATE:"create",MODIFY:"modify",UPDATE:"update",REMOVE:"remove",UPDATE_LIST:"updatelist",ADJUST_BORDER:"adjustBorder"},ALIGN={LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"},COLOUR={RED:"#b90000",BLUE:"#0000b9",GREEN:"#006400",YELLOW:"#f8de7e"},MULTIPAGE_DEFAULT_SPACE=10,PAGE_GRID={WRAP_TYPE:{FIXED:"fixed",AUTO:"auto"},DIRECTION:{ROW:"row",COLUMN:"column"}},FILLABLEFIELD_TXTAREA=JSON.parse('{"BORDER":"1px inherit","PADDING":"0px"}'),SIGNER_ROLE=JSON.parse('{"SIGN":"sign","APPROVE":"approve","VIEW":"view","INPERSONSIGN":"in_person_sign"}'),SKU_CONST=JSON.parse('{"MAIL":1000,"MERGE":1001,"SIGN":1002,"DOWNLOAD":1003,"FILL":1004, "PDF_FORM_IMPORT":1005, "PDF_FORM":1006, "PDF": 1010, "HTML": 1011, "FILL_DATA_COLLECTION": 1012, "MS_DOC": 1013, "ZDOC": 1014, "ZFDOC": 1015}'),SKU_JOB_CONST=JSON.parse('{"MM_EMAIL":2000,"MM_SIGN":2001,"MM_STORE":2002,"MM_DOWNLOAD":2003,"MM_WEBHOOK":2004, "MM_FORM": 2005, "MM_FILL": 2006, "MM_DELUGE": 2007, "MM_CONVERSION": 2008}'),SKU_OP_DELIVERY_CONST=JSON.parse('{"EMAIL":3000,"SIGN":3001,"STORE":3002,"DOWNLOAD":3003,"WEBHOOK":3004, "DELUGE": 3005}'),INTERVAL=JSON.parse('{"MONTH":1,"YEAR":4,"DAY":7}'),WRAP_TYPE={SQUARE:"square",FRONT:"front",BEHIND:"behind"},CHARACTER_TYPES={L:0,LRE:1,LRO:2,R:3,AL:4,RLE:5,RLO:6,PDF:7,EN:8,ES:9,ET:10,AN:11,CS:12,NSM:13,BN:14,B:15,S:16,WS:17,ON:18,LRI:19,RLI:20,FSI:21,PDI:22},BIDIRECTIONAL_LINE_TYPE={L:0,R:1,AL:2,MIXED:3,OTHER:4},MAP_DEFAULTSTRING={GMAP:"https://maps.google.com/maps?q="},RENDERING_FONTS={CHECKBOXES_AND_RADIO_FIELDS:"DejaVu Sans"},CHECKBOXES_AND_RADIO_FIELDS=[FILLABLEFIELD_TYPE.RADIO,FILLABLEFIELD_TYPE.MULTIPLECHOICE,FILLABLEFIELD_TYPE.CHECKBOX],TABLE_SORT_TYPE={STRING:0,NUMBER:1,DATE:2},CONVERSION_UNSUPPORTED_MAP={"Image wrap":"writer.conversion.IMAGE_WRAP","Image positioning":"writer.conversion.IMAGE_POSITIONING","Shape wrap":"writer.conversion.SHAPE_WRAP","Shape positioning":"writer.conversion.SHAPE_POSITIONING","Textbox wrap":"writer.conversion.TEXTBOX_WRAP","Textbox positioning":"writer.conversion.TEXTBOX_POSITIONING","Auto-space (before paragraph)":"writer.conversion.AUTO_SPACE_BEFORE","Auto-space (after paragraph)":"writer.conversion.AUTO_SPACE_AFTER","Wingdings symbols (in list)":"writer.conversion.LIST_WINDINGS_SYMBOL","Tab underlines":"writer.conversion.TAB_UNDERLINES","System fonts":"writer.conversion.SYSTEM_FONTS","Floating table":"writer.conversion.FLOATING_TABLE","Line numbering":"writer.conversion.LINE_NUMBERING","Work In Progress":"writer.conversion.WORK_IN_PROGRESS","In Roadmap":"writer.conversion.IN_ROADMAP",Unsupported:"writer.conversion.UNSUPPORTED"},CONVERSION_UNSUPPORTED_DESCRPTION={"Image wrap":"writer.conversion.IMAGE_WRAP_DESC","Image positioning":"writer.conversion.IMAGE_POSITIONING_DESC","Shape wrap":"writer.conversion.SHAPE_WRAP_DESC","Shape positioning":"writer.conversion.SHAPE_POSITIONING_DESC","Textbox wrap":"writer.conversion.TEXTBOX_WRAP_DESC","Textbox positioning":"writer.conversion.TEXTBOX_POSITIONING_DESC","Auto-space (before paragraph)":"writer.conversion.AUTO_SPACE_BEFORE_DESC","Auto-space (after paragraph)":"writer.conversion.AUTO_SPACE_AFTER_DESC","Wingdings symbols (in list)":"writer.conversion.LIST_WINDINGS_SYMBOL_DESC","Tab underlines":"writer.conversion.TAB_UNDERLINES_DESC","System fonts":"writer.conversion.SYSTEM_FONTS_DESC","Floating table":"writer.conversion.FLOATING_TABLE_DESC","Line numbering":"writer.conversion.LINE_NUMBERING_DESC"},CONVERSION_UNSUPPORTED_TOOL_TIP={"Work In Progress":"writer.conversion.WORK_IN_PROGRESS_TOOLTIP",Unsupported:"writer.conversion.UNSUPPORTED_TOOLTIP","In Roadmap":"writer.conversion.IN_ROADMAP_TOOLTIP"},SEQUENCE_NUMBER={NAME:"name",VALUE:"value",PREFIX:"prefix",SUFFIX:"suffix",START_WITH:"start_with"},RESTRICTED_DATE_OPERATORS=["Contains","Contains-IC","Does not Contain","Does not Contain-IC","Begins With","Begins with-IC","Ends With","Ends With-IC","Is-IC","Is not-IC"],TEXT_DATE_FILTER_OPERATORS=["Is Empty","Is Not Empty"],linkRelativeRegex=/^((ht|f)tp(s?)\:\/\/){0,1}[-.\w]*(\/?)([a-zA-Z0-9\|\(\)~\-\.\!\?\,\:\'\/\\\+\*=&amp;%\$#_@\P{InBasicLatin}]*)?$/,linkRegex=/^((ht|f)tp(s?)\:\/\/)[-.\w]*(\/?)([a-zA-Z0-9\|\(\)~\-\.\!\?\,\:\'\/\\\+\*=&amp;%\$#_@\P{InBasicLatin}]*)?$/,isIPadSafariBrowser="undefined"!=typeof navigator&&navigator.maxTouchPoints>1,FILLABLE_FIELDS_TYPES_SUPPORTED_IN_FORMULA=[FILLABLEFIELD_TYPE.SINGLELINE,FILLABLEFIELD_TYPE.CURRENCY,FILLABLEFIELD_TYPE.NUMBER,FILLABLEFIELD_TYPE.PERCENT,FILLABLEFIELD_TYPE.PHONE,FILLABLEFIELD_TYPE.MULTILINE],PAGE_ORIENTATION={PORTRAIT:"Portrait",LANDSCAPE:"Landscape"},FIELD_PARENTHESIS={MERGEFIELD_START:"«",MERGEFIELD_END:"»",FILLABLE_START:"{",FILLABLE_END:"}",TABLE_REF_START:"[",TABLE_REF_END:"]",TABLE_REF_START_REGEX:"\\[",TABLE_REF_END_REGEX:"\\]",OPEN_PARENTHESIS:"(",CLOSE_PARENTHESIS:")",OPEN_PARENTHESIS_REGEX:"\\(",CLOSE_PARENTHESIS_REGEX:"\\)"},RENDERING_LAYERS={MODEL:"model",DOCTREE:"doctree",DTVIEW:"dtview",DOCVIEW:"docview",DOMVIEW:"domview"},ALL_RENDERING_LAYERS=[RENDERING_LAYERS.MODEL,RENDERING_LAYERS.DOCTREE,RENDERING_LAYERS.DTVIEW,RENDERING_LAYERS.DOCVIEW,RENDERING_LAYERS.DOMVIEW],MAILMERGE={MMINFO:"mminfo",MMINFOS:"mminfos",FIELD_ID:"id",F_ID:"fid",FIELD_NAME:"display_name",SHORTEN_NAME:"shorten_name",GROUP_NAME:"groupname",PARENT_ID:"parentid",MODULE:"module",DISPLAY_VALUE:"display_value",LINK_VALUE:"link_value",LIST_TYPE:"list_type",LIST_TYPES:{HORIZONTAL:"horizontal",VERTICAL:"vertical"},TYPE:"type",SUB_TYPE:"sub_type",CATEGORY:"category",CATEGORIES:{IMPORTED:"imported",CREATED:"created"},VALUE_FORMAT:"value_format",FORMAT:"format",VALUE:"value",VALUES:"values",SYMBOL:"symbol",COUNTRY_CODE:"country_code",FORMULA:"formula",MAPPING:"mapping",FIELD_TYPE:{TEXT:"text",MULTILINE:"multiline",RICHTEXT:"richtext",NUMBER:"number",DATE:"date",EMAIL:"email",WEBSITE:"website",IMAGE:"image",IMAGELIST:"imagelist",LIST:"list",CHECKBOX:"checkbox",BARCODE:"barcode",QRCODE:"qrcode",SEQUENCE:"sequence",WIDGET:"widget",MAP:"map",MATRIX_CHOICE:"matrix_choice"},FIELD_SUBTYPE:{RADIO:"radio",CHECKBOX:"checkbox",DROPDOWN:"dropdown",TEXTBOX:"textbox"},COLUMN_HEADING:"column_heading",ROW_HEADING:"row_heading",MERGE_FIELD:"mergeField",BUILD_IN_FIELD:"buildInField",NEXT:"NEXT",SEQUENCE:"SEQUENCE",DUMMY_IMAGE:"mm-image",ACTION:{PREVIEW:"preview",MERGE:"merge",STORE:"store",EMAIL:"email",SIGN:"sign",SAVEDATA:"savedata",DOWNLOAD:"download",INVOKE:"invoke",PRINT:"print",WEBHOOK:"webhook",FILL:"fill"},CHECK_BOX:{CHECKED:"☑",UNCHECKED:"☐",FONT:"DejaVu Sans"},RADIO_BTN:{CHECKED:"◉",UNCHECKED:"○",FONT:"DejaVu Sans"},CONDITION:"condition",BARCODE_INFO:"barcode_info",QRCODE_INFO:"qrcode_info",DATE_INFO:"date_info",DATE_LOCALE:"locale",DATE_TIMEZONE:"timezone",DATE_FORMAT:"format",DATE_CUSTOM_FORMAT:"custom_format",PLACEHOLDER_SRC:"placeholder_src",PLACEHOLDER_COLUMN:"placeholder_column",PLACEHOLDER_CELL:"placeholder_cell",EXCLUDED_SPECIALCHARS:/[!@#$%^&*()+=\[\]{};':\"\\|,.<>\/?]/,FIELDNAME_SPECIALCHAR_REGEX:/[!@#$%^&*()+=\[\]{};':"\\|,.<>\/?]/,URL_REGEX:/^((http|https|www\.)(:\/\/|)[\w-]+(\.[\w-]+)+([\w.,@?^=\(\)%&amp;:\/~+#-]*[\w@?^\(\)=%&amp;\/~+#-])?)$/,FILTER_DATA:"filter_data",GROUPBY:"groupby",PREFIX:"prefix",SUFFIX:"suffix",START_WITH:"start_with",PARENT_ID:"parentid",SOURCE:{CSV:1,REMOTE:2,ZOHO_SHEET:3,ZOHO_CONTACTS:4,ZOHO_CRM:5,ZOHO_FORMS:6,ZOHO_PEOPLE:7,ZOHO_RECRUIT:8,ZOHO_FORMS_AUTOMATION:10,ZOHO_CREATOR:11,ZOHO_CRM_INWRITER:12,ZOHO_ORCHESTLY:13,ZOHO_BOOKS:14,ZOHO_DELUGE:15},MM_SOURCE:{1:"CSV",2:"Remote",3:"Zoho Sheet",4:"Zoho Contacts",5:"Zoho CRM",6:"Zoho Forms",7:"Zoho People",8:"Zoho Recruit",10:"Zoho Forms",11:"Zoho Creator",12:"Zoho PC",13:"Orchestly",14:"Zoho Books"}},CustomJSON=function(){"use strict";var t=function(){this.map={},this.length=0};return extend(t.prototype,{add:function(t,e){this.map.hasOwnProperty(t)||this.length++,this.map[t]=e},remove:function(t){this.map.hasOwnProperty(t)&&(this.length--,delete this.map[t])},get:function(t){return this.map[t]},empty:function(){this.map={},this.length=0},isEmpty:function(){return!this.length}}),t}();DTContextUtils.isRangeInsideContentSection=function(){var t=DocLayoutManager.getCurrentSection();return t&&t.getSectionType()===SECTION_TYPES.CONTENT},DTContextUtils.isRangeInsideSingleSection=function(){var t=editor.doc.getSelection(),e=t.getStart(),n=t.getEnd()-1,r=DocTreeManager.getSectionAtIndex(e),i=DocTreeManager.getSectionAtIndex(n);return r===i},DTContextUtils.isEntireSectionInRange=function(){var t=editor.doc.getSelection(),e=t.getStart()-1,n=t.getEnd()-1,r=DocTreeManager.getSectionAtIndex(e);return e===r.getIndex()&&n===r.getEndIndex()},Utils.applyExcludes=function(t){var e=[],n=editorProps.permissionsInfo.appInfo;n.FEATURES&&n.FEATURES.exclude&&(e=e.concat(n.FEATURES.exclude)),n.MODULES&&n.MODULES.exclude&&(e=e.concat(n.MODULES.exclude)),editorProps.viewInfo.view&&editorProps.viewInfo.view.exclude&&(e=e.concat(editorProps.viewInfo.view.exclude));for(var r=t.querySelectorAll("*"),i=0;i<r.length;i++){var o=r[i],s=o.getAttribute("id"),a=o.getAttribute("data-module"),l=U.contains(e,s)||U.contains(e,a);l&&o.parentNode.removeChild(o)}return t},Utils.isModuleEnabled=function(t){var e=[],n=editorProps.permissionsInfo.appInfo;n.MODULES&&n.MODULES.exclude&&(e=e.concat(n.MODULES.exclude)),editorProps.viewInfo.view&&editorProps.viewInfo.view.exclude&&(e=e.concat(editorProps.viewInfo.view.exclude));var r=!U.contains(e,t);return r},Utils.binarySearch=function(t,e){if(!t||!t.length)return null;for(var n=0,r=t.length-1,i=null,o=Array.prototype.slice.call(arguments,2);n<=r;){var s=parseInt((n+r)/2);i=t[s];var a=e.bind(null,i),l=a.apply(null,o);if(l<0)n=s+1;else{if(!(l>0))break;r=s-1}}return i},Utils.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},Utils.hexToString=function(t){for(var e="",n=0;n<t.length;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e},Utils.stringToHex=function(t){for(var e="",n=0;n<t.length;n++)e+=t.charCodeAt(n).toString(16);return e},Utils.isRTL=function(t){return"string"==typeof t&&(STARTS_WITH_RTL_REGEX.test(t)||STARTS_WITH_LTR_REGEX.test(t)||ENDS_WITH_RTL_REGEX.test(t))},Utils.isStrictRTL=function(t){if("string"!=typeof t)return!1;var e=!1;if(Utils.isRTL(t)&&(e=STRICT_RTL_REGEX.test(t),!e))for(var n=0,r=t.length;n<r;n++)e=Utils.areNeutralCharacters(t.charAt(n))||e;return e},Utils.isArabic=function(t){if("string"!=typeof t)return!1;var e=!1;if(Utils.isRTL(t)&&(e=ARABIC_REGEX.test(t),!e))for(var n=0,r=t.length;n<r;n++)e=Utils.areNeutralCharacters(t.charAt(n))||e;return e},Utils.areNeutralCharacters=function(t){return"string"==typeof t&&/^[-!$%^&*@()_+|#~=`{}\[\]:";'“”<>?,.\\\/0-9\f\r\n\v\x20\u00A0\u000e\u000f\u00130-9²-³¹¼-¾٠-٩۰-۹߀-߉०-९০-৯৴-৹੦-੯૦-૯୦-୯௦-௲౦-౯౸-౾೦-೯൦-൵๐-๙໐-໙༠-༳၀-၉႐-႙፩-፼\u16ee-\u16f0០-៩៰-៹᠐-᠙᥆-᥏᧐-᧙᭐-᭙᮰-᮹᱀-᱉᱐-᱙⁰⁴-⁹₀-₉⅓-\u2182\u2185-\u2188①-⒛⓪-⓿❶-➓⳽\u3007\u3021-\u3029\u3038-\u303a㆒-㆕㈠-㈩㉑-㉟㊀-㊉㊱-㊿꘠-꘩꣐-꣙꤀-꤉꩐-꩙０-９]|\ud800[\udd07-\udd33\udd40-\udd78\udd8a\udf20-\udf23\udf41\udf4a\udfd1-\udfd5]|\ud801[\udca0-\udca9]|\ud802[\udd16-\udd19\ude40-\ude47]|\ud809[\udc00-\udc62]|\ud834[\udf60-\udf71]|\ud835[\udfce-\udfff]+$/.test(t)};var escapedUnicodes={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},unicodeRegEx=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;Utils.escapeSplChars=function(t){return escapedUnicodes.hasOwnProperty(t)&&escapedUnicodes[t]?escapedUnicodes[t]:t=t.replace(unicodeRegEx,function(t){var e=t.charCodeAt(0),n="\\u";return 16>e?n+="000":256>e?n+="00":4096>e&&(n+="0"),escapedUnicodes[t]=n+e.toString(16)})},Utils.encodeHTMLChars=function(){var t={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&#34;"};return function(e){return isV8Engine?e:t[e]||e}}(),Utils.encodeHTMLString=function(t){for(var e="",n=0,r=t.length;n<r;n++)e+=Utils.encodeHTMLChars(t[n]);return e},Utils.isEncodeHTMLChar=function(t){return"<"==t||">"==t||"&"==t||'"'==t};var chars="abcdefghijklmnopqrstuvwxyz0123456789";Utils.randomString=function(t){for(var e=t||12,n="",r=0;r<e;r++){var i=Math.floor(Math.random()*chars.length);n+=chars.substring(i,i+1)}return n},Utils.getMomentFmt=function(){var t={yyyy:"YYYY","M/d/yy":"M/D/YY","dd/MM/yyyy":"DD/MM/YYYY","dd.MM.yyyy":"DD.MM.YYYY","dd/mm/yyyy":"DD/MM/YYYY","dd.mm.yyyy":"DD.MM.YYYY","M.d.yy":"M.D.YY","M/d/yyyy":"M/D/YYYY","MMM. d, yy":"MMM. D, YY","MMMM, yy":"MMMM, YY","MMM-yy":"MMM-YY","MMMM d, yyyy":"MMMM D, YYYY","d-MMM-yy":"D-MMM-YY","d MMMM yyyy":"D MMMM YYYY","d MMM YYYY":"D MMM YYYY","d MMMM, yyyy":"D MMMM, YYYY","d MMMM yyyy":"D MMMM YYYY","d/M/yy":"D/M/YY","d/M/yyyy":"D/M/YYYY","d-M-yyyy":"D-M-YYYY","yyyy-M-d":"YYYY-M-D","dddd, MMMM d, y":"dddd, MMMM D, YYYY","yyyy-MM-dd":"YYYY-MM-DD","yyyy/MM/dd":"YYYY/MM/DD","HH:mm":"HH:mm","HH:mm:ss":"HH:mm:ss","h:mm am/pm":"h:mm A","h:mm:ss am/pm":"h:mm:ss A","M/d/yy h:mm am/pm":"M/D/YY h:mm A","M/d/yy h:mm:ss am/pm":"M/D/YY h:mm:ss A","M/d/yy HH:mm:ss":"M/D/YY HH:mm:ss","d/M/yyyy HH:mm:ss":"D/M/YYYY HH:mm:ss","dd/MM/yyyy, HH:mm":"DD/MM/YYYY, HH:mm","dddd, MMMM d, yyyy h:mm A":"dddd, MMMM d, YYYY h:mm A"};return function(e){return t[e]||e}}(),Utils.isLeadSurrogateChar=function(t){return/[\uD800-\uDBFF]/.test(t)},Utils.isTrailSurrogateChar=function(t){return/[\uDC00-\uDFFF]/.test(t)},Utils.getRandomNumber=function(t,e){return t=t||1e7,e=e||99999999,parseInt(Math.random()*(e-t)+t)},Utils.uniqueArray=function(t){var e=[];return Array.isArray(t)?(t.forEach(function(t,n){e.contains(t)?null:e.push(t)}),e):null},Utils.getCommonKeys=function(t,e){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];e.indexOf(o)!=-1&&n.push(o)}return n},Utils.textLen=function(t){var e=0,n=t.nodeType;if(3==n)e+=t.nodeValue.length;else if(1==n)if(J(t).hasClass("zw-space"))e+=1;else if(DomUtil.nodeNameEquals(t,"img")&&(t.className||"").toLowerCase().indexOf("spacer")==-1||DomUtil.nodeNameEquals(t,"image")&&t.classList.contains("zw-image"))e+=1;else if(t.hasChildNodes())for(var r=t.childNodes,i=r.length,o=0;o<i;o++)e+=Utils.textLen(r[o]);return e},Utils.getAsFunction=function(t){if(t){var e,n=t.split("."),r=window,i="";return J(n).each(function(t,o){e=o.indexOf("()"),r=e>0?r[o.substring(0,e)]():r[o],t==n.length-2&&(i=r)}),{fn:r,base:i,callable:function(){r&&r.call&&r.call(i,arguments[0])},invoke:function(){r&&r.apply(i,arguments)}}}},Utils.constructStyleText=function(t,e){var n="",r=DocUtil.copyStyle(t),i=[ATTR_PARAGRAPH.PS_SA,ATTR_PARAGRAPH.PS_SB,ATTR_PARAGRAPH.PS_LS,ATTR_PARAGRAPH.PS_BGC,ATTR_COMMON.BORDERS,ATTR_PARAGRAPH.PS_ML,ATTR_PARAGRAPH.PS_PL,ATTR_PARAGRAPH.PS_TI,ATTR_PARAGRAPH.PS_AL,"textFormat"];e&&i.filter(function(t){delete r[t]});var o=Utils.getStyle(r);for(var s in o.styles)if(isHeadlessPDF&&"letter-spacing"==s)n+=s+":normal;\n";else if("font-size"!=s||"super"!=o.styles["vertical-align"]&&"sub"!=o.styles["vertical-align"])n+=s+":"+o.styles[s]+";\n";else{var a,l=o.styles[s].convertor().points;l=!isNaN(l)&&parseInt(l),a=parseInt(.7*l)+"pt",n+=s+":"+a+";\n"}return n},Utils.getStyleText=function(t,e,n,r,i){var o,s,a,l;r?(o="#editorpane div.heading",s=" span.zw-portion",a="#editorpane .zw-paragraph",l="#editorpane span.zw-portion"):(o="p.heading",s=" span.zw-portion",l="span.zw-portion",a="p.zw-paragraph");var d="",c="";for(var p in t)if("name"!==p){var E=p.substring(1),u=Utils.constructStyleText(t[p],r);if(e){if(d+=("h0"===p?a:o+E)+"{\n",i&&!t[p].hasOwnProperty(ATTR_PARAGRAPH.PS_LS)){var T=t.h0[ATTR_PARAGRAPH.PS_LS];u+="line-height : "+T+";\n"}d+=u+"}\n",u=Utils.constructStyleText(t[p].textFormat,r),c+=("h0"!=p?o+E+s:l)+"{\n"}else n&&(c+="div#editorpane div.zw-paragraph span.char_sty"+p+"{\n");c+=u+"}\n"}return d+c},Utils.setDocumentStyle=function(t){var e=DocumentDesign.getComputedStyles(),n=Utils.getStyleText(e.para,!0,!1,!0,!1),r=Utils.getStyleText(e.char,!1,!0,!0,!1),i=n+r+".zeroSize { font-size: 0pt !important; } .aligntop { vertical-align: top; }";if(!isV8Engine){var o=document.getElementById("styleforeditor");o.styleSheet&&o.styleSheet.cssText?o.styleSheet.cssText=i:J(o).text(i)}if(isHeadlessPDF&&!isV8Engine){var s=document.getElementById("styleforpdf");!s||editor.browserInfo.is_firefox||editor.browserInfo.is_edge||s.sheet.insertRule("::-webkit-scrollbar { display: none; }")}Utils.getStyleText(e.para,!0,!1,!1,!0);return i},Utils.getStyle=function(t){if(!t)return null;var e={},n="",r=DomUtil.getBorderStyles(t);for(var i in t)if(t.hasOwnProperty(i)&&"type"!=i){var o=t[i];if("cls"==i)n+=" "+o;else if(i==ATTR_TEXT.TS_CS)"none"==o&&(o="normal"),r["letter-spacing"]=o;else if("st"==i&&o==NODE_TYPE.TAB)n+=" tab";else if(i==ATTR_TEXT.TS_FW||i===ATTR_TEXT.TS_FW_I){var s=Math.max("bold"===t[ATTR_TEXT.TS_FW]?700:0,t[ATTR_TEXT.TS_FW_I]||0);s&&(r["font-weight"]=s)}else if(i==ATTR_TEXT.TS_FF)"none"==o&&(o=""),r["font-family"]=Utils.fontFamilyRenderingFix(o);else if(i==ATTR_TEXT.TS_FV)"none"==o&&(o=""),r["font-variant"]=o;else if(i==ATTR_TEXT.TS_FS)"none"==o&&(o="normal"),r["font-style"]=o;else if(i==ATTR_TEXT.TS_SIZE)"none"==o?r["font-size"]="":(o=parseFloat(o)+"pt",r["font-size"]=o);else if(i==ATTR_TEXT.TS_FGC)"none"==o&&(o=""),r.color=o;else if(i==ATTR_TEXT.TS_BGC)"none"==o&&(o=""),r["background-color"]=o;else if(i==ATTR_TEXT.TS_TD)"none"==o?r["text-decoration"]="none":t.cls&&"link"==t.cls&&o.indexOf("line-through")>-1?r["text-decoration"]="line-through underline":r["text-decoration"]=o;else if(i==ATTR_TEXT.TS_VA&&"none"!=o)r["vertical-align"]=o;else{if(i==ATTR_TEXT.TS_NULL){delete t[i],o&&(r={});break}i==ATTR_PARAGRAPH.PS_SB?r["margin-top"]=o:i==ATTR_PARAGRAPH.PS_DIR?r.direction=o:i==ATTR_PARAGRAPH.PS_SA?r["margin-bottom"]=o:i==ATTR_PARAGRAPH.PS_ML?r["margin-left"]=o:i==ATTR_PARAGRAPH.PS_MR?r["margin-right"]=o:i==ATTR_PARAGRAPH.PS_PL?r["padding-left"]=o:i==ATTR_PARAGRAPH.PS_PR?r["padding-right"]=o:i==ATTR_PARAGRAPH.PS_TI?r["text-indent"]=o:i==ATTR_PARAGRAPH.PS_BGC?"none"==o?r["background-color"]="":r["background-color"]=o:i==ATTR_PARAGRAPH.PS_LS?r["line-height"]=o:i==ATTR_PARAGRAPH.PS_AL&&0==o?r["text-align"]="left":i==ATTR_PARAGRAPH.PS_AL&&1==o?r["text-align"]="center":i==ATTR_PARAGRAPH.PS_AL&&2==o?r["text-align"]="right":i==ATTR_PARAGRAPH.PS_AL&&3==o?r["text-align"]="justify":i==ATTR_PARAGRAPH.PS_WS&&(r["word-spacing"]=o)}}return e.styles=r,e},Utils.prevScrollTime=null,Utils.scrollTimer=200,Utils.getDocumentId=function(){var t=Macros.getRId();return t},Utils.isSupportedDocument=function(t){return/\.(wordprocessingml|html|openxmlformats|msword|macroEnabled|opendocument|plain)$/i.test(t)},Utils.triggerNotification=function(){Macros.triggerNotification()},Utils.hiliteText=function(t){var e=J("div.zw-page").css("background-color");if(t){EditorUtil.focusMultiByteSpan(),document.designMode="on";var n=document.getElementsByTagName("body")[0];for(var r in t){var i=t[r];if(i){for(;window.find(i,!1);){if(document.execCommand("BackColor",!1,"yellow"),window.getSelection){var o,s=window.getSelection();s.collapseToEnd()}else document.selection&&document.selection.createRange&&(o=document.selection.createRange(),o.execCommand("BackColor",!1,colour));document.execCommand("HiliteColor",!1,"yellow")||document.execCommand("BackColor",!1,"yellow")}window.getSelection().collapse(n,0)}}document.designMode="off",EditorUtil.focusMultiByteSpan(),J("div.zw-page").css("background-color",e)}},Utils.goToLink=function(t){var e,n,r,i=editor.doc.getSelection(),o=i.getParents(NODE_TYPE.IMAGE);if(o?(e=editor.doc.getSelection().getParents(NODE_TYPE.IMAGE).attr().linkData,e&&(n=e.type,r=e.url)):(e=editor.doc.getParents(NODE_TYPE.LINK,editor.doc.getSelection().getStart()-1),e&&(n=e.attr(ATTR_LINK.LINK_TYPE),r=e.attr(ATTR_LINK.LINK_URL))),PubSub.publish("Link/Clicked",e),e)if(n===LINK_TYPES.BOOKMARK){var s=/^http(s)?:\/\/.*\..*/i,a=/^www\..*\..*/i,l=r;if(s.test(l)||a.test(l))a.test(l)&&(l=editor.scheme+"://"+l),Utils.safeWindowOpen(decodeURI(l));else{var d=!0;Utils.moveToBookmark(l,t,d)}}else Utils.isRelativeLink(r)&&(r=Utils.getAbsoluteLink(r)),Utils.safeWindowOpen(decodeURI(r));return J("#ui-link-bubble-div").hide(),!1},Utils.safeWindowOpen=function(t,e,n){var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(i+"="+e[i]);n=n||"";var o=(r.join(","),new RegExp("^(http|https|mailto:)","i"));o.test(t)||(t=editor.scheme+"://"+t);var s;if(editor.browserInfo.is_macApp)s=window.open(t,n,r);else{s=window.open("_blank",n,r);var a=new RegExp("^mailto:","i");a.test(t)||(s.opener=null),s.location.href=t,s.document.close()}return!1},Utils.strToVar=function(t){t=t.substring(1);for(var e,n=t.match(/(\w)+/g),r=0;r<n.length;r++)e=e?e[n[r]]:window[n[r]];return e},Utils.getWordBreakIndex=function(t,e,n){t=t||1,n=n||editor.doc.getDocumentContent(),WORD_BREAK_REGEX_FOR_LINE.lastIndex=t;for(var r,i,o,s=[];r=WORD_BREAK_REGEX_FOR_LINE.exec(n)[0];){RANGE_CHARS_REGEX.lastIndex=0;for(var a=RANGE_CHARS_REGEX.exec(r);null!=a;){if(o=t+a.index,n.charAt(o)==UNICODE.RANGE_START){var l=editor.doc.getRawFormatAt(o);(l.hasOwnProperty(ATTR_IMAGE.I_WRAP_TYPE)||l.hasOwnProperty(ATTR_CUSTOM.DISPLAY_TYPE))&&(i=l.id,o!=t?s.push(o):void 0,o+1!=t+r.length?s.push(o+1):void 0)}else if(n.charAt(o)==UNICODE.RANGE_END){var l=editor.doc.getRawFormatAt(o);l.id==i&&(o!=t?s.push(o):void 0,o+1!=t+r.length?s.push(o+1):void 0)}a=RANGE_CHARS_REGEX.exec(r)}if(t+=r.length,e&&t>e)break;s.push(t),WORD_BREAK_REGEX_FOR_LINE.lastIndex=t}return s},Utils.findNextIndexOf=function(t,e,n){e=e?e:0;var r=RegExp(t,"g");r.lastIndex=e;var i=r.exec(n),o=-1;return i&&(o=i.index),o>=0?o:-1},Utils.findPreviousIndexOf=function(t,e,n){var r,i,o,s,a,l;if(e=e&&e>0?e:0,r=RegExp(t,"g"),i=r.exec(n),!i)return-1;for(o=0,r.lastIndex=0,a=0,l=n.length+1;a+1<l;)s=parseInt((a+l)/2),r.lastIndex=s,i=r.exec(n),i?(a=s,r.lastIndex=s):(l=s,r.lastIndex=a);return i=r.exec(n),i.index},Utils.perFormanceTime={},Utils.startTime=function(t){Utils.perFormanceTime[t]||(Utils.perFormanceTime[t]={}),Utils.perFormanceTime[t].startTime=new Date},Utils.endTime=function(t){return Utils.perFormanceTime[t]&&Utils.perFormanceTime[t].startTime?(new Date-Utils.perFormanceTime[t].startTime)/1e3:0},Utils.getCurrentTypingDirection=function(t){t||(t="start");var e,n,r=editor.doc.getSelection(),n=r.getNodesInSelection(NODE_TYPE.PARAGRAPH),i=n.length;return"start"==t?para=n[0]:para=n[i-1],e=para.attr(ATTR_PARAGRAPH.PS_DIR),void 0==e&&(e="ltr"),e},Utils.addId=function(t,e,n){return e=e||"",t.id=e+Utils.randomString(n),t},Utils.fontFamilyRenderingFix=function(t){if(t&&"string"==(typeof t).toLowerCase()&&"none"!=t){for(var e=t.split(","),n=0,r=e.length;n<r;n++)e[n]=e[n].trim(),e[n].indexOf(" ")!=-1&&(e[n]="'"+e[n]+"'");t=e.join(",")}return t},Utils.getUnsupportedFonts=function(){var t=[],e=editor.doc.getBodyFormat();return U.each([e.theme.font.major.latin,e.theme.font.minor.latin],function(e){e=FontUtils.stringToFonts(e)[0],Utils.isUnsupportedFont(e)&&t.push(e)}),U.each(editor.doc.getFormats(),function(e){if(e&&e[ATTR_TEXT.TS_FF]){e=DocUtil.getRenderingFormat(e);var n=FontUtils.stringToFonts(e[ATTR_TEXT.TS_FF])[0];Utils.isUnsupportedFont(n)&&t.push(n)}}),t=U.unique(t)},Utils.isUnsupportedFont=function(t){return!t||!(editorProps.fonts.hasOwnProperty(t.toLowerCase())||Utils.isWebFont(t)||Utils.isCustomFont(t.toLowerCase()))},Utils.isWebFont=function(t){for(var e=t&&t.split(",")||[],n=e.length;n--;)if(FontUtils.getWebFont(e[n]))return!0;return!1},Utils.getThemeFonts=function(t){return FontUtils.stringToFonts(t.font.minor.latin+","+t.font.major.latin)},Utils.getColorReference=function(t){var e=["light1","dark1","light2","dark2","accent1","accent2","accent3","accent4","accent5","accent6"],n="",r=t.otherData,i=r&&r.colorPan[0]?J(r.colorPan[0].parentElement).index():-1;return i=i!=-1&&1==J(r.colorPan[0]).parents("div")[0].children.length?-1:i,r&&!r.baseColor&&i>=0?n="zw"+e[i]:r&&r.baseColor&&i>=0?(n="zw"+e[i],n+="lighten"==r.toneType?"/":"*",n+=100-parseFloat(r.tonePercent)):n=ZWColorUtils.rgbaToRgb(t.color),n},Utils.getColorValFromRefString=function(t){var e=/[z][w](\w|\*|\/)+/,n=/\#(\w|\*|\/)+/,r=e.test(t),i=n.test(t);if(!r&&!i)return t;var o=e.exec(t),s=n.exec(t),a=t,l=r?o[0].substr("zw".length):s[0].substr("#".length);if(l.indexOf("accent")>-1||l.indexOf("dark")>-1||l.indexOf("light")>-1){var d=null,c=null,p=null,E=DocumentDesign.getTheme();l.indexOf("*")>-1?(d=l.split("*")[0],c=parseInt(l.split("*")[1])):l.indexOf("/")>-1?(d=l.split("/")[0],p=parseInt(l.split("/")[1])):d=l,d=E.color[d],a=c||p?c?ZWColorUtils.getColorAfterShade(d,c):ZWColorUtils.getColorAfterTint(d,p):d}return a},Utils.randomId=function(t){return t+"_"+("x"+Math.random()).replace(/\D/g,"")},Utils.getFontFamilies=function(t){for(var e,n,r=FontUtils.stringToFonts(t),i=editorProps.fonts,o=editorProps.alternativeFonts||{},s=Utils.getUserCustomFonts(),a=0,l=r.length;a<l;a++){if(e=r[a].toLowerCase(),i.hasOwnProperty(e))return i[e].value;if(s.hasOwnProperty(e)){var o=s[e].name;return o}if((n=FontUtils.getWebFont(e))||(n=o[e]&&FontUtils.getWebFont(o[e].fallback)))return n.getFontName()}return t||""},Utils.isSpaceChar=function(){var t=[UNICODE.IMAGE,UNICODE.BR,UNICODE.TAB];return function(e){return ZWArrayUtils.arrayContains(t,e)}}(),Utils.WriterCallbacks=function(){var t={};return{register:function(e,n){t[e]=t[e]||[],t[e].push(n)},evaluate:function(e){var n=!0;t[e]=t[e]||[];for(var r=0;r<t[e].length;r++){var i=t[e][r];if(n=n&&i(),!n)return!1}return n},reduce:function(e,n,r){var i=t[e];if(i&&i.length){var o=t[e].map(function(t){return t()});return U.reduce(o,n,r)}return{}}}}(),Utils.getFillableFieldValue=function(t){var e,n=t[ATTR_FILLABLEFIELD.FF_INFO];if(!n)return"";if(!isHeadlessPDF&&!isHeadlessHTML&&"undefined"!=typeof navigator&&!editorProps.isPublishToFill&&(Macros.isFillableTemplate()||Macros.isMergeTemplate())){var r,i="undefined"!=typeof FieldPreFillHandler?FieldPreFillHandler.getPrefillInfo(NODE_TYPE.FILLABLEFIELD):docProps.TEMPLATE_SETTINGS&&docProps.TEMPLATE_SETTINGS.fill&&docProps.TEMPLATE_SETTINGS.fill.onsubmit.prefill_info,o=i&&i.field_map&&i.field_map[t.id],s=n.hasOwnProperty(ATTR_FILLABLEFIELD.FF_LIST);if(o&&(r=s?"string"==typeof o.list?o.list:o.list[o.idx]||"":o),r)return r}return e=n[ATTR_FILLABLEFIELD.FF_LIST]&&(n[ATTR_FILLABLEFIELD.FF_SELECTED_INDEX]===-1?"--"+J.i18n("writer.common.SELECT")+"--":n[ATTR_FILLABLEFIELD.FF_LIST][n[ATTR_FILLABLEFIELD.FF_SELECTED_INDEX]||0])||n[ATTR_FILLABLEFIELD.FF_VALUE],t[ATTR_FILLABLEFIELD.FF_TYPE]==FILLABLEFIELD_TYPE.CHECKBOX||t[ATTR_FILLABLEFIELD.FF_TYPE]==FILLABLEFIELD_TYPE.MULTIPLECHOICE?e=n[ATTR_FILLABLEFIELD.FF_CHECKED]?FILLABLEFIELD_PROPS.CHECKED_SYMBOL:FILLABLEFIELD_PROPS.UNCHECKED_SYMBOL:t[ATTR_FILLABLEFIELD.FF_TYPE]==FILLABLEFIELD_TYPE.RADIO&&(e=n[ATTR_FILLABLEFIELD.FF_CHECKED]?FILLABLEFIELD_PROPS.DISC_SYMBOL:FILLABLEFIELD_PROPS.CIRCLE_SYMBOL),""==e&&(e=" "),e},Utils.getFieldMap=function(t){if(t===NODE_TYPE.FILLABLEFIELD){var e={};return editor.getDocument().visitAllFields(t,function(t){e[t.getId()]=t.name}),e}},Utils.getFieldMapWithLabel=function(t,e,n){if(t===NODE_TYPE.FILLABLEFIELD){var r={},i=[];return editor.getDocument().visitAllFields(t,function(t){t.name&&(e||!i.contains(t.name)&&i.push(t.name))&&(n?n===t.getFillableFieldType()&&(r[t.getId()]=t.name):r[t.getId()]=t.name)}),r}},Utils.getFieldMapWithoutDate=function(t){if(t===NODE_TYPE.FILLABLEFIELD){var e={},n=[];return editor.getDocument().visitAllFields(t,function(t){t.name&&t.getFillableFieldType()!=FILLABLEFIELD_TYPE.DATE&&!n.contains(t.name)&&(n.push(t.name),e[t.getId()]=t.name)}),e}},Utils.getFieldMapForFormula=function(t){if(t===NODE_TYPE.FILLABLEFIELD){var e={},n=[],r=new RegExp(FILLABLEFIELD_TYPE.SINGLELINE+"|"+FILLABLEFIELD_TYPE.CURRENCY+"|"+FILLABLEFIELD_TYPE.NUMBER+"|"+FILLABLEFIELD_TYPE.PERCENT+"|"+FILLABLEFIELD_TYPE.PHONE+"|"+FILLABLEFIELD_TYPE.MULTILINE);return editor.getDocument().visitAllFields(t,function(t){r.test(t.getFillableFieldType())&&!n.contains(t.name||"")&&(e[t.getId()]=t,t.name&&n.push(t.name))}),e}};var _getPrefilledValueForField=function(t,e){var n=FieldPreFillHandler.getPrefillModel(),r=e[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.SELECTBOX;if(r){var i;return i=t[ATTR_FILLABLEFIELD.FF_LIST].length?"fixed"==t.type?t[ATTR_FILLABLEFIELD.FF_LIST][t.idx]:t[ATTR_FILLABLEFIELD.FF_LIST]:" ",t.idx===-1&&"fixed"==t.type||" "==i?"--"+J.i18n("writer.common.SELECT")+"--":n.replaceIdsWithNames(i)}return e[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.CHECKBOX||e[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.MULTIPLECHOICE?"true"==t.checked?FILLABLEFIELD_PROPS.CHECKED_SYMBOL:FILLABLEFIELD_PROPS.UNCHECKED_SYMBOL:e[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.RADIO?"true"==t.checked?FILLABLEFIELD_PROPS.DISC_SYMBOL:FILLABLEFIELD_PROPS.CIRCLE_SYMBOL:t.trim()?n.replaceIdsWithNames(t):void 0};Utils.getFillableFieldResult=function(t){var e=ZWJSONUtils.clone(t[ATTR_FILLABLEFIELD.FF_INFO]);if(!e)return"";if(!isHeadlessPDF&&!isHeadlessHTML&&"undefined"!=typeof navigator&&!editorProps.isPublishToFill&&editor.getView()!=EDITOR_VIEWS.MAILMERGE_PREVIEW&&(Macros.isFillableTemplate()||Macros.isMergeTemplate())){var n,r=FieldPreFillHandler.getPrefillInfo(NODE_TYPE.FILLABLEFIELD),i=r.field_map&&r.field_map[t.id];if(i&&(n=_getPrefilledValueForField(i,t)),n)return n}var o=e[ATTR_FILLABLEFIELD.FF_VALUE]||"";if(t[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.CHECKBOX||t[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.MULTIPLECHOICE)return e[ATTR_FILLABLEFIELD.FF_CHECKED]?FILLABLEFIELD_PROPS.CHECKED_SYMBOL:FILLABLEFIELD_PROPS.UNCHECKED_SYMBOL;if(t[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.RADIO)return e[ATTR_FILLABLEFIELD.FF_CHECKED]?FILLABLEFIELD_PROPS.DISC_SYMBOL:FILLABLEFIELD_PROPS.CIRCLE_SYMBOL;if(t[ATTR_FILLABLEFIELD.FF_TYPE]===FILLABLEFIELD_TYPE.SELECTBOX)o=e[ATTR_FILLABLEFIELD.FF_SELECTED_INDEX]===-1?"--"+J.i18n("writer.common.SELECT")+"--":e[ATTR_FILLABLEFIELD.FF_LIST].length?e[ATTR_FILLABLEFIELD.FF_LIST][e[ATTR_FILLABLEFIELD.FF_SELECTED_INDEX]]:" ";else switch(e[ATTR_FILLABLEFIELD.FF_SUBTYPE]){case FILLABLEFIELD_TYPE.DATE:if(isNaN(o||".")||946665e6===o){o=" ";break}if(" "===o)break;"string"==typeof o&&(o=parseFloat(o));var s=e[ATTR_FILLABLEFIELD.FF_FORMAT]||"",a=e[ATTR_AUTOFIELD.LOCALE]||ZWUtils.getLocaleDetails().code||"en-US",l=new ZWDateTime(o,null,a);s=s.replaceAll("y","Y").replaceAll("d ","D ").replace(/dd\./g,"DD.").replace(/d\./g,"D."),o=l.format(s);break;case FILLABLEFIELD_TYPE.CURRENCY:"number"==typeof o&&(o=o.toString());var d=" "===o?"":o,c=!d.trim(),p=Numeral.getThousandAndDecimalSeperator(e[ATTR_AUTOFIELD.LOCALE]||Utils.getLocaleOfCurrencyCode(e[ATTR_FILLABLEFIELD.FF_CURRENCY_CODE]));if(o="",validatedValue="",e[ATTR_FILLABLEFIELD.FF_DECIMAL_SEPARATOR]=p.decimal,e[ATTR_FILLABLEFIELD.FF_THOUSAND_SEPARATOR]=p.thousands,o=e[e[ATTR_FILLABLEFIELD.FF_USE_CURRENCY_SYMBOL]?ATTR_FILLABLEFIELD.FF_CURRENCY_SYMBOL:ATTR_FILLABLEFIELD.FF_CURRENCY_CODE]+(c?"":" "),""!=d){var E=""!=d?parseFloat(d).toFixed(2):0,u=e[ATTR_FILLABLEFIELD.FF_CURRENCY_CODE],a=e[ATTR_AUTOFIELD.LOCALE]||Utils.getLocaleOfCurrencyCode(u),T=Utils.getCurrencyOptions(a,u);T.value=E,validatedValue=Numeral.applyThousandAndDecimalSeperator(T),validatedValue=validatedValue.replace(e[ATTR_FILLABLEFIELD.FF_CURRENCY_SYMBOL],""),validatedValue=validatedValue.replace(e[ATTR_FILLABLEFIELD.FF_CURRENCY_CODE],"")}o+=validatedValue.trim();break;case FILLABLEFIELD_TYPE.PHONE:o=o.replace(/[^0-9,-. +()]/g,"");break;case FILLABLEFIELD_TYPE.PERCENT:case FILLABLEFIELD_TYPE.NUMBER:var p,h,O,g=e[ATTR_AUTOFIELD.LOCALE],f=ZWUtils.getLocaleDetails().code||"en-US",_=e[ATTR_FILLABLEFIELD.FF_SUBTYPE]==FILLABLEFIELD_TYPE.NUMBER?"0":"0%",R=e[ATTR_FILLABLEFIELD.FF_NUMBER_FORMAT]||_,A=!1;if(f&&f!=g&&(p=Numeral.getThousandAndDecimalSeperator(g),O=R.split(p.decimal),h=Numeral.getThousandAndDecimalSeperator(f),A=!0,R=O[0].replaceAll("["+p.thousands+"]",h.thousands)+(O[1]?h.decimal+O[1]:"")),o&&" "!==o&&(R=" "==R?"":R,o=Formula.applyNumberFormat(o,R),A)){var I=o.split(h.decimal);o=I[0].replaceAll("["+h.thousands+"]",p.thousands)+(I[1]?p.decimal+I[1]:"")}}return o},Utils.getCurrencyOptions=function(t,e){var n=Numeral.getThousandAndDecimalSeperator(t),r=FormulaHandler.getCurrencyFormat(t,e).value,i=r.split(";")[0],o=i.match(/([#\d\u0660-\u0669\u06F0-\u06F9])([\d\u0660-\u0669\u06F0-\u06F9#,\.\u066B\u066C\s]+[#\d\u0660-\u0669\u06F0-\u06F9])?/)[0].trim(),s=o.split(n.decimal),a=s[1]?s[1].length:0,l=o.split(Formula.getSeparatorPattern(n.thousands)).length>1,d={langCountryCode:t,isCurrency:!0,currencyCode:e,useThousandGrouping:l,decimalPlaces:a};return d},Utils.getRadioOrMultipleChoiceValue=function(t){var e,n=t.getFillableFieldType(),r=t.getName();if(n===FILLABLEFIELD_TYPE.RADIO||n===FILLABLEFIELD_TYPE.MULTIPLECHOICE){var i=editor.getDocument().getFieldsByName(r,!0);return i.forEach(function(t){if(t.getFillableFieldType()==n){var r;t.isChecked()&&(r=t.getFieldValue()),n==FILLABLEFIELD_TYPE.RADIO&&r?e=r:n==FILLABLEFIELD_TYPE.MULTIPLECHOICE&&r&&(e=(e?e+",":"")+r)}}),e}},Utils.convertDate=function(t,e){if(!t)return null;e=Utils.getMomentFmt(e);var n=new Date(t).getTime(),r=new ZWDateTime(n).format(e||"M/D/YY");return r},Utils.convertMsToDate=function(t,e){if(!t||!e)return null;var n=Utils.getMomentFmt(e),r=new ZWDateTime(t).format(n||"M/D/YY");return r},Utils.getFillableFieldTooltip=function(){var t={},e=function(){t[FILLABLEFIELD_TYPE.MULTILINE]=J.i18n("writer.fillablefields.MULTILINE_FIELD"),t[FILLABLEFIELD_TYPE.SINGLELINE]=J.i18n("writer.common.TEXT_FIELD"),t[FILLABLEFIELD_TYPE.EMAIL]=J.i18n("writer.common.EMAIL_FIELD"),t[FILLABLEFIELD_TYPE.NUMBER]=J.i18n("writer.common.NUMBER_FIELD"),t[FILLABLEFIELD_TYPE.PHONE]=J.i18n("writer.common.PHONE_FIELD"),t[FILLABLEFIELD_TYPE.PERCENT]=J.i18n("writer.common.PERCENT_FIELD"),t[FILLABLEFIELD_TYPE.CURRENCY]=J.i18n("writer.common.CURRENCY_FIELD"),t[FILLABLEFIELD_TYPE.DATE]=J.i18n("writer.common.DATE_FIELD"),t[FILLABLEFIELD_TYPE.SELECTBOX]=J.i18n("writer.common.DROPDOWN_FIELD"),t[FILLABLEFIELD_TYPE.CHECKBOX]=J.i18n("writer.common.CHECKBOX_FIELD"),t[FILLABLEFIELD_TYPE.IMAGE]=J.i18n("writer.common.IMAGE_FIELD"),t[FILLABLEFIELD_TYPE.SIGNATURE]=J.i18n("writer.common.SIGNATURE_FIELD"),t[FILLABLEFIELD_TYPE.INITIAL]=J.i18n("writer.common.INITIAL_FIELD"),t[FILLABLEFIELD_TYPE.RADIO]=J.i18n("writer.common.RADIO_FIELD"),t[FILLABLEFIELD_TYPE.MULTIPLECHOICE]=J.i18n("writer.common.MULTIPLECHOICE_FIELD")};return function(n){return t[n]||e(),t[n]}}(),Utils.getDigiSignTag=function(t,e){if(t&&t.sfType){e||(e=ESIGN.ZOHOSIGN);var n="";return e===ESIGN.ZOHOSIGN&&(n+="{{"+(t.sfType==SIGNERFIELD_TYPE.CHECKBOX?"[]":t.sfType==SIGNERFIELD_TYPE.RADIO?"("+(t.fieldValue||ZOHOSIGN_TAG[t.sfType])+")":ZOHOSIGN_TAG[t.sfType]),n+=t.recipient?":"+t.recipient:"",n+=t.name?":"+t.name:"",n+=t.groupName?":"+t.groupName:"",n+=t.dateFormat?(t.name?"":":")+'(dateformat="'+t.dateFormat+'")':"",n+=t.dropdownOptions?(t.name?"":":")+'(options="'+t.dropdownOptions+'")':"",n+=t.mandatory?"*":"",n+="}}"),n}},Utils.allowTransformableSignerField=function(){return!0},Utils.getSignFieldContent=function(t){return Utils.allowTransformableSignerField()?" ":t.getValue()},Utils.getSignRecipientsInDocument=function(){var t,e=[],n=[],r=0,i=editor.getDocument(),o=i.getAllFields();for(var s in o){var a=o[s];a&&!a.isFillableField()&&a.isSignerField()&&(a.isSignerImageField()||a.signType===SIGN_TYPE.DIGISIGN)&&(t=a.getRecipient())&&(e.indexOf(t)==-1&&e.push(t),parseInt(t.replace(/\D/g,""))>r&&(r=parseInt(t.replace(/\D/g,""))))}for(var l=1;l<=r;l++)n.push("Recipient"+l);return{recipients:n,recipientCount:r,recipientsWithFields:e}},Utils.getSignRecipientsCount=function(){return Utils.getSignRecipientsInDocument().recipientCount},Utils.getRecipientsWithoutSignerFields=function(t){if(!t||"object"!=typeof t)return[];for(var e=[],n=1;n<=t.length;n++){var r=t[n-1];r?"string"!=typeof r&&r.action_type!=SIGNER_ROLE.SIGN||e.push("Recipient"+n):(t.splice(n-1,1),n--)}for(var i=Utils.getSignRecipientsInDocument().recipientsWithFields,n=0,o=i.length;n<o;n++){var s=e.indexOf(i[n]);s!=-1&&e.splice(s,1)}return e},Utils.appendDigisignFields=function(t,e){if(!t||"object"!=typeof t)return!1;for(var n=[],r=1;r<=t.length;r++){var i=t[r-1];i?"string"!=typeof i&&i.action_type!=SIGNER_ROLE.SIGN&&i.action_type!=SIGNER_ROLE.INPERSONSIGN||n.push("Recipient"+r):(t.splice(r-1,1),r--)}for(var o=Utils.getSignRecipientsInDocument().recipientsWithFields,r=0,s=o.length;r<s;r++){var a=n.indexOf(o[r]);a!=-1&&n.splice(a,1)}return e?UIUtils.appendZohoDigiSignFields(n,SIGNERFIELD_TYPE.SIGNATURE,e):(UIUtils.appendZohoDigiSignFields(n,SIGNERFIELD_TYPE.SIGNATURE,e),!!n.length)},Utils.getUserMode=function(t,e,n,r,i){var o=Macros.getUserModeParams(t);ZWNetworkUtils.ajax({type:"POST",dataType:"json",url:ZWNetworkUtils.getUrl("getUserMode"),data:o,async:!i,beforeSend:function(t){ZWNetworkUtils.setCsrfTokenInHeader(t)},error:function(){},success:function(t){n&&n(t,r)}})},Utils.getRangeEnd=function(t,e){var n=t.content,r=t.styles,i=r[e];if(!i)return e;for(var o=n.indexOf(UNICODE.SECTION_START,e);o!=-1&&"content"==r[o].st;)o=n.indexOf(UNICODE.SECTION_START,o+1);o==-1&&(o=n.length);for(var s=i.id;n.charAt(e)!==UNICODE.RANGE_END||!i||i.id!=s;){if(e=n.indexOf(UNICODE.RANGE_END,e+1),e<0||e>=o){e=o;break}i=r[e]}return e},Utils.isPrivateBrowsingMode=function(t){var e=!1,n=t.editorProps&&editorProps.browserInfo||{};if(n.is_chrome){var r=t.RequestFileSystem||t.webkitRequestFileSystem;r&&r(t.TEMPORARY,100,function(t){},function(t){e=!0})}else if(n.is_edge)t.indexedDB||!t.PointerEvent&&!t.MSPointerEvent||(e=!0);else if(n.is_firefox){var i=t.indexedDB.open("test");i.onerror=function(){e=!0}}else if(n.is_safari)try{t.openDatabase(null,null,null,null)}catch(t){e=!0}return function(){return e}}(window),Utils.getPublishSettings=function(t){var e=editor.doc.docInfo.RID,n=ZWNetworkUtils.getNiceUrlPrefix(e+"/util/publish_settings");J.ajax({global:!1,async:!0,type:"GET",url:n,success:function(e){e&&e.publish_settings&&Object.keys(e.publish_settings).length&&DocInfo.setProperty({PUBLISH_SETTINGS:e.publish_settings}),t&&t()},error:function(e,n,r){t&&t()}})},Utils.initFolderChooser=function(t){t.fileId=editor.doc.docInfo.RID,t.serviceName="zw",t.dialogTitle||(t.dialogTitle=J.i18n("writer.common.CHOOSE_FOLDER")),t.WDUrl=location.protocol+"\\\\"+editorProps.urls.teamdriveURL,t.zuid=editor.zuid,WDHandler.initialiseSaveAs(function(){PubSub.publish("FolderChooser/Init",{operation:t})})},Utils.getAutoDateValue=function(t){switch(t){case DATE_TYPE.CREATED:return"undefined"!=typeof editor&&editor.doc.docInfo.CREATED_DATE_LONG;case DATE_TYPE.LAST_MODIFIED:return"undefined"!=typeof editor&&editor.doc.docInfo.LAST_MODIFIED_TIME_LONG;case DATE_TYPE.CURRENT:default:return(new Date).getTime()}},Utils.removeDuplicateItemsInList=function(t){if(t)for(var e=0;e<t.length;e++){var n=t[e];t.indexOf(n)!=t.lastIndexOf(n)&&(t.splice(e,1),e--)}},Utils.isRelativeLink=function(t){return!(!t||!t.startsWith(ATTR_LINK.RELATIVE_LINK_CONST_VAL))},Utils.getAbsoluteLink=function(t){return url=Macros.getResourceLinkUrl(t),url},Utils.getUserCustomFonts=function(){return JSON.parse(editorProps.userInfo.settings.custom_font||"{}")},Utils.getCustomFont=function(t){var e=Utils.getUserCustomFonts();return e[(t||"").toLowerCase()]},Utils.isCustomFont=function(t){var e=Utils.getUserCustomFonts();return e.hasOwnProperty(t.toLowerCase())},Utils.once=function(t,e){var n;return function(){return t&&(n=t.apply(e||this,arguments),t=null),n}},Utils.negate=function(t,e){return function(){return!t.apply(e||this,arguments)}},Utils.loadRTE=function(t,e){var n=jsCdnZWStaticPath+fingerPrintObj["js/writer_rte_min_all.js"],r=[n],i=[cssCdnZWStaticPath+fingerPrintObj["styles/writer_rte_min_all.css"]],o=[cdnZWStaticPath+fingerPrintObj["html/rte/rte.html"]];t&&r.push(bluePencilJsPath),zw.require({js:r,html:o,css:i},[],function(t){var n=document.getElementById("rte-templates");if(!n){var r=document.createElement("div");r.id="rte-templates",r.innerHTML=t[o],document.body.appendChild(r)}e&&e()})},Utils.getTimeFromNow=function(t){if("string"==typeof t&&(t=parseInt(t)),t=new Date(t).getTime(),!t)return"";var e=(new Date).getTime()-t;if(e<6e4&&e>-1)return J.i18n("writer.common.A_FEW_SECONDS_AGO");var n="undefined"!=typeof editorProps&&editorProps.userInfo&&editorProps.userInfo.language?editorProps.userInfo.language:null;return t=new ZWDateTime(t,null,n),t.fromNow()},Utils.columnSection=function(t){var e,n=1;if(t.length&&(e=t[0],n="right"===e||"left"===e?2:e,DTContextUtils.isRangeInsideContentSection()&&DTContextUtils.isRangeInsideSingleSection())){var r=!1;DTContextUtils.isEntireSectionInRange()&&(r=!0);var i={count:n,width:[],space:[],seperator:"0",defaultspace:"0.500in",iseqwidth:!0};if("right"===e||"left"===e){var o=[],s=[],a=!1,l=Conversions.toGlobalValue("0.5in");if(!a){var d=DocLayoutManager.getCurrentSection(),c=d.getWidth(),p=c-(n-1)*l.convertor().pixels;p/=n+1,"left"===e?(o[0]=Conversions.toGlobalValue(p+"px"),o[1]=Conversions.toGlobalValue(2*p+"px")):"right"===e&&(o[0]=Conversions.toGlobalValue(2*p+"px"),o[1]=Conversions.toGlobalValue(p+"px")),s.push(l)}i[ATTR_BODY.DS_COLWID]=o,i[ATTR_BODY.DS_COLSPACE]=s,i[ATTR_BODY.DS_COLSEP]="0",i[ATTR_BODY.DS_DEFAULTSPACE]=l,i[ATTR_BODY.DS_COLISEQWID]=a}if(r){var E=editor.getDocument(),u=editor.doc.getSelection(),T=DocTreeManager.getSectionAtIndex(u.getStart());editor.doc.execCmd("updatesectionstyle",[{sectionNodes:[T],styles:{cols:i}},E]),E.sync()}else{var h={breakType:BREAK_TYPES.CONTINUOUS};editor.doc.execCmd("insertsectionbreak",{cols:i},h)}}},Utils.changeOrientation=function(){if(DTContextUtils.isRangeInsideContentSection()&&DTContextUtils.isRangeInsideSingleSection()){var t=!1;DTContextUtils.isEntireSectionInRange()&&(t=!0);var e=DocLayoutManager.getCurrentSection(),n=e.getGroup();if(n){var r=n.getPageHeight(),i=n.getPageWidth(),o=PAGE_ORIENTATION.PORTRAIT;r>i&&(o=PAGE_ORIENTATION.LANDSCAPE);var s={pw:Conversions.toGlobalValue(r+"px"),ph:Conversions.toGlobalValue(i+"px"),or:o,breakType:BREAK_TYPES.NEXT_PAGE};if(t){var a=editor.getDocument(),l=editor.doc.getSelection(),d=DocTreeManager.getSectionAtIndex(l.getStart());editor.doc.execCmd("updatesectionstyle",[{sectionNodes:[d],styles:s},a]),a.sync()}else{var c={breakType:BREAK_TYPES.NEXT_PAGE};Command.exec("insertsectionbreak",s,c),Op.sendMsg()}}}},Utils.openSectionLevelPageSetup=function(t){var e={isSectionLevel:!0};t&&t.length&&(e.tabToBeOpened=t[0]),PubSub.publish("PageLayout/ShowAdvancedPanel",e)},Utils.canEvaluateFillableFields=function(t){var e=editorProps.permissionsInfo.permissions,n=editorProps.userInfo.role,r=!1,i=e.indexOf("document.edit")!==-1,o=e.indexOf("document.fill")!==-1;return!i&&o&&(r=!0),isRemote=!!editorProps.options.REMOTE&&editorProps.isPublishToFill,isPublic=USER_ROLE.PUBLIC===n&&editorProps.isPublishToFill||("SHAREDREAD"===n||"ANYONELINK_SHAREDREAD"===n)&&editorProps.isFillableForm&&editorProps.isPublishToFill||"function"==typeof editor.getView&&editor.getView()===EDITOR_VIEWS.FILLABLEFIELDS_PREVIEW||isRemote,isPreviewFill="function"==typeof editor.getView&&editor.getView()===EDITOR_VIEWS.FILLABLEFIELDS_PREVIEW,isPublic||isPreviewFill||(!r||!t)&&r};var TableActions=function(){var t=function(){var t=DocLayoutManager.getCurrentView(VIEW.ROW);if(t){var e=t.getFirstChild();if(e){var n=e.getNode().getIndex(),r=editor.doc.createRange(n+1,n+1);sel.removeAllRanges().setSelectionType(SEL_MOUSE).addRange(r),DomUtil.scrollElementIntoView(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0])}}},e=function(){var t=DocLayoutManager.getCurrentView(VIEW.ROW);if(t){var e=t.getLastChild();if(e){var n=e.getNode().getIndex(),r=editor.doc.createRange(n+1,n+1);sel.removeAllRanges().setSelectionType(SEL_MOUSE).addRange(r),DomUtil.scrollElementIntoView(editor.doc.getDomCursorNode(editor.uuid,editor.zuid,"start")[0])}}};return{moveToTableRowFirstCell:t,moveToTableRowLastCell:e}}(),ZWWebFont;!function(){"use strict";var t=function(t){this.family=t.family,this.type=t.type,this.variants=t.variants||{}},e=[3,2,1,5,6,7,8,9];t.prototype.getDefaultFontWeight=function(){var t=this.variants;for(var n in t)if(!/i$/.test(n)){if(t[400])return 400;for(var r=0;r<9;)if(t.hasOwnProperty(e[100*r++]))return 100*i}};var n=/(oxygen|Molengo|Pontano Sans|Cutive|Amiri|Lohit|DejaVu Sans|Noto Sans)/i;t.prototype.getFontFaceCSS=function(t,e,r){if(!this.variants.hasOwnProperty(t))return"";var i=this.getLocalFontNames(t);e&&n.test(this.getFontName(t))&&(e=!1);for(var o=this.getFontUrls(t,e),s="",a=!1,l=0,d=e?0:i.length;l<d;l++)s+=(a?",":"")+"local('"+i[l]+"')",a=!0;for(var c in o)s+=(a?",":"")+"url('"+o[c]+"') format('"+c+"')",a=!0;return r?{"font-family":this.family+(e?"preview":""),"font-weight":parseInt(t),"font-style":/^[1-9]00i/.test(t)?"italic":"normal",src:s}:"@font-face{font-family:'"+this.family+(e?"preview":"")+"';font-weight:"+parseInt(t)+";font-style:"+(/^[1-9]00i/.test(t)?"italic":"normal")+";src:"+s+";}"},t.prototype.getFontName=function(t){return(this.family||"")+(t&&FONT_WEIGHT[t]||"")},t.prototype.getFontPreviewUrls=function(t){return this.getFontUrls(t,!0)},t.prototype.getFontUrls=function(t,e){return this.variants[t]&&this.variants[t][e?"previewUrls":"urls"]||""},t.prototype.getFontVariants=function(t){var e=[];if(t)for(var n=0,r=this.getDefaultFontWeight(),i=[r+"",r+"i","700","700i"],o=i.length;n<o;n++)this.variants.hasOwnProperty(r=i[n])&&e.push(r);else e=Object.keys(this.variants);return e},t.prototype.getFontWeightNames=function(){var t={100:"thin",200:"extralight",300:"light",400:"normal",500:"medium",600:"semibold",700:"bold",800:"extrabold",900:"black"};return function(){var e=[];for(var n in this.variants)t.hasOwnProperty(n)&&e.push(t[n]);return e}}(),t.prototype.getLocalFontNames=function(t){return t&&this.variants[t]?this.variants[t].localNames||[]:[]},ZWWebFont=t}(),DocUtil.insertTOCBookmark=function(t){var e="_Toc"+Utils.randomString(),n="toc_"+Utils.randomString(),r={},i={};r[ATTR_COMMON.TYPE]=NODE_TYPE.BOOKMARK,r[ATTR_COMMON.ID]=n,r[ATTR_COMMON.NAME]=e,i[ATTR_COMMON.TYPE]=NODE_TYPE.BOOKMARK,i[ATTR_COMMON.ID]=n;var o=Utils.randomString(),s=Utils.randomString();return Op.processMsg([{r:t.getStart()},{as:{start:r,id:o}},{is:UNICODE.RANGE_START},{as:{end:ZWJSONUtils.getKeys(r),id:o}},{r:t.getEnd()-t.getStart()-1},{as:{start:i,id:s}},{is:UNICODE.RANGE_END},{as:{end:ZWJSONUtils.getKeys(i),id:s}}]),n},DocUtil.applyHeadingForSelection=function(t,e){if(e=e||editor.doc.getSelection().getNodesInSelection(NODE_TYPE.PARAGRAPH)||[],0!=e.length){var n,r={},i={};"undefined"!=typeof editor.doc.getHeadingListId()&&(n=editor.doc.getSelection().getAllHeadings());for(var o=e.length,s=0;s<o;s++){var a=e[s],l=(parseInt(a.attr(ATTR_PARAGRAPH.PS_HD)),editor.doc.getSelection().getNodesInSelection(NODE_TYPE.TEXT,a.getStart(),a.getEnd()-1));i[ATTR_TEXT.TS_NULL]=!0;for(var d=0;d<l.length;d++){var c=l[d];c.attr(i)}var p=a.firstChild(),E=p&&p.type==NODE_TYPE.BOOKMARK&&0==p.id.indexOf("toc_");if("0"==t?E&&p.remove():Macros.shouldAllowTOCForHeading(t)&&!E&&DocUtil.insertTOCBookmark(a),"undefined"!=typeof editor.doc.getHeadingListId()){var u=DocumentDesign.getParaStyle("h"+t)[ATTR_PARAGRAPH.LS_DATA];if(u){ListUtils.fillListProps(r,u)}}r[ATTR_PARAGRAPH.PS_NULL]=!0,r[ATTR_PARAGRAPH.PS_HD]=t,a.attr(r)}}},DocUtil.getTocId=function(t){var e=t.children;return _res=U.find(e,function(t){if(t.type==NODE_TYPE.FIELD_START||t.type==NODE_TYPE.FIELD_END){var e=t.format;return e&&e.type==NODE_TYPE.BOOKMARK&&e.id.indexOf("toc_")!=-1}return!1}),_res&&_res.format.id},DocUtil.copyStyle=function(t){return DocUtil.copyJSON(t)||{}},DocUtil.copyJSON=function(t){var e;if(null==t||"object"!=typeof t)return t;if(Array.isArray(t)){e=[];for(var n=0,r=t.length;n<r;n++)e[n]=DocUtil.copyJSON(t[n]);return e}if(ZWJSONUtils.isPlainObject(t)){e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=DocUtil.copyJSON(t[i]));return e}return t instanceof DocOpBuilder?e=DocOpBuilder.clone(t):e},DocUtil.copyArray=function(t){return ZWJSONUtils.clone(t)||[]},DocUtil.getStyleIndex=function(t,e,n,r){if("prev"==n){var i=editor.doc.getSectionStart(t);r&&(i=editor.doc.findPreviousIndexOf(CONT_REGEXP.BLOCKSTART,t+1));for(var o=t;o>i;o--){var s=editor.doc.getRawFormatAt(o);if(s&&s.type==e)return o}return editor.doc.getSectionStart(t)+1}if("next"==n){var i=editor.doc.getSectionEnd(t);r&&(i=editor.doc.findNextIndexOf(CONT_REGEXP.BLOCKSTART,t+1));for(var o=t+1;o<i;o++){var s=editor.doc.getRawFormatAt(o);if(s&&s.type==e)return o}return editor.doc.getSectionEnd(t)-1}},DocUtil.getTextStyleEnd=function(t){var e=editor.doc.findNextIndexOf(CONT_REGEXP.PORTION_END,t+1);e<0&&(e=editor.doc.getSectionEnd(t));for(var n=t+1;n<e;n++){var r=editor.doc.getRawFormatAt(n);if(r)return n}return e},DocUtil.getTextStyleStart=function(t){var e=editor.doc.getRawFormatAt(t);if(e)return t;var n=editor.doc.findPreviousIndexOf(CONT_REGEXP.PORTION_END,t-1);n<0&&(n=editor.doc.getSectionStart(t)+1);for(var r=t-1;r>n;r--)if(e=editor.doc.getRawFormatAt(r))return r;return n},DocUtil.isEmpty=function(t){return t.getEnd()-t.getStart()<=1},DocUtil.getDocElement=function(t){if(!t)return null;var e=DomViewManager.indexOfElement(t),n=editor.doc.getElementAt(e);return n},DocUtil.deleteTimeStampInTCStyle=function(t){for(var e=0,n=t.length;e<n;e++){var r=t[e];delete r[TCConstants.TIME]}},DocUtil.mergeAdjacentStyles=function(t){for(var e,n,r=0,i=100,o=editor.doc.findPreviousIndexOf(CONT_REGEXP.PORTION_END,t),s=t;s>0;s--){var a=editor.doc.getRawFormatAt(s);a?a.type:"";if(r++,r==i||s==o)break;if(a&&a.type==NODE_TYPE.TEXT){if(e){if(e[TCConstants.TC]&&a[TCConstants.TC]&&(e=DocUtil.copyStyle(e),a=DocUtil.copyStyle(a),DocUtil.deleteTimeStampInTCStyle(e[TCConstants.TC]),DocUtil.deleteTimeStampInTCStyle(a[TCConstants.TC])),!ZWJSONUtils.compareJSON(e,a))break;editor.doc.setFormatAt(n,null)}e=a,n=s}}r=0;var l=editor.doc.getSectionEnd(t);e=void 0,a=void 0,o=editor.doc.findNextIndexOf(CONT_REGEXP.PORTION_END,t);for(var s=t;s<l;s++){var a=editor.doc.getRawFormatAt(s);r++;a?a.type:"";if(r==i||s==o)break;if(a&&a.type==NODE_TYPE.TEXT)if(e){if(e[TCConstants.TC]&&a[TCConstants.TC]&&(e=DocUtil.copyStyle(e),a=DocUtil.copyStyle(a),DocUtil.deleteTimeStampInTCStyle(e[TCConstants.TC]),DocUtil.deleteTimeStampInTCStyle(a[TCConstants.TC])),!ZWJSONUtils.compareJSON(e,a))break;editor.doc.setFormatAt(s,null)}else e=a}},DocUtil.getDOMSourceIndex=function(t,e){var n=editor.doc.findPreviousIndexOf(UNICODE.SECTION_START,t),r=editor.doc.getContent(n+1,t+1),i=r.match(RegExp(e,"g"));return i?i.length-1:-1},DocUtil.mergeStyles=function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]?"type"!=n&&t&&t[n]==e[n]&&delete t[n]:t[n]=e[n])},DocUtil.getComputedTextFormat=function(t){var e=editor.doc.getParents(NODE_TYPE.PARAGRAPH,t),n=e.getEnd(),r=DocUtil.getParaFormat(n-1),i=DocUtil.getTextStyle(t);i=DocUtil.getRenderingFormat(i);var o=DocUtil.mergeObjs([r.textFormat,i]);return o=DocUtil.updateWithCharStyle(o);},DocUtil.getFloatElementRange=function(t,e){for(var n=t,r={},i={},o=null,s=null,a=!0,l=e;l<editor.doc.getDocumentLength();){if(l=editor.doc.findNextIndexOf(UNICODE.RANGE_START+"|"+UNICODE.RANGE_END,a?l:l+1),a=!1,l<0)return null;var d=editor.doc.getRawFormatAt(l),c=editor.doc.getCharAt(l);if(c==UNICODE.RANGE_START&&d&&d.type==n&&(r[d.id]=!0),c==UNICODE.RANGE_END&&d&&d.type==n){if(r[d.id])continue;s=l;break}}if(!s)return null;var o=DocUtil.getRangeStart(s);return!o||o<0?null:(i.start=o,i.end=s+1,i)},DocUtil.getImageIdx=function(t){var e,n,r,i=0;if(i=editor.doc.findNextIndexOf(UNICODE.IMAGE,i),t){for(n=ATTR_COMMON.ID,r=t;i>0&&(e=editor.doc.getRawFormatAt(i),!e||e[n]!=r);)i=editor.doc.findNextIndexOf(UNICODE.IMAGE,i+1);return i}},DocUtil.getTextStyle=function(t,e){for(var n,r,i={},o={},s=t;s>=0;s--)if(editor.doc.getCharAt(s)===UNICODE.RANGE_START&&(n=s),r=editor.doc.getRawFormatAt(s)){if(r.type==NODE_TYPE.SECTION)break;if(r.type==NODE_TYPE.PARAGRAPH&&n){var a=editor.doc.findNextIndexOf(UNICODE.PARA,n),l=DocUtil.getStyleIndex(n,NODE_TYPE.TEXT,"next",!0),d=editor.doc.getRawFormatAt(l);r=d.type==NODE_TYPE.TEXT?d:editor.doc.getRawFormatAt(a)}if(r.type==NODE_TYPE.PARAGRAPH){var c=editor.doc.getRawFormatAt(t);if(c&&"link"===c.type){var p=editor.doc.getParents(NODE_TYPE.LINK,t);if(o[ATTR_COMMON.TYPE]="text",p){var E=p.attr("*");o[ATTR_COMMON.CLS]="link",o[ATTR_LINK.LINK_URL]=E[ATTR_LINK.LINK_URL],o[ATTR_LINK.LINK_TARGET]=E[ATTR_LINK.LINK_TARGET],o[ATTR_LINK.LINK_TYPE]=E[ATTR_LINK.LINK_TYPE]}}if(r[ATTR_PARAGRAPH.PS_TS]){i=DocUtil.copyStyle(r[ATTR_PARAGRAPH.PS_TS]),i.type=NODE_TYPE.TEXT;break}i={type:NODE_TYPE.TEXT};break}if(r.type==NODE_TYPE.TEXT&&r.st!=NODE_TYPE.TAB){i=DocUtil.copyStyle(r);var u=i.cls;if(u&&u.indexOf("link")>-1){var T=DocUtil.getFloatElementRange(NODE_TYPE.LINK,t);(!T||t>T.end)&&delete i.cls}else u&&(u.indexOf("auto")>-1||u.indexOf(CONST.MERGEFIELD)!=-1||u.indexOf(NODE_TYPE.FILLABLEFIELD)!=-1||u.indexOf(NODE_TYPE.SIGNERFIELD)!=-1||r.cls.indexOf(NODE_TYPE.ENDNOTE)!=-1||r.cls.indexOf(NODE_TYPE.FOOTNOTE)!=-1||u.indexOf(CONST.NEXTRECORD)!=-1||u.indexOf("placeholder")!=-1||u.indexOf(AUTOFIELD_TYPE.DOC_SEQUENCE_NUMBER)!=-1)&&!e&&(delete i.cls,delete i[ATTR_COMMON.ID]);delete i[ATTR_TEXT.MM_FIELDNAME],delete i[ATTR_TEXT.TS_SP],delete i[ATTR_TEXT.TS_GR],delete i[ATTR_TEXT.TS_PROOFING_WQ],delete i[ATTR_COMMON.FIELDINFO],delete i[MAILMERGE.MMINFO],delete i[ATTR_CUSTOM.DISPLAY_TYPE];break}}return U.isEmpty(o)||(i=DocUtil.mergeObjs([i,o])),i},DocUtil.getRangeStart=function(t){var e=editor.doc.getRawFormatAt(t);if(!e)return t;for(var n=editor.doc.getSectionStart(t),r=e.id;editor.doc.getCharAt(t)!==UNICODE.RANGE_START||!e||e.id!=r;){if(t=editor.doc.findPreviousIndexOf(UNICODE.RANGE_START,t),t<0||t<=n){t=n+1;break}e=editor.doc.getRawFormatAt(t)}return t},DocUtil.getSectionEnd=function(t,e){e||(e=editor.doc.getContent());var n=e.indexOf(UNICODE.SECTION_START,t+1);return n=n<0?e.length:n},DocUtil.getRangeEndFromContent=function(t,e,n){if(!n[t])return t;var r=n[t].id,i=DocUtil.getEnd(t+1,UNICODE.RANGE_END,e);return n[i]&&n[i].id===r?i+1:t},DocUtil.getRangeEnd=function(t){var e=editor.doc.getRawFormatAt(t);if(!e)return t;for(var n=editor.doc.getSectionEnd(t),r=e.id;editor.doc.getCharAt(t)!==UNICODE.RANGE_END||!e||e.id!=r;){if(t=editor.doc.findNextIndexOf(UNICODE.RANGE_END,t+1),t<0||t>=n){t=n;break}e=editor.doc.getRawFormatAt(t)}return t},DocUtil.getRangeEndAcrossSection=function(t){var e=editor.doc.getRawFormatAt(t);if(!e)return t;for(var n=editor.doc.getSectionEnd(t),r=e.id;editor.doc.getCharAt(t)!==UNICODE.RANGE_END||!e||e.id!=r;){if(t=editor.doc.findNextIndexOf(UNICODE.RANGE_END,t+1),t<0){t=n;break}e=editor.doc.getRawFormatAt(t)}return t},DocUtil.getVersionNumberDiff=function(t,e){return(t.version-e.version-1)*MAX_REVISION+(MAX_REVISION-e.revision+t.revision)},DocUtil.getVersionFromMsg=function(t){var e=t.VERSION,n=t.REVISION;return{version:e,revision:n}},DocUtil.getCurrentDocVersion=function(){return{version:editor.doc.docInfo.VERSION,revision:editor.doc.docInfo.REVISION}},DocUtil.getStart=function(t,e,n){if(0===t){var r=new Error(ZWCollaboration.TABLE_API_IDX_ERR);throw editor.lastError=r,r}var i;n?i=0:(n=editor.doc.getDocumentContent(),i=editor.doc.getSectionStart(t));var o,s=0;for(o=Utils.findPreviousIndexOf(UNICODE.TABLEEND+"|"+e,t,n.substring(0,t));o>0&&o>i;){var a=n.charAt(o);if(a!=UNICODE.TABLEEND)return o;var l=DocUtil.getStart(o,UNICODE.TABLE,n);l<0?s++:o=l,o=Utils.findPreviousIndexOf(UNICODE.TABLEEND+"|"+e,o,n.substring(0,o))}return-1},DocUtil.getEnd=function(t,e,n){if(0===t){var r=new Error(ZWCollaboration.TABLE_API_IDX_ERR);throw editor.lastError=r,r}var i;n?i=n.length:(n=editor.doc.getDocumentContent(),i=editor.doc.getSectionEnd(t));var o,s=0,a=0!=e.length?"|"+e:"",l=Utils.findNextIndexOf(UNICODE.TABLE+"|"+UNICODE.TABLEEND+a,t,n);if(l>=0&&t>l){var r=new Error(ZWCollaboration.API_NEGATIVE_IDX);throw editor.lastError=r,r}for(;l>0&&l<i;){var t,d=n.charAt(l);if(d==UNICODE.TABLE)o=DocUtil.getEnd(l+1,"",n),o<0?(l++,s++):l=o+1;else if(d===UNICODE.TABLEEND||e.indexOf(d)>-1)return l;if(t=l,l=Utils.findNextIndexOf(UNICODE.TABLE+"|"+UNICODE.TABLEEND+a,l,n),l>=0&&t>l){var r=new Error(ZWCollaboration.API_NEGATIVE_IDX);throw editor.lastError=r,r}}return-1},DocUtil.getTableStart=function(t){return DocUtil.getStart(t,UNICODE.TABLE)},DocUtil.getRowStart=function(t){return DocUtil.getStart(t,UNICODE.ROW)},DocUtil.getCellStart=function(t){return DocUtil.getStart(t,UNICODE.CELL)},DocUtil.getTableEnd=function(t,e){var t=DocUtil.getEnd(t,[],e);if(t>0)return t+1},DocUtil.getRowEnd=function(t,e){return DocUtil.getEnd(t,[UNICODE.ROW],e)},DocUtil.getCellEnd=function(t,e){return DocUtil.getEnd(t,UNICODE.ROW+"|"+UNICODE.CELL,e)},DocUtil.getParaStyle=function(t){var e={},n=editor.doc.getParents(NODE_TYPE.PARAGRAPH,t);e=n.attr("*");var r=n.getEnd()-1,i=e[ATTR_PARAGRAPH.PS_HD];if(i&&parseInt(i)>0&&t==r){var o=DocumentDesign.getParaStyle("h"+e[ATTR_PARAGRAPH.PS_HD]);for(var s in o)"textFormat"!=s&&delete e[s];delete e[ATTR_PARAGRAPH.PS_HD],delete e[ATTR_PARAGRAPH.PS_TS],ListUtils.removeListProps(e)}else{var a=DocUtil.getTextStyle(t-1);a&&(delete a.type,e[ATTR_PARAGRAPH.PS_TS]=a)}return e},DocUtil.getStylesWithoutHeadingList=function(){for(var t=DocumentDesign.getStyles().para,e=1;e<=6;){var n=t["h"+e];ListUtils.removeListProps(n),delete n[ATTR_PARAGRAPH.PS_ML],e+=1}var r=editor.doc.getSelection().getParents(NODE_TYPE.BODY),i=r.attr(ATTR_BODY.DS_STYLES);return i[ATTR_BODY.DS_PARA]=t,i},DocUtil.getParaFormat=function(t,e){var n=DocUtil.copyStyle(editor.doc.getRawFormatAt(t))||{},r={},i="undefined"!=typeof n[ATTR_PARAGRAPH.PS_HD]&&n[ATTR_PARAGRAPH.PS_HD]?"h"+n[ATTR_PARAGRAPH.PS_HD]:"h0";r=DocumentDesign.getComputedParaStyle(i);var o=TableUtil.getParaStylesFromTableTheme(t,e);return o&&(r=DocUtil.mergeObjs([r,o])),r[TCConstants.TC]&&delete r[TCConstants.TC],ListUtils.isList(n)||(r=DocUtil.copyStyle(r),ListUtils.removeListProps(r)),n=DocUtil.mergeObjs([r,n])},DocUtil.createTextElement=function(t,e){var n=editor.doc.getContent(t,e),r=editor.doc.createElement(NODE_TYPE.TEXT,n);return r.setStart(t),r.setEnd(e),r},DocUtil.getComputedParaStyles=function(t,e){var n=editor.doc.getParents(NODE_TYPE.CELL,t);if(n)for(var r in e)e[r][ATTR_PARAGRAPH.PS_LS]="1.0",e[r][ATTR_PARAGRAPH.PS_SA]="0pt",e[r][ATTR_PARAGRAPH.PS_SB]="0pt";return e},DocUtil.getCellPadding=function(t){var e={};return t.hasOwnProperty(ATTR_CELL.TDS_PL)||t.hasOwnProperty(ATTR_CELL.TDS_PR)||t.hasOwnProperty(ATTR_CELL.TDS_PT)||t.hasOwnProperty(ATTR_CELL.TDS_PB)?(e.left=parseFloat((t[ATTR_CELL.TDS_PL]||"0px").convertUnitTo("px").toFixed(2)),e.right=parseFloat((t[ATTR_CELL.TDS_PR]||"0px").convertUnitTo("px").toFixed(2)),e.top=parseFloat((t[ATTR_CELL.TDS_PT]||"0px").convertUnitTo("px").toFixed(2)),e.bottom=parseFloat((t[ATTR_CELL.TDS_PB]||"0px").convertUnitTo("px").toFixed(2)),e):e={top:0,right:6,bottom:0,left:6}},DocUtil.formatGenerator=function(){var t={Bold:{name:ATTR_TEXT.TS_FW,value:"bold",off:"none"},Italic:{name:ATTR_TEXT.TS_FS,value:"italic",off:"none"},Superscript:{name:ATTR_TEXT.TS_VA,value:"super",off:"none"},Subscript:{name:ATTR_TEXT.TS_VA,value:"sub",off:"none"},Underline:{name:ATTR_TEXT.TS_TD,value:"underline",off:"none",altvalue:"underline line-through",altoff:"line-through"},Strikethrough:{name:ATTR_TEXT.TS_TD,value:"line-through",off:"none",altvalue:"underline line-through",altoff:"underline"},FontName:{name:ATTR_TEXT.TS_FF},SmallCaps:{name:ATTR_TEXT.TS_FV,value:"small-caps",off:"small-caps"},FontSize:{name:ATTR_TEXT.TS_SIZE},BackColor:{name:ATTR_TEXT.TS_BGC},ForeColor:{name:ATTR_TEXT.TS_FGC},CharSpacing:{name:ATTR_TEXT.TS_CS},CharStyles:{name:ATTR_TEXT.CHAR_STY}},e=["CreateLink","Unlink","FormatBlock","outdent","indent","hlist","removeHeadingList","orderedlist","unorderedlist","inshr","insquote","autofield","instable","applyBorders","applyLineSpacing","applyStyle","applyTab","insertTab","delete","RemoveFormat","delrow","delcolumn","insrowafter","insrowbefore","inscolafter","inscolbefore","splitcells","deltable","instable","setTableTheme","insimg","endnote"],n={JustifyLeft:{name:ATTR_PARAGRAPH.PS_AL,value:0},JustifyCenter:{name:ATTR_PARAGRAPH.PS_AL,value:1},JustifyRight:{name:ATTR_PARAGRAPH.PS_AL,value:2},JustifyFull:{name:ATTR_PARAGRAPH.PS_AL,value:3},ParaBackColor:{name:ATTR_PARAGRAPH.PS_BGC},AddSpaceToParaafter:{name:ATTR_PARAGRAPH.PS_SA,value:"12pt"},RemoveSpaceFromParaafter:{name:ATTR_PARAGRAPH.PS_SA,value:"0pt"},AddSpaceToParabefore:{name:ATTR_PARAGRAPH.PS_SB,value:"12pt"},RemoveSpaceFromParabefore:{name:ATTR_PARAGRAPH.PS_SB,value:"0pt"},direction:{name:ATTR_PARAGRAPH.PS_DIR},SetLineSpacing:{name:ATTR_PARAGRAPH.PS_LS}};return{isTextCommand:function(e){return t.hasOwnProperty(e)},isNodeStyleCommand:function(t){return e.contains(t)},isParaCommand:function(t){return n.hasOwnProperty(t)||n.hasOwnProperty(t+"after")||n.hasOwnProperty(t+"before")},getParaFormat:function(t,e){var r={},i=editor.doc.getSelection(),o=i.getParents(NODE_TYPE.PARAGRAPH),s=o&&o.getEnd(),a=DocUtil.getParaFormat(s-1),l=a.dir||"ltr",d=n[t];return l==PARA_DIR.RTL?"JustifyRight"==t?d.value=0:"JustifyLeft"==t&&(d.value=2):"JustifyRight"==t?d.value=2:"JustifyLeft"==t&&(d.value=0),d||(d=n[t+e]),r[d.name]=d.hasOwnProperty("value")?d.value:e,r},getTextFormat:function(e,n,r){var i,o={type:NODE_TYPE.TEXT},s=t[n];if(r)if("FontName"===n){var a,l=FontUtils.stringToFonts(r[0])[0],d=parseInt(r[1]||0);if(i=FontUtils.getWebFont(l))if(o[s.name]=i.getFontName(),d)switch(o[ATTR_TEXT.TS_FW_I]=d){case 100:case 200:case 300:case 400:case 500:case 600:o[ATTR_TEXT.TS_FW]="none";break;case 700:o[ATTR_TEXT.TS_FW_I]=i.getDefaultFontWeight();case 800:case 900:o[ATTR_TEXT.TS_FW]="bold"}else i.variants.hasOwnProperty(e[ATTR_TEXT.TS_FW_I])||(o[ATTR_TEXT.TS_FW_I]=i.getDefaultFontWeight());else(a=Utils.getCustomFont(l))?(o[s.name]=a.name,(i=FontUtils.getWebFont(a.fallback))&&(o[s.name]+=","+i.getFontName()),o[ATTR_TEXT.TS_FW_I]=""):(o[s.name]=r[0],o[ATTR_TEXT.TS_FW_I]="")}else o[s.name]=r;else if(o[s.name]=s.value,e&&e.type==NODE_TYPE.TEXT)if("Bold"===n){var c=e[ATTR_TEXT.TS_FW_I]||400;c=Math.max(e[ATTR_TEXT.TS_FW]===s.value?700:0,parseInt(c)),c>=700&&(o[s.name]=s.off,parseInt(e[ATTR_TEXT.TS_FW_I]||0)>=700&&(o[ATTR_TEXT.TS_FW_I]=400))}else{var p=e[s.name]?e[s.name].trim():"";s.value&&p===s.value?o[s.name]=s.off:s.altvalue&&p===s.altvalue?o[s.name]=s.altoff:s.altvalue&&p===s.altoff&&editor.doc.getSelection().isCollapsed()&&(o[s.name]=s.value)}return o}}}(),DocUtil.isNonEditablePortion=function(t){if(!t)return!1;var e=!1;return t=t.toLowerCase(),t.indexOf("auto")!=-1?e=!0:t.indexOf(CONST.MERGEFIELD.toLowerCase())!=-1?e=!0:t.indexOf(CONST.NEXTRECORD.toLowerCase())!=-1?e=!0:t.indexOf(NODE_TYPE.FILLABLEFIELD)!=-1?e=!0:t.indexOf(NODE_TYPE.SIGNERFIELD)!=-1?e=!0:t.indexOf("endnote")!=-1?e=!0:t.indexOf("footnote")!=-1?e=!0:t.indexOf("placeholder")!=-1?e=!0:t.indexOf(NODE_TYPE.TAG)!==-1&&(e=!0),e},DocUtil.getSectionOps=function(t,e,n,r){var i={},o=[];i.type="section",i.hftype=t,i.st=n,i.sid=r,styKey=ZWJSONUtils.getKeys(i);var s=Utils.randomString(),a=Utils.randomString();return o=[{r:e},{as:{start:i,id:s}},{is:UNICODE.SECTION_START},{as:{end:styKey,id:s}},{as:{start:{type:"paragraph"},id:a}},{is:UNICODE.PARA},{as:{end:["type"],id:a}}]},DocUtil.getRenderingFormat=function(t,e){var n=e?e:DocumentDesign.getTheme();t=DocUtil.copyStyle(t);for(var r in t){var i=t[r];if("shapeData"!==r&&null!=i)if("object"==typeof i)t[r]=DocUtil.getRenderingFormat(i,n);else if("string"==typeof i){var o=/[z][w](\w|\*|\/)+/,s=/\#(\w|\*|\/)+/,a=o.test(i),l=s.test(i);if(!a&&!l)continue;var d=o.exec(i),c=s.exec(i),p=i,E=a?d[0].substr("zw".length):c[0].substr("#".length);if("major"===E||"minor"===E)p=n.font[E].latin;else{if(!(E.indexOf("accent")>-1||E.indexOf("dark")>-1||E.indexOf("light")>-1||E.indexOf("hlink")>-1||E.indexOf("folHlink")>-1))continue;var u=null,T=null,h=null;E.indexOf("*")>-1?(u=E.split("*")[0],T=parseInt(E.split("*")[1])):E.indexOf("/")>-1?(u=E.split("/")[0],h=parseInt(E.split("/")[1])):u=E,u=n.color[u],p=T||h?T?ZWColorUtils.getColorAfterShade(u,T):ZWColorUtils.getColorAfterTint(u,h):u}p=i.replace(a?o:s,p),t[r]=p}}return t},DocUtil.updateWithCharStyle=function(t){return t.hasOwnProperty(ATTR_TEXT.CHAR_STY)&&(t=DocUtil.mergeObjs([DocumentDesign.getCharStyle(t[ATTR_TEXT.CHAR_STY]),t])),t},DocUtil.getFloatElementIdx=function(t,e){var n,r,i,o=0;for(o=editor.doc.findNextIndexOf(UNICODE.RANGE_START,o),t?(r=ATTR_COMMON.ID,i=t):(r=ATTR_COMMON.NAME,i=e);o>0&&(n=editor.doc.getRawFormatAt(o),!n||n[r]!=i);)o=editor.doc.findNextIndexOf(UNICODE.RANGE_START,o+1);return o},DocUtil.getNextFontSize=function(t){var e,n=editor.doc.getDefaultFontSizeList(),r=n.length;for(e=0;e<r;e++)if(n[e]>t)return n[e];return t+=10-t%10},DocUtil.getPrevFontSize=function(t){var e,n=editor.doc.getDefaultFontSizeList(),r=n.length;if(t>n[r-1])return t-=10-t%10;for(e=r-1;e>=0;e--)if(n[e]<t)return n[e];return t-1},DocUtil.increaseOrDecreaseFontSize=function(t,e){var n=t.length;for(j=0;j<n;j++){for(var r,i,o,s,a=t[j],l=a.end,d=t[j].getNodes(NODE_TYPE.TEXT),c=d.length,p=1==e,E=0;E<c;E++){var u=DocTreeManager.getTreeNodeAtIndex(d[E].getStart()+1);if(s=u&&u.paraProperties.level,i=editor.doc.getComputedFormatAt(d[E].getStart(),NODE_TYPE.TEXT,s),o=parseInt(i[ATTR_TEXT.TS_SIZE]),r=p?DocUtil.getNextFontSize(o):DocUtil.getPrevFontSize(o),p&&r<=400||!p&&r>0){var T={};T[ATTR_TEXT.TS_SIZE]=r,d[E].attr(T)}}var h=t[j].getNodes(NODE_TYPE.PARAGRAPH),O=h.length;for(k=0;k<O;k++){var g=h[k],f=g.dtNode,_=f.getEndIndex();if(l>_)if(t.isListItemSelection)i=t.getComputedTextFormat(),o=parseInt(i[ATTR_TEXT.TS_SIZE]),r=p?DocUtil.getNextFontSize(o):DocUtil.getPrevFontSize(o),i[ATTR_TEXT.TS_SIZE]=r,ListUtils.updateLevelStyles(t.selectedListID,t.selectedListLevel,i);else if(c=h.length,i=editor.doc.getComputedFormatAt(h[k].getStart(),NODE_TYPE.PARAGRAPH),ListUtils.isList(i)&&(o=i[ATTR_PARAGRAPH.PS_TS]&&i[ATTR_PARAGRAPH.PS_TS][ATTR_TEXT.TS_SIZE]?parseInt(i[ATTR_PARAGRAPH.PS_TS][ATTR_TEXT.TS_SIZE]):parseInt(i[ATTR_PARAGRAPH.TEXTFORMAT][ATTR_TEXT.TS_SIZE]),r=p?DocUtil.getNextFontSize(o):DocUtil.getPrevFontSize(o),p&&r<=400||!p&&r>0)){var T={};T[ATTR_PARAGRAPH.PS_TS]={},T[ATTR_PARAGRAPH.PS_TS][ATTR_TEXT.TS_SIZE]=r,h[k].attr(T)}}}},DocUtil.isPlaceHolderRange=function(t){var e=t&&editor.doc.getParents(NODE_TYPE.PLACEHOLDER,t.start+1);return e&&e.type===NODE_TYPE.PLACEHOLDER&&e.getStart()===t.start&&e.getEnd()===t.end},DocUtil.isBoundaryChar=function(){var t=RegExp(CONT_REGEXP.PORTION_END);return function(e){var n=t.test(e);return n}}(),DocUtil.getAllFieldsRanges=function(t,e,n){for(var r,i,o=[];e!=-1&&e<n&&(e=editor.doc.findNextIndexOf(UNICODE.RANGE_START,e),!(e<0||e>n))&&(r=editor.doc.getRawFormatAt(e)||{},i=DocUtil.getRangeEnd(e),!(i<0));){if(r.ftype==t){var s={};s.start=e,s.end=i+1,o.push(s)}e=editor.doc.findNextIndexOf(UNICODE.RANGE_START,e+1)}return o},DocUtil.mergeObjs=function(t){for(var e,n,r,i={},o=t.length,s=0;s<o;s++){e=t[s];for(n in e)if(r=e[n],ZWJSONUtils.isPlainObject(r)&&i[n])i[n]=DocUtil.mergeObjs([i[n],r]);else{var a=r;if((n===ATTR_TEXT.TS_TD||n===ATTR_COMMON.CLS)&&i[n]&&i[n]!==r&&(a=i[n].indexOf(r)!==-1&&i[n].indexOf("none")===-1?r:i[n]+" "+r,n===ATTR_TEXT.TS_TD)){var l="";r.indexOf("none")==-1?(a.indexOf("underline")!=-1&&(l+="underline "),a.indexOf("line-through")!=-1&&(l+="line-through")):l="none",a=l.trim()}i[n]=a}}return i},DocUtil.replaceNodes=function(t,e){var n=t.getStart(),r=e.nodeValue,i=0,o=[],s=!1;t.getStart()===e.getStart()?s=!0:o.push({r:n});var a=editor.doc,l=0,d=!1;if(t.nodeValue.length==e.nodeValue.length&&(d=!0,l=t.nodeValue.length),d){for(var c,p=0;p<l;p++){var E=a.getRawFormatAt(n+p);if(E){if(c){c=DocUtil.copyStyle(c),(c&&"footnote"===c.type||"footnote"===c.cls||"endnote"===c.type||"endnote"===c.cls)&&(c={type:"text"});var u=ZWJSONUtils.getKeys(c);o.push({as:{start:c}}),o.push({is:r.substring(i,p)}),o.push({as:{end:u}})}else o.push({is:r.substring(i,p)});c=E,i=p}}if(i<p&&(E="",c&&(E=c),E&&(E=DocUtil.copyStyle(E),(E&&"footnote"===E.type||"footnote"===E.cls||"endnote"===E.type||"endnote"===E.cls)&&(E={type:"text"}),o.push({as:{start:E}})),o.push({is:r.substring(i,p)}),E)){var T=["type"];o.push({as:{end:T}})}}else{var E=a.getRawFormatAt(n);if(E){"section"==E.type&&(E={type:"text"}),E=DocUtil.copyStyle(E),(E&&"footnote"===E.type||"footnote"===E.cls||"endnote"===E.type||"endnote"===E.cls)&&(E={type:"text"});var u=ZWJSONUtils.getKeys(E);o.push({as:{start:E}}),o.push({is:r}),o.push({as:{end:u}})}else o.push({is:r})}a.getTrackChangeDetails().getProcessingTC()&&Op.sendMsg();var h=a.getContent(t.getStart(),t.getEnd());if(s)if(a.getTrackChangeDetails().getProcessingTC()){var O=[];O.push({r:t.getStart()}),O.push({ds:h}),O=O.concat(o),a.getTrackChangeDetails().setProcessingContentDeletion(!0),Op.processMsg(O),a.getTrackChangeDetails().setProcessingContentDeletion(!1)}else{var g=editor.doc.createRange(t.getStart(),t.getEnd());g.deleteContentsInRange();var O=[];O.push({r:n}),O=O.concat(o),Op.processMsg(O)}else{var g=editor.doc.createRange(t.getStart(),t.getEnd());g.deleteContentsInRange(),a.getTrackChangeDetails().getProcessingTC()&&Op.sendMsg(),Op.processMsg(o)}},DocUtil.getNamedRangeIdx=function(t){var e=NamedRange.getNamedRangeForId(t);return e[0].start},DocUtil.getFieldSeparatorIndex=function(t){var e=editor.doc,n=e.getRawFormatAt(t);if(!n)return-1;var r=DocUtil.getRangeEndAcrossSection(t),i=n.id;do{if(t=e.findNextIndexOf(UNICODE.FIELD_SEPARATOR,t+1),t==-1||t>=r){t=-1;break}n=e.getRawFormatAt(t)}while(!n||n.id!=i);return t},DocUtil.sortFn=function(t,e){return t.start>e.start?1:t.start<e.start?-1:t.end>e.end?1:t.end<e.end?-1:0},DocUtil.deleteHFSection=function(t){var e=DocTreeManager.getSectionWithSid(t);if(e||!HF_SECTIONS.contains(e.getSectionType())){var n=[];return n.push({r:e.getIndex()}),n.push({ds:editor.doc.getContent(e.getIndex(),e.getEndIndex()+1)}),n}},DocUtil.isThisHFIdInOtherContentSections=function(t,e){for(var n,r=DocTreeManager.doc.getAllSectionsByType(SECTION_TYPES.CONTENT),i=0;i<r.length;i++)if(n=r[i],n.format[ATTR_SECTION.BREAK_TYPE]===BREAK_TYPES.NEXT_PAGE&&((n.format[ATTR_SECTION.HEADER_IDS]||[]).contains(t)||(n.format[ATTR_SECTION.FOOTER_IDS]||[]).contains(t))&&n.getId()!==e)return!0;return!1},DocUtil.preRemoveContentSection=function(t){for(var e=[],n=t.format[ATTR_SECTION.HEADER_IDS],r=0;r<n.length;r++)DocUtil.isThisHFIdInOtherContentSections(n[r],t.getId())||(e=e.concat(DocUtil.deleteHFSection(n[r])));for(var i=t.format[ATTR_SECTION.FOOTER_IDS],r=0;r<i.length;r++)DocUtil.isThisHFIdInOtherContentSections(i[r],t.getId())||(e=e.concat(DocUtil.deleteHFSection(i[r])));return e},DocUtil.getOldAndNewHFIds=function(t,e){for(var n=ZWJSONUtils.clone(t),r=ZWJSONUtils.clone(t),i=0;i<t.length;i++){var o=DocTreeManager.doc.getSectionWithSid(t[i]);if(o&&o.getHFType()===e.hftype){n.splice(i,1,e.sid);break}}var s=r.indexOf(e.sid);return s!==-1&&r.splice(s,1),{oldHFIds:r,newHFIds:n}},DocUtil.deleteContentSection=function(t){var e=DocTreeManager.getSectionWithSid(t);if(e||e.getSectionType()===SECTION_TYPES.CONTENT){var n=[],r=e.prev,i=e.next;if(r)n.push({r:e.getIndex()}),n.push({ds:editor.doc.getContent(e.getIndex(),e.getEndIndex()+1)});else{if(!i)return;var o=ZWJSONUtils.clone(i.format);o[ATTR_SECTION.BREAK_TYPE]=BREAK_TYPES.NEXT_PAGE;for(var s=e.format[ATTR_SECTION.HEADER_IDS]||[],a=o[ATTR_SECTION.HEADER_IDS]||[],l=0;l<a.length;l++){var d=DocTreeManager.doc.getSectionWithSid(a[l]);s=DocUtil.getOldAndNewHFIds(s,d.format).newHFIds}for(var c=e.format[ATTR_SECTION.FOOTER_IDS]||[],p=o[ATTR_SECTION.FOOTER_IDS]||[],l=0;l<p.length;l++){var E=DocTreeManager.doc.getSectionWithSid(p[l]);c=DocUtil.getOldAndNewHFIds(c,E.format).newHFIds}o[ATTR_SECTION.HEADER_IDS]=s,o[ATTR_SECTION.FOOTER_IDS]=c;var u=new Element,T=u.getStyleOp(o);n.push({r:e.getIndex()}),n.push(T.as_start),n.push({r:1}),n.push(T.as_end);var h=[];h.push({r:e.getIndex()+1}),h.push({ds:editor.doc.getContent(e.getIndex()+1,e.getEndIndex()+2)});for(var O=[],a=e.format[ATTR_SECTION.HEADER_IDS]||[],l=0;l<a.length;l++)s.contains(a[l])||(O=DocUtil.deleteHFSection(a[l]));for(var g=[],p=e.format[ATTR_SECTION.FOOTER_IDS]||[],l=0;l<p.length;l++)c.contains(p[l])||(g=DocUtil.deleteHFSection(p[l]));var f;if(O.length&&g.length){var _=DocOpBuilder.xform(DocOpBuilder.build(O),DocOpBuilder.build(g));f=DocOpBuilder.concise(DocOpBuilder.compose(_.first,_.second))}if(f){var R=DocOpBuilder.xform(DocOpBuilder.build(h),f);h=DocOpBuilder.concise(DocOpBuilder.compose(R.first,R.second))}n=DocOpBuilder.concise(DocOpBuilder.compose(DocOpBuilder.build(n),h))}return Op.processMsg(n.toJson()),o}},DocUtil.getWatermarkOps=function(t,e){for(var n=DocTreeManager.getSectionsByType(SECTION_TYPE.HEADER),r=n.first,i=[];r;){var o=ZWJSONUtils.clone(t);if(Watermark.checkAndRemoveImageWaterMark(r,i),Watermark.checkAndRemoveShapeWaterMark(r,i),"TEXT"==e){var s={positionH:{from:"margin",type:"align",alignVal:"center"},positionV:{from:"margin",type:"align",alignVal:"center"},subType:"textbox",wrapType:"behind",pl:"0in",pr:"0in",pt:"0in",pb:"0in"},a={};a.textData=o.text||{},a.imageData=o.image||s;var l=a.textData,d=a.imageData,c=l.content||"DRAFT";l.size=l.size||72,l.fgc=l.fgc||"rgb(191,191,191)",l.ff=l.ff||"Arimo",l.fw_i=l.fw_i||400;var p=InsertShape.calculateDimensionOnFonts(c,l.ff,l.size,l.fw_i);d.wid=p.width+20,d.ht=p.height+50,d[ATTR_COMMON.TYPE]="image",d[ATTR_COMMON.SUBTYPE]="textbox",d[ATTR_IMAGE.I_HT_UN]="px",d[ATTR_IMAGE.I_WID_UN]="px",d.rotation=d.rotation||320;var E={type:"paragraph"},u=r.getIndex()+1;a.paraStyle=E,a.start=u,DocUtil.insertTextbox(a,i)}else{var T=editor.doc.createRange(r.getIndex()+1);editor.doc.getSelection().removeAllRanges().addRange(T),Command.exec("insimg",[o])}r=r.next}return i},DocUtil.insertTextbox=function(t,e){var n=t.start,r=t.imageData,i=t.textData,o=t.paraStyle,s=Utils.randomString(),a=Utils.randomString(),l=Utils.randomString(),d=Utils.randomString();r.id=d;var c=[{r:n},{as:{start:r,id:s}},{is:""},{as:{end:ZWJSONUtils.getKeys(r),id:s}}];e?e.push(c):Op.processMsg(c);var p=[];if(p.push({r:editor.doc.getDocumentLength()},{as:{start:{st:"textbox",sid:d,type:"section"},id:a}},{is:""},{as:{end:["st","sid","type"],id:a}}),i){var E=i.content;delete i.content;var u=OpUtil.getInsertionOpsForText(E,i);Array.prototype.push.apply(p,u)}else{var T=Utils.randomString();p.push({as:{start:{type:"cursor",uuid:editor.uuid},id:T}},{r:0},{as:{end:["type","uuid"],id:T}})}p.push({as:{start:o,id:l}},{is:"\n"},{as:{end:ZWJSONUtils.getKeys(o),id:l}}),e?e.push(p):Op.processMsg(p)},DocOp.prototype.newCharacters=function(t){this.characters=t,this._len=t.length},DocOp.prototype.skipChars=function(t){this.retain_count=t,this._len=t},DocOp.prototype.changeStyles=function(t,e,n){this.styles={},this.styles.begin=DocUtil.copyStyle(e),this.styles.end=t,this.styles.id=n},DocOp.prototype.lock=function(t,e){this.lock_data=DocUtil.copyStyle(t),null!=e&&(this.lock_data.range=e),this._len=this.length()},DocOp.prototype.deleteCharacters=function(t){this.delete_characters=t,this._len=t.length},DocOp.prototype.cut=function(t){var e=new DocOp;if(this.isLock())this.lock_data.range-=t,e.lock(this.lock_data,t);else if(this.isInsert()){var n=this.characters.substring(0,t);this.characters=this.characters.substring(t),e.newCharacters(n)}else if(this.isDelete()){var n=this.delete_characters.substring(0,t);this.delete_characters=this.delete_characters.substring(t),e.deleteCharacters(n)}else this.isRetain()&&(this.retain_count-=t,e.skipChars(t));return e},DocOp.prototype.length=function(t){return null==t?null!=this.characters?this.characters.length:null!=this.delete_characters?this.delete_characters.length:null!=this.retain_count?this.retain_count:null!=this.lock_data?this.lock_data.range:this.styles&&(this.styles.begin||this.styles.end)?1:0:void(this.isInsert()?this.characters=this.characters.substring(0,t):this.isDelete()?this.delete_characters=this.delete_characters.substring(0,t):this.isRetain()?this.retain_count=t:this.isLock()&&(this.lock_data.range=t))},DocOp.prototype.splitAt=function(t){var e=this._len,n=DocOp.clone(this);return this.isInsert()?(n.characters=n.characters.substring(t),this.characters=this.characters.substring(0,t)):this.isDelete()?(n.delete_characters=n.delete_characters.substring(t),this.delete_characters=this.delete_characters.substring(0,t)):this.isRetain()?(n.retain_count-=t,this.retain_count=t):this.isLock()&&(n.lock_data.range-=t,this.lock_data.range=t),n._len=e,n},DocOp.clone=function(t){var e=new DocOp;return t.isTC()?t.clone():t.isRemoveTC()?t.clone():t.isTCStyleOp()?t.clone():t.isHiddenRangeOp()?t.clone():t.isHiddenComposeOp()?t.clone():t.isHiddenRemoveOp()?t.clone():t.isHiddenRangeCharOp()?t.clone():(t.isInsert()?(e.newCharacters(t.characters),t.insertStyles&&(e.insertStyles=t.insertStyles),t.hasIntegralStyles()&&(e.integralStyles=t.integralStyles)):t.isDelete()?(e.deleteCharacters(t.delete_characters),t.hasIntegralStyles()&&(e.integralStyles=t.integralStyles)):t.isRetain()?e.skipChars(t.retain_count):t.isAnnotation()?e.changeStyles(t.styles.end,t.styles.begin,t.styles.id):t.isLock()&&e.lock(t.lock_data),e.isPriorityOp=t.isPriorityOp,e)},DocOp.prototype.isInsert=function(){return null!=this.characters},DocOp.prototype.hasIntegralStyles=function(){return this.integralStyles.length>0},DocOp.prototype.isPriorityDelete=function(){return null!=this.delete_characters&&this.isPriorityOp},DocOp.prototype.isDelete=function(){return null!=this.delete_characters},DocOp.prototype.isRetain=function(){return null!=this.retain_count},DocOp.prototype.isTC=function(){return this.type==DOCOP_TYPE_TC},DocOp.prototype.isRemoveTC=function(){return this.type==DOCOP_TYPE_REMOVE_TC},DocOp.prototype.isTCStyleOp=function(){return this.type==DOCOP_TYPE_TC_STYLE_OP},DocOp.prototype.isLock=function(){return null!=this.lock_data},DocOp.prototype.isRedact=function(){return null!=this.lock_data&&1==this.lock_data.data.redact},DocOp.prototype.isUnLock=function(){return null!=this.lock_data&&this.lock_data.data&&"unlock"==this.lock_data.data.state},DocOp.prototype.isHiddenRangeOp=function(){return this.type==DOCOP_TYPE_HIDDEN_RANGE_OP},DocOp.prototype.isHiddenComposeOp=function(){return this.type==DOCOP_TYPE_HIDDEN_COMPOSE_OP},DocOp.prototype.isHiddenRemoveOp=function(){return this.type==DOCOP_TYPE_HIDDEN_REMOVE_OP},DocOp.prototype.isHiddenRangeCharOp=function(){return this.type==DOCOP_TYPE_HIDDEN_RANGECHAR_OP},DocOp.prototype.toString=function(){var t=this,e=[];return null!=t.retain_count?e.push("{'r':"+t.retain_count+"}"):t.isLock()?e.push("{'lk':'"+JSON.stringify(this.lock_data)+"'}"):null!=t.characters?e.push("{'is':'"+Utils.escapeSplChars(t.characters)+"'}"):t.delete_characters?e.push("{'ds':'"+Utils.escapeSplChars(t.delete_characters)+"'}"):t.styles&&(t.styles.end.length>0?e.push("{'as':{'end':"+JSON.stringify(t.styles.end)+",'id':"+JSON.stringify(t.styles.id)+"}}"):e.push("{'as':{'start':"+JSON.stringify(t.styles.begin)+",'id':"+JSON.stringify(t.styles.id)+"}}")),e.join()},DocOp.prototype.isAnnotation=function(){return this.styles&&(this.styles.begin||this.styles.end)},DocOp.prototype.isAnnotationStart=function(){return this.isAnnotation()&&0==this.styles.end.length},DocOp.prototype.isAnnotationEnd=function(){return this.isAnnotation()&&this.styles.end.length>0};var DOCOP_TYPE_RETAIN=1,DOCOP_TYPE_INSERT=2,DOCOP_TYPE_DELETE=3,DOCOP_TYPE_STYLESTART=4,DOCOP_TYPE_STYLEEND=5,DOCOP_TYPE_LOCK=6,DOCOP_TYPE_TC=7,DOCOP_TYPE_REMOVE_TC=8,DOCOP_TYPE_TC_STYLE_OP=9,DOCOP_TYPE_HIDDEN_RANGE_OP=10,DOCOP_TYPE_HIDDEN_COMPOSE_OP=11,DOCOP_TYPE_HIDDEN_REMOVE_OP=12,DOCOP_TYPE_HIDDEN_RANGECHAR_OP=13;InsertOp.prototype=new DocOp,RetainOp.prototype=new DocOp,DeleteOp.prototype=new DocOp,StartStyleOp.prototype=new DocOp,EndStyleOp.prototype=new DocOp,HiddenRangeOp.prototype=new DocOp,HiddenRangeOp.prototype.type=DOCOP_TYPE_HIDDEN_RANGE_OP,HiddenRangeOp.prototype.cloneRangeTypes=function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[n];return e},HiddenRangeOp.prototype.setOriginalRange=function(t){this.originalRange=t},HiddenRangeOp.prototype.length=function(){return this.range},HiddenRangeOp.prototype.setChars=function(t){this.chars=t},HiddenRangeOp.prototype.getChars=function(){return this.chars},HiddenRangeOp.prototype.setId=function(t){this.id=t},HiddenRangeOp.prototype.getId=function(){return this.id},HiddenRangeOp.prototype.getStyle=function(){return this.style},HiddenRangeOp.prototype.setStyle=function(t){this.style=t},HiddenRangeOp.prototype.getOriginAction=function(){return this.originAction},HiddenRangeOp.prototype.setOriginAction=function(t){this.originAction=t},HiddenRangeOp.prototype.mergeRangeTypes=function(t){var e,n,r;for(e=0,n=t.length;e<n;e++)r=t[e],this.rangeTypes.indexOf(r)<0&&this.rangeTypes.push(r)},HiddenRangeOp.prototype.removeRangeType=function(t){var e=this.rangeTypes.indexOf(t);e>=0&&this.rangeTypes.splice(e,1)},HiddenRangeOp.prototype.containsConditionRangeType=function(){var t,e,n,r=this.rangeTypes;for(t=0,e=r.length;t<e;t++)if(n=r[t],n.indexOf("condition")>=0)return!0;return!1},HiddenRangeOp.prototype.setPreviousOp=function(t){this.prevOp=t},HiddenRangeOp.prototype.getPreviousOp=function(){return this.prevOp},HiddenRangeOp.prototype.containsPreviousOp=function(){return null!=this.prevOp},HiddenRangeOp.prototype.setNextOp=function(t){this.nextOp=t},HiddenRangeOp.prototype.getNextOp=function(){return this.nextOp},HiddenRangeOp.prototype.containsNextOp=function(){return null!=this.nextOp},HiddenRangeOp.prototype.setRangeTypes=function(t){this.rangeTypes=t},HiddenRangeOp.prototype.getRangeTypes=function(){return this.rangeTypes},HiddenRangeOp.prototype.setContentStyleOp=function(t){this.contentStyleOp=t},HiddenRangeOp.prototype.getContentStyleOp=function(){return this.contentStyleOp},HiddenRangeOp.prototype.clone=function(){var t=new HiddenRangeOp(this.range,this.chars,this.rangeTypes,this.contentStyleOp,this.style,this.originAction,this.id);return this.containsPreviousOp()&&t.setPreviousOp(this.getPreviousOp()),this.containsNextOp()&&t.setNextOp(this.getNextOp()),t},HiddenRangeOp.prototype.getContentStyleOpChars=function(){for(var t=this.contentStyleOp.docOps,e="",n=0,r=t.length;n<r;n++){var i=t[n];i.isInsert()&&(e+=i.characters)}return e},HiddenRangeOp.prototype.getContentStyleOpLength=function(){for(var t=this.contentStyleOp.docOps,e=0,n=0,r=t.length;n<r;n++){var i=t[n];i.isInsert()&&(e+=i.length())}return e},HiddenRangeOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n=HiddenRangesHandler.cutContentStyleOp(this,t),r=n.inclusiveCutop,i=n.exclusiveCutop;this.contentStyleOp=i;var o=new HiddenRangeOp(t,e,this.rangeTypes,r,this.style,this.originAction,this.id);return this.containsPreviousOp()&&o.setPreviousOp(this.getPreviousOp()),this.containsNextOp()&&o.setNextOp(this),this.setPreviousOp(o),o},HiddenRangeOp.prototype.applyContentStyle=function(t){HiddenRangesHandler.applyContentStyle(this,t)},HiddenRangeOp.prototype.getInsertionHiddenRangeOp=function(t){var e=DocOpBuilder.build([]);return e.newCharacters(t),new HiddenRangeOp(t.length,t,this.rangeTypes,e,this.style,this.originAction,this.id)},HiddenRangeOp.prototype.toJSON=function(){return{hiddenRange:{range:this.range,chars:this.chars,rangeTypes:this.rangeTypes,origin:this.originAction,id:this.id}}},HiddenRangeOp.prototype.toString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,JSON.stringify(t)},HiddenRangeOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,t.origin=this.originAction,JSON.stringify(t)};var HiddenComposeOp=function(t,e,n,r,i,o,s){HiddenRangeOp.call(this),this.constructor(t,e,n,r,i,o,s)};HiddenComposeOp.prototype=Object.create(HiddenRangeOp.prototype),HiddenComposeOp.prototype.constructor=HiddenRangeOp,HiddenComposeOp.prototype.type=DOCOP_TYPE_HIDDEN_COMPOSE_OP,HiddenComposeOp.prototype.clone=function(){return new HiddenComposeOp(this.range,this.chars,this.rangeTypes,this.contentStyleOp,this.style,this.originAction,this.id)},HiddenComposeOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n=HiddenRangesHandler.cutContentStyleOp(this,t),r=n.inclusiveCutop,i=n.exclusiveCutop;return this.contentStyleOp=i,new HiddenComposeOp(t,e,this.rangeTypes,r,this.style,this.originAction,this.id)},HiddenComposeOp.prototype.toJSON=function(){return{hiddenRange:{range:this.range,chars:this.chars,rangeTypes:this.rangeTypes,origin:this.originAction,id:this.id}}},HiddenComposeOp.prototype.toString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,JSON.stringify(t)},HiddenComposeOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,t.origin=this.originAction,JSON.stringify(t)};var HiddenRemoveOp=function(t,e,n,r,i,o,s){HiddenRangeOp.call(this),this.constructor(t,e,n,r,i,o,s)};HiddenRemoveOp.prototype=Object.create(HiddenRangeOp.prototype),HiddenRemoveOp.prototype.constructor=HiddenRangeOp,HiddenRemoveOp.prototype.type=DOCOP_TYPE_HIDDEN_REMOVE_OP,HiddenRemoveOp.prototype.clone=function(){return new HiddenRemoveOp(this.range,this.chars,this.rangeTypes,this.contentStyleOp,this.style,this.originAction,this.id)},HiddenRemoveOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n=HiddenRangesHandler.cutContentStyleOp(this,t),r=n.inclusiveCutop,i=n.exclusiveCutop;return this.contentStyleOp=i,new HiddenRemoveOp(t,e,this.rangeTypes,r,this.style,this.originAction,this.id)},HiddenRemoveOp.prototype.toJSON=function(){return{hiddenRange:{range:this.range,chars:this.chars,rangeTypes:this.rangeTypes,origin:this.originAction,id:this.id}}},HiddenRemoveOp.prototype.toString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,JSON.stringify(t)},HiddenRemoveOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.chars=this.chars,t.rangeTypes=this.rangeTypes,t.origin=this.originAction,JSON.stringify(t)};var TC_ACTION_DELETE="delete",TC_ACTION_INSERT="insert";TCOp.prototype=new DocOp,TCOp.prototype.type=DOCOP_TYPE_TC,TCOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n=TcNoMarkupHandler.cutContentStyleOp(this,t),r=n.inclusiveCutop,i=n.exclusiveCutop;this.contentStyleOp=i;var o=new TCOp(t,this.action,this.zuid,e,this.style,this.originAction,r);return o},TCOp.prototype.clone=function(){return new TCOp(this.range,this.action,this.zuid,this.chars,this.style,this.originAction,this.contentStyleOp)},TCOp.prototype.length=function(){return this.range},TCOp.prototype.toString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars(),JSON.stringify(t)},TCOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars().length,JSON.stringify(t)},TCOp.prototype.toJSON=function(){return{tc:{range:this.range,action:this.action,zuid:this.zuid,originAction:this.originAction,type:this.type,chars:this.chars,style:this.style}}},TCOp.prototype.getUser=function(){return this.zuid},TCOp.prototype.setChars=function(t){this.chars=t},TCOp.prototype.getChars=function(){return this.chars},TCOp.prototype.getOriginAction=function(){return this.originAction},TCOp.prototype.setOriginAction=function(t){this.originAction=t},TCOp.prototype.getStyle=function(){return this.style},TCOp.prototype.setStyle=function(t){this.style=t},TCOp.prototype.getContentStyleOpChars=function(){return TcNoMarkupHandler.getContentStyleOpChars(this.contentStyleOp)},TCOp.prototype.getContentStyleOp=function(){return this.contentStyleOp},TCOp.prototype.getContentStyleOpLength=function(){return TcNoMarkupHandler.getContentStyleOpLength(this.contentStyleOp)},TCOp.prototype.setContentStyleOp=function(t){this.contentStyleOp=t},TCOp.prototype.isEquals=function(t){return!!t&&(this.action==t.action&&this.zuid==t.zuid&&this.style.type==t.style.type&&TcUtil.isEqualTCStyles(this.style,t.style))};var TCRemoveOp=function(t,e,n,r,i,o,s){TCOp.call(this),this.constructor(t,e,n,r,i,o,s)};TCRemoveOp.prototype=new TCOp,TCRemoveOp.prototype.constructor=TCOp,TCRemoveOp.prototype.type=DOCOP_TYPE_REMOVE_TC,TCRemoveOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n;if(this.getContentStyleOp()){var r=TcNoMarkupHandler.cutContentStyleOp(this,t);n=r.inclusiveCutop;var i=r.exclusiveCutop;this.contentStyleOp=i}var o=new TCRemoveOp(t,this.action,this.zuid,e,this.style,this.originAction,n);return o},TCRemoveOp.prototype.getContentStyleOpChars=function(){return TcNoMarkupHandler.getContentStyleOpChars(this.contentStyleOp)},TCRemoveOp.prototype.getContentStyleOp=function(){return this.contentStyleOp},TCRemoveOp.prototype.getContentStyleOpLength=function(){return TcNoMarkupHandler.getContentStyleOpLength(this.contentStyleOp)},TCRemoveOp.prototype.setContentStyleOp=function(t){this.contentStyleOp=t},TCRemoveOp.prototype.clone=function(){return new TCRemoveOp(this.range,this.action,this.zuid,this.chars,this.style,this.originAction,this.contentStyleOp)},TCRemoveOp.prototype.toString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars(),JSON.stringify(t)},TCRemoveOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars().length,JSON.stringify(t)};var TCStyleOp=function(t,e,n,r,i,o,s){TCOp.call(this),this.constructor(t,e,n,r,i,o,s)};TCStyleOp.prototype=Object.create(TCOp.prototype),TCStyleOp.prototype.constructor=TCOp,TCStyleOp.prototype.type=DOCOP_TYPE_TC_STYLE_OP,TCStyleOp.prototype.cut=function(t){this.range-=t;var e=this.chars.substring(0,t);this.chars=this.chars.substring(t);var n=TcNoMarkupHandler.cutContentStyleOp(this,t),r=n.inclusiveCutop,i=n.exclusiveCutop;this.contentStyleOp=i;var o=new TCStyleOp(t,this.action,this.zuid,e,this.style,this.originAction,r);return o},TCStyleOp.prototype.getChars=function(){return this.chars},TCStyleOp.prototype.getContentStyleOpChars=function(){return TcNoMarkupHandler.getContentStyleOpChars(this.contentStyleOp)},TCStyleOp.prototype.getContentStyleOp=function(){return this.contentStyleOp},TCStyleOp.prototype.getContentStyleOpLength=function(){return TcNoMarkupHandler.getContentStyleOpLength(this.contentStyleOp)},TCStyleOp.prototype.setContentStyleOp=function(t){this.contentStyleOp=t},TCStyleOp.prototype.clone=function(){return new TCStyleOp(this.range,this.action,this.zuid,this.chars,this.style,this.originAction,this.contentStyleOp)},TCStyleOp.prototype.toString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars(),JSON.stringify(t)},TCStyleOp.prototype.toProtoString=function(){var t={};return t.range=this.range,t.action=this.action,t.zuid=this.zuid,t.originAction=this.originAction,t.type=this.type,t.chars=this.getContentStyleOpChars().length,JSON.stringify(t)},LockOp.prototype=new DocOp,HiddenRangeCharOp.prototype=new DocOp,HiddenRangeCharOp.prototype.type=DOCOP_TYPE_HIDDEN_RANGECHAR_OP,HiddenRangeCharOp.prototype.setId=function(t){this.id=t},HiddenRangeCharOp.prototype.getId=function(){return this.id},HiddenRangeCharOp.prototype.cloneRangeTypes=function(t){for(var e=[],n=0,r=t.length;n<r;n++)e[n]=t[n];return e},HiddenRangeCharOp.prototype.clone=function(){var t=new HiddenRangeCharOp(this.rangeChar,this.rangeTypes,this.id,this.isIfConditionShown);return this.containsPreviousOp()&&t.setPreviousOp(this.getPreviousOp()),this.containsNextOp()&&t.setNextOp(this.getNextOp()),t},HiddenRangeCharOp.prototype.cut=function(){var t=new HiddenRangeCharOp(this.rangeChar,this.rangeTypes,this.id,this.isIfConditionShown);return this.containsPreviousOp()&&t.setPreviousOp(this.getPreviousOp()),this.containsNextOp()&&t.setNextOp(this.getNextOp()),t},HiddenRangeCharOp.prototype.length=function(){return this.range},HiddenRangeCharOp.prototype.toString=function(){return"{'r': "+this.rangeChar+", 'char': "+this.rangeChar+", 'rangeTypes': "+this.rangeTypes+", 'id': "+this.id+"}"},HiddenRangeCharOp.prototype.toJSON=function(){return"{'r': "+this.rangeChar+", 'char': "+this.rangeChar+", 'rangeTypes': "+this.rangeTypes+", 'id': "+this.id+"}"},HiddenRangeCharOp.prototype.mergeRangeTypes=function(t){var e,n,r;for(e=0,n=t.length;e<n;e++)r=t[e],this.rangeTypes.indexOf(r)<0&&this.rangeTypes.push(r)},HiddenRangeCharOp.prototype.setRangeTypes=function(t){this.rangeTypes=t},HiddenRangeCharOp.prototype.getRangeTypes=function(){return this.rangeTypes},HiddenRangeCharOp.prototype.setPreviousOp=function(t){this.prevOp=t},HiddenRangeCharOp.prototype.getPreviousOp=function(){return this.prevOp},HiddenRangeCharOp.prototype.containsPreviousOp=function(){return null!=this.prevOp},HiddenRangeCharOp.prototype.setNextOp=function(t){this.nextOp=t},HiddenRangeCharOp.prototype.getNextOp=function(){return this.nextOp},HiddenRangeCharOp.prototype.containsNextOp=function(){return null!=this.nextOp},HiddenRangeCharOp.prototype.setIfPartShown=function(t){this.isIfConditionShown=t},HiddenRangeCharOp.prototype.isIfPartShown=function(){return this.isIfConditionShown},HiddenRangeCharOp.prototype.isElsePartShown=function(){return!this.isIfConditionShown},HiddenRangeCharOp.prototype.isRangeStart=function(){return this.rangeChar===UNICODE.RANGE_START},HiddenRangeCharOp.prototype.isRangeEnd=function(){return this.rangeChar===UNICODE.RANGE_END},HiddenRangeCharOp.prototype.getInsertionHiddenRangeOp=function(t){var e=DocOpBuilder.build([]);return e.newCharacters(t),new HiddenRangeOp(t.length,t,this.rangeTypes,e,null,null,this.id)},HiddenRangeCharOp.prototype.containsConditionRangeType=function(){var t,e,n,r=this.rangeTypes;for(t=0,e=r.length;t<e;t++)if(n=r[t],n.indexOf("condition")>=0)return!0;return!1},DocOpBuilder.prototype.length=function(){return this.docOps.length},DocOpBuilder.prototype.isEmpty=function(){return 0===this.length()},DocOpBuilder.prototype.applyStyles=function(t,e,n){var r=[],i=new DocOp;i.skipChars(t),this.docOps.push(i),i=new DocOp,i.changeStyles([],n),this.docOps.push(i),i=new DocOp,i.skipChars(e-t),this.docOps.push(i);var r=[];for(var o in n)n.hasOwnProperty(o)&&r.push(o);i=new DocOp,i.changeStyles(r,[]),this.docOps.push(i)},DocOpBuilder.prototype.toString=function(){for(var t,e=this.getDocOps(),n=[],r="",i=e.length,o=0;o<i;o++)t=e[o],t.isTC()?n.push(t.toString()):t.isTCStyleOp()?n.push(t.toString()):t.isRemoveTC()?n.push(t.toString()):t.isHiddenRangeOp()?n.push(t.toString()):t.isHiddenComposeOp()?n.push(t.toString()):t.isHiddenRemoveOp()?n.push(t.toString()):t.isRetain()?n.push('{"r":'+t.retain_count+"}"):t.isInsert()?n.push('{"is":"'+Utils.escapeSplChars(t.characters)+'"}'):t.isLock()?n.push('{"lk":'+JSON.stringify(t.lock_data)+"}"):t.isDelete()?n.push('{"ds":"'+Utils.escapeSplChars(t.delete_characters)+'"}'):t.isAnnotation()&&(t.styles.end.length>0?n.push('{"as":{"end":'+JSON.stringify(t.styles.end)+',"id":'+JSON.stringify(t.styles.id)+"}}"):t.styles.begin&&n.push('{"as":{"start":'+JSON.stringify(t.styles.begin)+',"id":'+JSON.stringify(t.styles.id)+"}}"));return r=n.join(),"["+r+"]"},DocOpBuilder.prototype.newCharacters=function(t){var e=new DocOp;e.newCharacters(t),this.docOps.push(e)},DocOpBuilder.prototype.deleteCharacters=function(t){var e=new DocOp;e.deleteCharacters(t),this.docOps.push(e)},DocOpBuilder.prototype.skipChars=function(t){var e=new DocOp;e.skipChars(t),this.docOps.push(e)},DocOpBuilder.prototype.newLockOp=function(t,e){var n=new DocOp;n.lock(t,e),this.docOps.push(n)},DocOpBuilder.prototype.getDocOps=function(){return this.docOps},DocOpBuilder.prototype.push=function(t){this.docOps.push(t)},DocOpBuilder.prototype.pop=function(){this.docOps.pop()},DocOpBuilder.build=function(t,e){for(var n,r,i=new DocOpBuilder,o=t.length,s=[],a=0;a<o;a++){var l,d=t[a],c=new DocOp;if(d.r>=0)s=[],c.skipChars(d.r);else if(d.is){if(e&&s.length){for(var p=0,E=s.length;p<E;p++)i.pop();c.insertStyles=s}s=[],r&&r.isAnnotation()&&(i.isAsIs=!0),c.newCharacters(d.is)}else if(d.ds)s=[],c.deleteCharacters(d.ds);else if(d.as)l=d.as,n=l.id||"",l.start?(c.changeStyles([],l.start,n),e&&s.push(DocOp.clone(c))):(s=[],c.changeStyles(l.end,[],n));else if(l=d.lk){s=[],i.isLock=!0,c.lock(l),c.lock_data.origRange=l.range;var u=l.data;d.data&&(c.lock_data.data=u=d.data),i.isRedact=u.redact}i.push(c),r=c}return i},DocOpBuilder.getMergedIsAS=function(t){var e,n=[],r=t.length;if(1===r)return t;for(var i=0;i<r;i++)e=t[i].toJson(),n.push(DocOpBuilder.build(e,!0));return n},DocOpBuilder.combineOps=function(t){t=DocOpBuilder.getMergedIsAS(t);for(var e=t[0],n=1;n<t.length;n++)e.applyOp(t[n]),"tc-accept-all"!=editor.lastOperation&&"tc-reject-all"!=editor.lastOperation||(e=DocOpBuilder.clone(e));for(var r,i,o=e.getDocOps(),n=0;r=o[n];){if(r.isInsert()&&r.insertStyles.length>0){i=r.insertStyles;for(var s=0,a=i.length;s<a;s++)e.docOps.splice(n,0,i[s]),n++}n++}return e=DocOpBuilder.concise(e)},DocOpBuilder.prototype.applyTo=function(t,e){if(DocOpBuilder.postProcessConcise(this),t&&(this.cursorObj=t.cursor,"collabop"===t.operation?this.uuid=t.sid:t.cursor&&(this.cursor=this.cursorObj[editor.uuid]),this.operation=t.operation),(!t||"hiddenRangesApplyto"!=t.operation&&"collabop"!=t.operation)&&!isV8Engine)if(editor.doc.getTrackChangeDetails().isNoMarkupON()){HiddenRangesHandler.composeClientOpAndHiddenRangeOps(DocOpBuilder.clone(this),TCConstants.TC);var n=HiddenRangesHandler.processTcClientOp(DocOpBuilder.clone(this));if(e){var r=DocOpBuilder.xform(n,e),i=r.second.getCursorPos();i.length>0&&(this.cursor=i)}this.docOps=n.docOps}else HiddenRangesHandler.hasHiddenRangeOps()&&HiddenRangesHandler.composeClientOpAndHiddenRangeOps(DocOpBuilder.clone(this));PubSub.publish("Document/BeforeModelUpdation",this),this._applyTo();var o=editor.doc.getSelection();if(o&&1===o.length){var s=o.getLastRange();if(s&&this.cursor&&this.cursor.length){var a=this.cursor[0].start,l=this.cursor[0].end;ZWLogger.log("Changing last range in selection with docOpBuilder's cursor after snapshot: ["+a+", "+l+"], range in selection: ["+s.start+", "+s.end+"]"),s.setStart(a),s.setEnd(l)}}this.postApplyTo(),PubSub.publish("Document/AfterModelUpdation",this)},DocOpBuilder.prototype._applyTo=function(){ZWLogger.log("_Apply To : Starts..."),editor.doc.model.applyOps(this)},DocOpBuilder.prototype.resetCursor=function(){var t=editor.doc.getSelection();switch(t.selectionType){case SEL_CONTEXT:case SEL_KEYBOARD:case SEL_MOUSE:this.cursor=[]}},DocOpBuilder.prototype.setCursor=function(t){if(t&&t.length){try{var e=this.operation,n=editor.doc.getSelection();ZWLogger.log("Set Cursor: Operation: "+e+", Old Selection: "+n.toIntervals().join("|")),t.length>1&&e&&"undo"!=e&&"redo"!=e&&!n.isListItemSelection?n.isCtrlSelection?ZWLogger.addToStatistics(e+"_ON_CTRL_SEL"):ZWLogger.addToStatistics(e+"_ON_MUL_SEL"):e&&"undo"!=e&&"redo"!=e&&n.isListItemSelection&&ZWLogger.addToStatistics(e+"_ON_LIST_SEL");for(var r,i,o,s=[],a="Drag and Drop"===e||"undo"===e||"redo"===e,l=0,d=t.length;l<d;l++)r=t[l].start,i=t[l].end,o=editor.doc.createRange(r,i).setFocus(a),s.push(o);n.isListItemSelection||("undo"==e||"redo"==e)&&Op.isListItemSelection?n.selectAllListItems(s&&s[0].start):("undo"!=e&&"redo"!=e||(n.isCtrlSelection=Op.isCtrlSelection),n.removeAllRanges().setSelectionType(SEL_OP_GEN).addRanges(s,!0).mapAllSelectionsToBulletin()),ZWLogger.log("Set Cursor: New Selection: "+n.toIntervals().join("|")),n.setCursorFormat()}catch(e){ZWLogger.log("_"+ZWCollaboration.SET_CURSOR_ERROR+"_SET_CURSOR_ERROR_ CURRENT-USER-SETCURSOR Cursor: "+JSON.stringify(t));var c=e.message;if(c===ZWCollaboration.SHOW_CARET_GETPORTION_ERROR||c===ZWCollaboration.NO_LINE_CANNOT_SELECT||c===ZWCollaboration.SHOW_CARET_SELECTION_ERROR)throw e;var p=new Error(ZWCollaboration.SET_CURSOR_ERROR);throw p.stack=e.stack,p}if(0!==editor.doc.collabUsers.length&&"collabop"!==this.operation)try{ZWCollaboration.transformAndApplyOthersCursor(this,editor.uuid);var E=[];try{E=ZWCollaboration.getRangesInRegionOfUser(editor.uuid)||[],ZWCollaboration.updateCollabUsersRanges(E)}catch(t){E=[]}}catch(e){ZWLogger.log("_"+ZWCollaboration.SET_COLLAB_CURSOR_ERROR+"_SET_COLLAB_CURSOR_ERROR_ COLLABORATORS-SETCURSOR Cursor: "+JSON.stringify(t)+", Collaborators: "+JSON.stringify(editor.doc.collabUsers));var c=e.message;if(c===ZWCollaboration.SHOW_CARET_GETPORTION_ERROR||c===ZWCollaboration.NO_LINE_CANNOT_SELECT||c===ZWCollaboration.SHOW_CARET_SELECTION_ERROR)throw e;var p=new Error(ZWCollaboration.SET_COLLAB_CURSOR_ERROR);throw p.stack=e.stack,p}}},DocOpBuilder.prototype.postApplyTo=function(){var t={operation:this.operation,uuid:this.uuid,cursor:this.cursor,cursorObj:this.cursorObj};editor.doc.postApplyTo(t,this)},DocOpBuilder.prototype.getCursorPos=function(){for(var t,e=this.getDocOps(),n=e.length,r=0,i={},o=[],s=0;s<n;s++)t=e[s],t.isRetain()&&(r+=t.length()),t.isAnnotation()&&(t.isAnnotationStart()?"cursor"==t.styles.begin.type&&(i.start=0==parseInt(r)?1:r):i.start&&(i.end=0==parseInt(r)?1:r,o.push(i),i={}));return o},DocOpBuilder.prototype.getOpAndCursorPos=function(){for(var t,e,n=this.getDocOps(),r=new DocOpBuilder,i=n.length,o=0,s={},a={},l=[],d=0;d<i;d++)if(t=n[d],t.isRetain())o+=t.length(),r.push(t);else if(t.isInsert())o+=t.length(),r.push(t);else if(t.isAnnotation())if(t.isAnnotationStart()&&"cursor"==t.styles.begin.type)s.start=0==parseInt(o)?1:o,s.selectObject=!!t.styles.begin.selectObject,e=t.styles.id;else if(t.styles.id==e){var c=ZWArrayUtils.lastElementOf(r.getDocOps());c&&c.isRetain()&&0==c.length()&&r.getDocOps().pop(),s.end=0==parseInt(o)?1:o,l.push(s),s={}}else r.push(t);else r.push(t);return r=DocOpBuilder.concise(r),a.op=r,a.positions=l,a},DocOpBuilder.prototype.toProtoString=function(){for(var t,e=this.getDocOps(),n=[],r="",i=e.length,o=0;o<i;o++)t=e[o],t.isTC()?n.push(t.toProtoString()):t.isRemoveTC()?n.push(t.toProtoString()):t.isHiddenRangeOp()?n.push(t.toProtoString()):t.isHiddenComposeOp()?n.push(t.toProtoString()):t.isHiddenRemoveOp()?n.push(t.toProtoString()):t.isRetain()?n.push('{"r":'+t.retain_count+"}"):t.isInsert()?n.push('{"is":"'+t.characters.length+'"}'):t.isLock()?n.push('{"lk":'+JSON.stringify(t.lock_data)+"}"):t.isDelete()?n.push('{"ds":"'+t.delete_characters.length+'"}'):t.isAnnotation()&&(t.styles.end.length>0?n.push('{"as":{"end":'+JSON.stringify(t.styles.end)+',"id":'+JSON.stringify(t.styles.id)+"}}"):t.styles.begin&&n.push('{"as":{"start":'+JSON.stringify(t.styles.begin)+',"id":'+JSON.stringify(t.styles.id)+"}}"));return r=n.join(),"["+r+"]"},DocOpBuilder.prototype.toJson=function(){for(var t,e=this.getDocOps(),n=[],r=e.length,i=0;i<r;i++){var o={};t=e[i],t.isRetain()?o.r=t.retain_count:t.isInsert()?o.is=t.characters:t.isDelete()?o.ds=t.delete_characters:t.isAnnotation()?(o.as={},o.as.id=t.styles.id,t.styles.end.length>0?o.as.end=t.styles.end:t.styles.begin&&(o.as.start=t.styles.begin)):t.isLock()&&(o.lk=t.lock_data),ZWJSONUtils.isEmptyObject(o)||n.push(o)}return n},DocOpBuilder.prototype.convertIntegralStylesToNormalOPs=function(){for(var t,e=this.getDocOps(),n=e.length,r=new DocOpBuilder,i=0;i<n;i++){if(t=e[i],t.isInsert())if(t.hasIntegralStyles()){for(var o=t.integralStyles,s=[],a=0,l=o.length;a<l;a++){var d=o[a];r.push(d),s.push(d.styles.id)}r.push(t);for(var a=0,l=o.length;a<l;a++){var c=o[a],p=new DocOp;p.changeStyles(U.keys(c.styles.begin),[],s[a]),r.push(p)}}else r.push(t);else if(t.isDelete())if(t.hasIntegralStyles()){for(var o=t.integralStyles,s=[],a=0,l=o.length;a<l;a++){var d=o[a];r.push(d),s.push(d.styles.id)}r.push(t);for(var a=0,l=o.length;a<l;a++){var c=o[a],p=new DocOp;p.changeStyles(U.keys(c),[],s[a]),r.push(p)}}else r.push(t);else r.push(t)}return r},DocOpBuilder.prototype.applyOp=function(t){for(var e=this.docOps,n=t.docOps,r=function(t){t._len=t.length()},i=function(t,e){var n=t._len;t._len-=e._len,e._len-=n},o=0,s=0;o<e.length&&s<n.length;){var a=e[o],l=n[s];if(l.isRetain()&&0==l.length())e.splice(o,0,l),o++,s++;else if(a.isRetain()&&l.isRetain()||a.isDelete()&&l.isRetain()||a.isDelete()&&l.isDelete()||a.isLock()&&l.isRetain())i(a,l),a._len<=0&&(r(a),o++),l._len<=0&&(r(l),s++);else if(a.isRetain()&&l.isInsert()||a.isRetain()&&l.isAnnotation()||a.isDelete()&&l.isInsert()||a.isDelete()&&l.isAnnotation()||null!=a.styles&&!a.isAnnotationEnd()&&l.isInsert()){if(null==a.styles&&a.length()>a._len){var d=a.splitAt(a.length()-a._len);r(a),e.splice(o+1,0,d),a=e[++o]}r(l),e.splice(o,0,l),o++,s++}else if(a.isRetain()&&l.isDelete()){if(a.length()>a._len){var d=a.splitAt(a.length()-a._len);r(a),e.splice(o+1,0,d),a=e[++o]}if(i(a,l),a._len>0?a.retain_count=a._len:e.splice(o,1),l._len>0){var d=l.splitAt(l.length()-l._len);n.splice(s+1,0,d)}r(l),e.splice(o,0,l),o++,s++}else a.isAnnotation()&&l.isAnnotation()&&a.isAnnotationStart()?(e.splice(o,0,l),s++,o++):o++}if(s<n.length){var c=n[s];c.isRetain()&&c._len>0&&(c.retain_count=c._len),Array.prototype.push.apply(e,n.splice(s))}},DocOpBuilder.prototype.setPriorityDelete=function(t,e,n){var r,i,o;r=t.delete_characters,i=t.delete_characters.length;var s=Utils.findNextIndexOf(UNICODE.TABLE+"|"+UNICODE.ROW+"|"+UNICODE.CELL+"|"+UNICODE.TOCSTART,0,r);if(s>=0&&s<0){var a=new Error(ZWCollaboration.API_NEGATIVE_IDX);throw editor.lastError=a,a}if(s!=-1){var l=t.delete_characters.charAt(s);if(0!=s){var d,c=s,p=r.substring(0,c);t.deleteCharacters(p);var E=r.substring(c,i);t=new DocOp,t.deleteCharacters(E),n.docOps.splice(e+1,0,t)}else if(l==UNICODE.TABLE?(d=DocUtil.getEnd(s+1,l,r),d>0&&(d+=1)):l==UNICODE.ROW?d=DocUtil.getEnd(s+1,l,r):l==UNICODE.CELL?d=DocUtil.getEnd(s+1,l,r):l==UNICODE.TOCSTART&&(d=DocUtil.getEnd(s+1,UNICODE.TOCEND,r)),d!=-1){if(o=r.substring(s,d),t.deleteCharacters(o),t.isPriorityOp=!0,d!=i){var E=r.substring(d,i);t=new DocOp,t.deleteCharacters(E),n.docOps.splice(e+1,0,t)}}else d==-1&&(o=r.substring(s,i),t.deleteCharacters(o),t.isPriorityOp=!0)}},DocOpBuilder.xform=function(t,e){if(0==t.docOps.length||0==e.docOps.length)return{first:t,second:e};for(var n=DocOpBuilder.clone(t),r=DocOpBuilder.clone(e),i=new DocOpBuilder,o=new DocOpBuilder,s={},a={},l=0,d=0,c=n.docOps[l],p=r.docOps[d],E={},u={next1:!1,next2:!1},T=e.zuid||editor.zuid;l<n.length()&&d<r.length();)c.isDelete()&&DocOpBuilder.prototype.setPriorityDelete(c,l,n),p.isDelete()&&DocOpBuilder.prototype.setPriorityDelete(p,d,r),0==c.length()||0==p.length()?(0==c.length()&&(i.push(c),u.next1=!0,u.next2=!1),0==p.length()&&(o.push(p),u.next2=!0,u.next1=!1)):c.isInsert()?DocOpBuilder.xformInsertChars(i,o,c,p,u,s,a,E):c.isRetain()?DocOpBuilder.xformRetain(i,o,c,p,u,s,a,E):c.isHiddenRangeOp()?DocOpBuilder.xformHiddenRange(i,o,c,p,u,s,a,E):c.isHiddenRemoveOp()?DocOpBuilder.xformHiddenRemove(i,o,c,p,u,s,a,E):c.isHiddenRangeCharOp()?DocOpBuilder.xformHiddenRangeChar(i,o,c,p,u,s,a,E):c.isTC()?DocOpBuilder.xformChanges(i,o,c,p,u,s,a,E):c.isRemoveTC()?DocOpBuilder.xformRemoveChanges(i,o,c,p,u,s,a,E):c.isLock()?DocOpBuilder.xformLock(i,o,c,p,u,s,a,E,T):c.isDelete()?DocOpBuilder.xformDeleteChars(i,o,c,p,u,s,a,E):c.isAnnotation()&&DocOpBuilder.xformAnnotationBoundary(i,o,c,p,u,s,a,E),u.next1&&(l++,l<n.docOps.length&&(c=n.docOps[l])),u.next2&&(d++,d<r.docOps.length&&(p=r.docOps[d])),u.next1=!1,u.next2=!1;if(l!=n.docOps.length||d!=r.docOps.length){for(;l!=n.docOps.length;)i.push(n.docOps[l]),l++;for(;d!=r.docOps.length;)o.push(r.docOps[d]),d++}return{first:i,second:o}},DocOpBuilder.xformAnnotationBoundary=function(t,e,n,r,i,o,s,a){var l={},d="",c=[];if(r.isInsert())if(n.isAnnotationEnd()){var p=DocOp.clone(n);t.docOps.push(p),i.next1=!0,i.next2=!1}else{var p=DocOp.clone(r);e.docOps.push(p),p=new DocOp,p.skipChars(r.characters.length),t.docOps.push(p),i.next1=!1,i.next2=!0}else{if(n.isAnnotationEnd())c=n.styles.end,d=n.styles.id;else{if(r.isAnnotationStart()){if(n.styles.begin.type==r.styles.begin.type){var E=(new Date).getMilliseconds();r.xformedStyleId=E,a[E]=n}}else if(n.hasOwnProperty("xformedStyleId")){var d=n.xformedStyleId,u=a[d],T=u.styles.begin;for(var h in T)n.styles.begin[h]=T[h]}l=n.styles.begin,d=n.styles.id}var p=new DocOp;p.changeStyles(c,l,d),t.docOps.push(p),i.next1=!0,i.next2=!1}},DocOpBuilder.getPermission=function(t,e){var n=t.lock_data?t.lock_data.data.allowed_zuids:"";return n=","+n+",",t.lock_data&&(t.lock_data.data.zuid==e||n.indexOf(","+e+",")>-1)||"collabop"==e},DocOpBuilder.xformHiddenRange=function(t,e,n,r,i,o,s,a){if(i.next1=!0,r.isHiddenComposeOp()||r.isHiddenRangeCharOp()){var l=DocOp.clone(n);l.setRangeTypes(r.getRangeTypes()),t.push(n),e.push(l)}else if(n.containsConditionRangeType()){var d=n.getNextOp();if(r.isAnnotation()&&d&&d.isHiddenRangeCharOp()&&d.isRangeEnd())e.push(r),i.next1=!1,i.next2=!0;else if(r.isInsert()&&d&&d.isHiddenRangeCharOp()&&d.isRangeEnd())t.skipChars(r.length()),e.push(r),i.next1=!1,i.next2=!0;else if(r.isDelete()){var c=r.delete_characters;c.indexOf(UNICODE.RANGE_START)>=0&&c.indexOf(UNICODE.RANGE_END+UNICODE.RANGE_END)>=0||c.indexOf(UNICODE.RANGE_START)<0&&c.indexOf(UNICODE.RANGE_END)>=0?e.deleteCharacters(n.getContentStyleOpChars()):(t.push(n),e.skipChars(n.length()))}else t.push(n),e.skipChars(n.length())}else r.isDelete()?editor.doc.getTrackChangeDetails().getProcessingTC()?(e.skipChars(n.length()),t.push(n)):e.deleteCharacters(n.getContentStyleOpChars()):(t.push(n),e.skipChars(n.length()))},DocOpBuilder.xformChanges=function(t,e,n,r,i,o,s,a,l){i.next1=!0,r.isDelete()?editor.doc.getTrackChangeDetails().getProcessingTC()?(e.skipChars(n.length()),t.push(n)):e.deleteCharacters(n.getContentStyleOpChars()):(t.push(n),e.skipChars(n.length()))},DocOpBuilder.xformRemoveChanges=function(t,e,n,r,i,o,s,a,l){var d=DocOpBuilder.cutToEqLenAndMove(n,r,i);r.isTC()?(d.item1.setContentStyleOp(d.item2.getContentStyleOp()),t.push(d.item1),e.push(d.item2)):r.isRetain()&&(t.skipChars(d.item1.length()),e.push(d.item2))},DocOpBuilder.xformHiddenRemove=function(t,e,n,r,i,o,s,a){var l=DocOpBuilder.cutToEqLenAndMove(n,r,i);r.isHiddenRangeOp()?(l.item1.setContentStyleOp(l.item2.getContentStyleOp()),l.item1.setRangeTypes(l.item2.getRangeTypes()),t.push(l.item1),e.push(l.item2)):(r.isRetain()||r.isHiddenRangeCharOp())&&(t.skipChars(l.item1.length()),e.push(l.item2))},DocOpBuilder.xformHiddenRangeChar=function(t,e,n,r,i,o,s,a){if(r.isInsert()){DocOpBuilder.xformInsertChars(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isAnnotation()){DocOpBuilder.xformAnnotationBoundary(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isHiddenComposeOp()){var d=DocOpBuilder.cutToEqLenAndMove(n,r,i);t.docOps.push(d.item1),e.docOps.push(d.item2)}else if(r.isHiddenRangeCharOp())i.next1=!0,i.next2=!0,t.push(n),e.push(r);else if(r.isRetain()){var c=Math.min(n.range,r.retain_count);e.skipChars(c),c===n.range&&(t.push(n),i.next1=!0),c<r.retain_count?r.retain_count-=c:i.next2=!0}else if(r.isDelete()){var c=Math.min(n.range,r.delete_characters.length);c===n.range&&(i.next1=!0),e.deleteCharacters(r.delete_characters.substr(0,c)),c<r.delete_characters.length?r.delete_characters=r.delete_characters.substring(c,r.delete_characters.length):i.next2=!0}},DocOpBuilder.isEntireRangeDeleted=function(t,e){var n=t.lock_data.range,r=e.delete_characters.length;return r>=n},DocOpBuilder.xformLock=function(t,e,n,r,i,o,s,a,l){if(r.isInsert())if(n.lock_data.origRange!=n.lock_data.range&&n.lock_data.origRange){if(!DocOpBuilder.getPermission(n,l))throw"Error in xform lock";var d=new DocOp;d.lock(n.lock_data,r.length()),t.docOps.push(d),e.docOps.push(r),i.next1=!1,i.next2=!0}else{DocOpBuilder.xformInsertChars(e,t,r,n,i,s,o,a);var c=i.next1;i.next1=i.next2,i.next2=c}else if(r.isAnnotation()){DocOpBuilder.xformAnnotationBoundary(e,t,r,n,i,s,o,a);var c=i.next1;i.next1=i.next2,i.next2=c}else if(r.isRetain()){var p=Math.min(n.length(),r.length());t.newLockOp(n.lock_data,p),e.skipChars(p),p<n.lock_data.range?n.lock_data.range-=p:i.next1=!0,p<r.retain_count?r.retain_count-=p:i.next2=!0}else if(r.isDelete()){var E=r,u=n,p=Math.min(u.length(),E.length());if(!(DocOpBuilder.getPermission(n,l)||void 0!=u.lock_data.data.canDelete&&0!=u.lock_data.data.canDelete&&DocOpBuilder.isEntireRangeDeleted(n,r)))throw"Error in xform lock";p<u.length()?u.lock_data.range-=p:i.next1=!0,p<E.length()?(e.deleteCharacters(E.delete_characters.substr(0,p)),E.delete_characters=E.delete_characters.substring(p,E.length())):(e.deleteCharacters(E.delete_characters.substr(0,E.length())),i.next2=!0)}},DocOpBuilder.xformInsertChars=function(t,e,n,r,i,o,s,a){var l;n.characters[0];if(r.isAnnotation()&&r.hasOwnProperty("xformedStyleId")&&(delete r.xformedStyleId,delete a.xformedStyleId),r.isPriorityDelete()){var d=new DocOp;d.deleteCharacters(n.characters),e.docOps.push(d)}else r.isHiddenRangeOp()?r.containsConditionRangeType()&&r.containsPreviousOp()?(l=r.getPreviousOp(),l.isHiddenRangeOp()||l.isHiddenRangeCharOp()&&l.isRangeStart()&&!l.isIfPartShown()?e.push(l.getInsertionHiddenRangeOp(n.characters)):(t.docOps.push(n),e.skipChars(n.characters.length))):r.range===r.originalRange||editor.doc.getTrackChangeDetails().getProcessingTC()?(t.docOps.push(n),e.skipChars(n.characters.length)):e.push(r.getInsertionHiddenRangeOp(n.characters)):r.isHiddenRangeCharOp()&&r.containsConditionRangeType()&&r.containsPreviousOp()?(l=r.getPreviousOp(),r.isRangeEnd()?r.isElsePartShown()?(t.docOps.push(n),e.skipChars(n.characters.length)):e.push(r.getInsertionHiddenRangeOp(n.characters)):l.isHiddenRangeOp()||l.isHiddenRangeCharOp()&&l.isRangeStart()&&!l.isIfPartShown()?e.push(l.getInsertionHiddenRangeOp(n.characters)):(t.docOps.push(n),e.skipChars(n.characters.length))):(t.docOps.push(n),e.skipChars(n.characters.length));i.next1=!0,i.next2=!1},DocOpBuilder.xformRetain=function(t,e,n,r,i,o,s,a){if(r.isInsert()){DocOpBuilder.xformInsertChars(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isAnnotation()){DocOpBuilder.xformAnnotationBoundary(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isTC()){var d=DocOpBuilder.cutToEqLenAndMove(n,r,i);e.docOps.push(d.item2)}else if(r.isHiddenRangeOp()){var d=DocOpBuilder.cutToEqLenAndMove(n,r,i);e.docOps.push(d.item2)}else if(r.isHiddenComposeOp()){var d=DocOpBuilder.cutToEqLenAndMove(n,r,i);t.docOps.push(d.item1),e.docOps.push(d.item2)}else if(r.isTCStyleOp()){var c=n.length(),p=r.length(),E=Math.min(c,p);if(c===p)t.skipChars(c),e.docOps.push(r),i.next1=i.next2=!0;else if(E===c){var u=r.cut(E);t.skipChars(E),e.docOps.push(u),i.next1=!0}else E===p&&(t.skipChars(E),n.retain_count-=E,e.docOps.push(r),i.next2=!0)}else if(r.isRetain()){var T=Math.min(n.retain_count,r.retain_count);t.skipChars(T),e.skipChars(T),T<n.retain_count?n.retain_count-=T:i.next1=!0,T<r.retain_count?r.retain_count-=T:i.next2=!0}else if(r.isHiddenRangeCharOp()){var T=Math.min(n.retain_count,r.range);t.skipChars(T),T<n.retain_count?n.retain_count-=T:i.next1=!0,T==r.range&&(e.push(r),i.next2=!0)}else if(r.isDelete()){var T=Math.min(n.retain_count,r.delete_characters.length);T<n.retain_count?n.retain_count-=T:i.next1=!0,e.deleteCharacters(r.delete_characters.substr(0,T)),T<r.delete_characters.length?r.delete_characters=r.delete_characters.substring(T,r.delete_characters.length):i.next2=!0}else if(r.isLock()){DocOpBuilder.xformLock(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}},DocOpBuilder.xformDeleteChars=function(t,e,n,r,i,o,s,a){if(r.isInsert()){DocOpBuilder.xformInsertChars(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isAnnotation()){DocOpBuilder.xformAnnotationBoundary(e,t,r,n,i,s,o,a);var l=i.next1;i.next1=i.next2,i.next2=l}else if(r.isRetain()){var d=Math.min(r.retain_count,n.delete_characters.length);t.deleteCharacters(n.delete_characters.substr(0,d)),d<n.delete_characters.length?n.delete_characters=n.delete_characters.substr(d,n.delete_characters.length):i.next1=!0,d<r.retain_count?r.retain_count-=d:i.next2=!0}else if(r.isHiddenRangeCharOp()){var d=Math.min(r.range,n.delete_characters.length);t.deleteCharacters(n.delete_characters.substr(0,d)),d<n.delete_characters.length?n.delete_characters=n.delete_characters.substr(d,n.delete_characters.length):i.next1=!0,d==r.range&&(i.next2=!0)}else if(r.isDelete()){var d=Math.min(n.delete_characters.length,r.delete_characters.length);d<n.delete_characters.length?n.delete_characters=n.delete_characters.substr(d,n.delete_characters.length):i.next1=!0,d<r.delete_characters.length?r.delete_characters=r.delete_characters.substr(d,r.delete_characters.length):i.next2=!0}else r.isLock()?(t.docOps.push(n),n.length()>r.length()?r.length(0):r.length(r.length()-n.delete_characters.length),i.next1=!0,i.next2=!1):r.isTC()?DocOpBuilder.cutToEqLenAndMove(n,r,i):r.isHiddenRangeOp()&&DocOpBuilder.cutToEqLenAndMove(n,r,i)},DocOpBuilder.clone=function(t){for(var e=new DocOpBuilder,n=t.getDocOps(),r=0;r<n.length;r++)e.push(DocOp.clone(n[r]));return t.isLock&&(e.isLock=!0),e.isRedact=t.isRedact,e.isInsideRedact=t.isInsideRedact,t.docOpIds&&(e.docOpIds=t.docOpIds),e},DocOpBuilder.concise=function(t){try{var e,n=t.getDocOps(),r=new DocOpBuilder,i=n.length;r.isRedact=t.isRedact,r.isInsideRedact=t.isInsideRedact;for(var o=0;o<i;o++){e=DocOp.clone(n[o]);var s=r.docOps.pop();if(s)if(e.isLock()&&(r.isLock=!0,e.lock_data.origRange=e.lock_data.range),s.isInsert()&&e.isInsert()&&!s.hasIntegralStyles()&&!e.hasIntegralStyles())s.newCharacters(s.characters+e.characters),r.push(s);else if(s.isLock()&&e.isLock()&&DocOpBuilder.isSameLockDocOps(s,e))s.lock_data.range+=e.lock_data.range,s.lock_data.origRange=s.lock_data.range,r.push(s);else if(s.isRetain()&&e.isRetain())s.retain_count+=e.retain_count,r.push(s);else if(s.isDelete()&&e.isDelete()&&!s.hasIntegralStyles()&&!e.hasIntegralStyles())s.deleteCharacters(s.delete_characters+e.delete_characters),r.push(s);else{if(s.isAnnotationStart()&&e.isAnnotationEnd()&&s.styles.id==e.styles.id)continue;r.push(s),r.push(e)}else r.push(e)}}catch(e){throw ZWLogger.log("DocOpBuilder: "+t.toProtoString()),ZWLogger.log("Exception: "+e.stack),ZWLogger.log("Concise Failed @",o),"concise_error"}return r},DocOpBuilder.postProcessConcise=function(t){try{for(var e,n,r=t.getDocOps(),i=0;i<r.length;){if(e=r[i],e.isRetain())n=null;else if(e.isDelete()){if(n){n.deleteCharacters(n.delete_characters+e.delete_characters),r.splice(i,1);continue}n=e}i++}}catch(e){throw ZWLogger.log("DocOpBuilder: "+t.toProtoString()),ZWLogger.log("Exception: "+e.stack),ZWLogger.log("postProcessConcise Failed @",i),"PostProcess_Concise_error"}return t},DocOpBuilder.redact=function(t,e){try{var n=DocOpBuilder.clone(t),r=n.getDocOps(),i=DocOpBuilder.clone(e).getDocOps();if(0==r.length)return 0!=i.length?DocOpBuilder.clone(e):null;if(0==i.length)return DocOpBuilder.clone(t);for(var o=new DocOpBuilder,s=0,a=0,l=r[s],d=i[a],c=editor.zuid,p={next1:!1,next2:!1};s<r.length||a<i.length;){if(s>=r.length&&(l=null),a>=i.length&&(d=null),l&&d)l&&0==l.length()||d&&0==d.length()?(l&&0==l.length()&&(l.isLock||o.push(l),p.next1=!0,p.next2=!1),d&&0==d.length()&&(d.isLock()||o.push(d),p.next2=!0,p.next1=!1)):l&&d&&(l.isRetain()?DocOpBuilder.redactRetain(l,d,p,o):l.isLock()?DocOpBuilder.redactLock(l,d,p,o,c):l.isInsert()?DocOpBuilder.redactInsert(l,d,p,o,c):l.isDelete()?p.next1=!0:l.isAnnotation()&&DocOpBuilder.redactAnnotation(l,d,p,o));else{var E=l?l:d;E.isLock()||o.push(E),p[l?"next1":"next2"]=!0}p.next1&&(s++,s<r.length&&(l=r[s])),p.next2&&(a++,a<i.length&&(d=i[a]))}}catch(t){}return o},DocOpBuilder.redactRetain=function(t,e,n,r){if(e.isInsert())r.push(e),n.next1=!1,n.next2=!0;else if(e.isRetain()){var i=Math.min(t.length(),e.length());e.length()==t.length()?(r.push(t),n.next1=!0,n.next2=!0):i==t.length()?(r.push(t),e.retain_count-=i,n.next1=!0,n.next2=!1):(r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0)}else if(e.isDelete()){var i=Math.min(t.length(),e.length());if(e.length()==t.length())r.push(e),n.next1=!0,n.next2=!0;else if(i==t.length()){var o=new DocOp;o.deleteCharacters(e.delete_characters.substring(0,i)),r.push(o),e.deleteCharacters(e.delete_characters.substring(i)),n.next1=!0,n.next2=!1}else r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0}else e.isAnnotation()&&(r.push(e),n.next1=!1,n.next2=!0)},DocOpBuilder.redactLock=function(t,e,n,r,i){var o=t.isRedact();if(e.isRetain()){var s=Math.min(t.length(),e.length());if(e.length()==t.length())r.push(e),n.next1=!0,n.next2=!0;else if(s==t.length()){var a=new DocOp;a.skipChars(s),r.push(a),e.retain_count-=s,n.next1=!0,n.next2=!1}else r.push(e),t.length(itemt1.length()-s),n.next1=!1,n.next2=!0}else if(e.isInsert()){if(o&&!DocOpBuilder.getPermission(t,i)){var l=new DocOp;l.newCharacters(e.characters.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*")),r.push(l)}else r.push(e);n.next1=!1,n.next2=!0}else if(e.isDelete()){var s=Math.min(t.length(),e.length());if(t.length()==e.length())o&&!DocOpBuilder.getPermission(t,i)?e.deleteCharacters(e.delete_characters.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*")):e.deleteCharacters(e.delete_characters),r.push(e),t.length(0),n.next2=!0,n.next1=!0;else if(s==t.length()){var d=e.delete_characters.substring(0,s),c=new DocOp;o&&!DocOpBuilder.getPermission(t,i)?c.deleteCharacters(d.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*")):c.deleteCharacters(d),r.push(c),e.deleteCharacters(e.delete_characters.substring(s)),n.next1=!0,n.next2=!1}else{var c=new DocOp,p=e.delete_characters.substring(0,s);o&&!DocOpBuilder.getPermission(t,i)?c.deleteCharacters(p.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*")):c.deleteCharacters(p),r.push(c),t.length(t.length()-s),e.deleteCharacters(e.delete_characters.substring(s)),n.next1=!1,n.next2=!0}}else e.isAnnotation()&&(r.push(e),n.next1=!1,n.next2=!0)},DocOpBuilder.redactInsert=function(t,e,n,r,i){if(e.isRetain()){var o=Math.min(t.length(),e.length());if(t.length()==e.length())r.push(t),n.next1=!0,n.next2=!0;else if(o==t.length())r.push(t),e.retain_count-=o,n.next1=!0,n.next2=!1;else{var s=new DocOp;s.newCharacters(t.characters.substring(0,o)),r.push(s),t.newCharacters(t.characters.substring(o)),n.next1=!1,n.next2=!0}}else if(e.isLock()){var a=e.isRedact(),o=Math.min(t.length(),e.length());if(t.length()==e.length()){if(a&&!DocOpBuilder.getPermission(e,i)){var s=new DocOp;s.newCharacters(t.characters.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*"))}else r.push(t);n.next1=!0,n.next2=!0}else if(o==t.length()){if(a&&!DocOpBuilder.getPermission(e,i)){var s=new DocOp;s.newCharacters(t.characters.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*"))}else r.push(t);n.next1=!0,n.next2=!1}else{var l=t.characters.substring(0,o),s=new DocOp;a&&!DocOpBuilder.getPermission(e,i)&&(l=l.replace(new RegExp("[^"+CONT_REGEX_REDACT_EXCLUDE+"]","g"),"*")),s.newCharacters(l),r.push(s),t.newCharacters(t.characters.substring(o)),n.next1=!1,n.next2=!0}}},DocOpBuilder.redactAnnotation=function(t,e,n,r,i){r.push(t),n.next1=!0,n.next2=!1},DocOpBuilder.compose=function(t,e){try{var n=DocOpBuilder.clone(t).getDocOps(),r=DocOpBuilder.clone(e).getDocOps();if(0==n.length)return 0!=r.length?DocOpBuilder.clone(e):new DocOpBuilder;if(0==r.length)return DocOpBuilder.clone(t);for(var i=new DocOpBuilder,o=0,s=0,a=n[o],l=r[s],d={next1:!1,next2:!1};o<n.length||s<r.length;){if(o>=n.length&&(a=null),s>=r.length&&(l=null),a&&l)a&&0==a.length()||l&&0==l.length()?(a&&0==a.length()&&(i.push(a),d.next1=!0,d.next2=!1),l&&0==l.length()&&(i.push(l),d.next2=!0,d.next1=!1)):a&&l&&(d.next1=d.next2=!1,a.isInsert()?DocOpBuilder.composeInsert(a,l,d,i):a.isRetain()?DocOpBuilder.composeRetain(a,l,d,i):a.isDelete()?DocOpBuilder.composeDelete(a,l,d,i):a.isAnnotation()?DocOpBuilder.composeAnnotation(a,l,d,i):a.isHiddenRangeOp()?DocOpBuilder.composeHiddenRanges(a,l,d,i):a.isHiddenComposeOp()?DocOpBuilder.composeHiddenComposeOp(a,l,d,i):a.isHiddenRemoveOp()?DocOpBuilder.composeHiddenRemove(a,l,d,i):a.isHiddenRangeCharOp()?DocOpBuilder.composeHiddenRangeChar(a,l,d,i):a.isTC()?DocOpBuilder.composeChanges(a,l,d,i):a.isRemoveTC()?DocOpBuilder.composeRemoveChanges(a,l,d,i):a.isLock()&&DocOpBuilder.composeLock(a,l,d,i));else{var c=a?a:l;i.push(c),c.isLock()&&(i.isLock=!0),d[a?"next1":"next2"]=!0}d.next1&&(o++,o<n.length&&(a=n[o])),d.next2&&(s++,s<r.length&&(l=r[s]))}}catch(n){throw ZWLogger.log("docOps1: "+t.toProtoString()),ZWLogger.log("docOps2: "+e.toProtoString()),ZWLogger.log("Exception: "+n.stack),ZWLogger.log("Compose Failed @c1 = "+o+" c2 ="+s),"compose_error"}return i},DocOpBuilder.mergeLocks=function(t,e){var n=DocOp.clone(t);return n},DocOpBuilder.composeRemoveChanges=function(t,e,n,r){var i=Math.min(t.length(),e.length());DocOpBuilder.cutToEqLenAndMove(t,e,n);e.isTC()?r.skipChars(i):e.isRetain()&&r.skipChars(i)},DocOpBuilder.composeHiddenRemove=function(t,e,n,r){var i=Math.min(t.length(),e.length()),o=DocOpBuilder.cutToEqLenAndMove(t,e,n);if(e.isHiddenRangeOp())if(e.getRangeTypes()&&1===e.getRangeTypes().length)r.skipChars(i);else{var s=o.item2;s.removeRangeType(TCConstants.TC),s.applyContentStyle(t.getStyle()),r.push(s)}else(e.isRetain()||e.isHiddenRangeCharOp())&&r.skipChars(i)},DocOpBuilder.composeHiddenRangeChar=function(t,e,n,r){var i=DocOpBuilder.cutToEqLenAndMove(t,e,n);e.isRetain()?r.push(i.item1):e.isHiddenRangeCharOp()&&(e.mergeRangeTypes(t.getRangeTypes()),r.push(e),n.next1=n.next2=!0)},DocOpBuilder.composeHiddenRanges=function(t,e,n,r){if(e.isAnnotation())return r.push(e),n.next2=!0,void(n.next1=!1);var i=DocOpBuilder.cutToEqLenAndMove(t,e,n);if(e.isHiddenRangeOp())e.mergeRangeTypes(t.getRangeTypes()),r.push(i.item2);else if(e.isHiddenComposeOp()){var o="hidden"===t.getOriginAction()?i.item1:i.item2;o.mergeRangeTypes(t.getRangeTypes()),r.push(o)}else(e.isRetain()||e.isHiddenRangeCharOp())&&r.push(i.item1)},DocOpBuilder.composeHiddenComposeOp=function(t,e,n,r){if(e.isAnnotation())return r.push(e),n.next2=!0,void(n.next1=!1);var i=DocOpBuilder.cutToEqLenAndMove(t,e,n);if(e.isHiddenRangeOp()){var o="hidden"===t.getOriginAction()?i.item1:i.item2;o.mergeRangeTypes(t.getRangeTypes()),r.push(o)}else if(e.isRetain())r.push(i.item1);else if(e.isHiddenRangeCharOp()){var o=i.item1;o.mergeRangeTypes(e.getRangeTypes()),r.push(o)}},DocOpBuilder.composeChanges=function(t,e,n,r){var i=Math.min(t.length(),e.length());if(e.isAnnotation())return r.push(e),n.next2=!0,void(n.next1=!1);var o=DocOpBuilder.cutToEqLenAndMove(t,e,n);if(e.isRemoveTC())r.skipChars(i);else if(e.isTC()){var s=o.item2,s="hidden"===t.getOriginAction()?o.item1:o.item2;r.push(s)}else e.isRetain()&&r.push(o.item1)},DocOpBuilder.composeLock=function(t,e,n,r){if(!e.isLock()&&!e.isRetain())throw ZWLogger.log("Lock operation can be composed with only lock and skip operation"),new Error("Lock error in compose");var i=t.length(),o=e.length(),s=Math.min(i,o);if(e.isRetain())if(i==o)r.push(t),n.next1=!0,n.next2=!0;else if(s==i){var a=DocOp.clone(t);a.lock_data.range=i,r.push(a),e.retain_count-=s,n.next1=!0,n.next2=!1}else{var a=DocOp.clone(t);a.lock_data.range=o,r.push(a),t.length(t.length()-s),n.next1=!1,n.next2=!0}else if(e.isLock())if(e.isUnLock())r.skipChars(s),i==o?(n.next1=!0,n.next2=!0):s==i?(e.length(e.length()-s),n.next1=!0,n.next2=!1):(t.length(t.length()-s),n.next1=!1,n.next2=!0);else if(i==o)r.push(e),n.next1=!0,n.next2=!0;else if(s==i)r.push(t),e.length(e.length()-s),n.next1=!0,n.next2=!1;else{var l=DocOpBuilder.mergeLocks(t,e);r.push(l),t.length(t.length()-s),n.next1=!1,n.next2=!0}return r},DocOpBuilder.composeAnnotation=function(t,e,n,r){e.isDelete()||e.isRetain()||e.isTC()||e.isHiddenRangeOp()||e.isHiddenRangeCharOp()?(r.push(t),n.next1=!0,n.next2=!1):e.isInsert()?(r.push(e),n.next1=!1,n.next2=!0):e.isAnnotation()&&(t.isAnnotationStart()?e.isAnnotationStart()?(r.push(e),n.next2=!0,n.next1=!1):(r.push(e),n.next1=!1,n.next2=!0):(r.push(t),n.next1=!0,n.next2=!1))},DocOpBuilder.composeInsert=function(t,e,n,r){if(e.isInsert())r.push(e),n.next2=!0,n.next1=!1;else if(e.isRetain()){var i=Math.min(t.length(),e.length());if(t.length()==e.length())r.push(t),n.next2=!0,n.next1=!0;else if(i==t.length())r.push(t),e.retain_count-=i,n.next2=!1,n.next1=!0;else{var o=new DocOp;o.newCharacters(t.characters.substring(0,i)),t.hasIntegralStyles()&&(o.integralStyles=t.integralStyles),r.push(o),t.newCharacters(t.characters.substring(i)),n.next1=!1,n.next2=!0}}else if(e.isHiddenRangeCharOp()){var i=Math.min(t.length(),e.length());if(t.length()==e.length())r.push(t),n.next2=!0,n.next1=!0;else if(i==t.length())r.push(t),n.next2=!1,n.next1=!0;else{var o=new DocOp;o.newCharacters(t.characters.substring(0,i)),t.hasIntegralStyles()&&(o.integralStyles=t.integralStyles),r.push(o),t.newCharacters(t.characters.substring(i)),n.next1=!1,n.next2=!0}}else if(e.isDelete()){var i=Math.min(t.length(),e.length());t.length()==e.length()?(n.next2=!0,n.next1=!0):i==t.length()?(e.deleteCharacters(e.delete_characters.substring(i)),n.next1=!0,n.next2=!1):(t.newCharacters(t.characters.substring(i)),n.next1=!1,n.next2=!0)}else if(e.isAnnotation())r.push(e),n.next1=!1,n.next2=!0;else if(e.isHiddenRangeOp()){var s=DocOpBuilder.cutToEqLenAndMove(e,t,n);r.push(s.item1)}},DocOpBuilder.composeRetain=function(t,e,n,r){if(e.isInsert())r.push(e),n.next1=!1,n.next2=!0;else if(e.isRetain()){var i=Math.min(t.length(),e.length());e.length()==t.length()?(r.push(t),n.next1=!0,n.next2=!0):i==t.length()?(r.push(t),e.retain_count-=i,n.next1=!0,n.next2=!1):(r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0)}else if(e.isHiddenRangeCharOp()){var i=Math.min(t.length(),e.length());e.length()==t.length()?(r.push(e),n.next1=!0,n.next2=!0):i==t.length()?(r.push(t),n.next1=!0,n.next2=!1):(r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0)}else if(e.isDelete()){var i=Math.min(t.length(),e.length());if(e.length()==t.length())r.push(e),n.next1=!0,n.next2=!0;else if(i==t.length()){var o=new DocOp;o.deleteCharacters(e.delete_characters.substring(0,i)),e.hasIntegralStyles()&&(o.integralStyles=e.integralStyles),r.push(o),e.deleteCharacters(e.delete_characters.substring(i)),n.next1=!0,n.next2=!1}else r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0}else if(e.isAnnotation())r.push(e),n.next1=!1,n.next2=!0;else if(e.isHiddenRangeOp()){DocOpBuilder.composeHiddenRanges(e,t,n,r);var s=n.next1;n.next1=n.next2,n.next2=s}else if(e.isTC()){DocOpBuilder.composeChanges(e,t,n,r);var s=n.next1;n.next1=n.next2,n.next2=s}else if(e.isRemoveTC())r.skipChars(e.length()),n.next1=!1,n.next2=!0;else if(e.isLock()){var i=Math.min(t.length(),e.length());if(e.length()==t.length())e.isUnLock()?r.skipChars(i):r.push(e),n.next1=!0,n.next2=!0;else if(i==t.length()){if(e.isUnLock())r.skipChars(i);else{var a=DocOp.clone(e);a.lock_data.range=t.length(),r.push(a)}e.lock_data.range-=i,n.next1=!0,n.next2=!1}else e.isUnLock()?r.skipChars(i):r.push(e),t.retain_count-=i,n.next1=!1,n.next2=!0}},DocOpBuilder.composeDelete=function(t,e,n,r){e.isInsert()?(r.push(e),n.next2=!0,n.next1=!1):e.isDelete()?(r.push(t),n.next2=!1,n.next1=!0):e.isRetain()||e.isAnnotation()||e.isHiddenRangeCharOp()?(r.push(t),n.next1=!0,n.next2=!1):e.isTC()?DocOpBuilder.cutToEqLenAndMove(t,e,n):e.isHiddenRangeOp()&&DocOpBuilder.cutToEqLenAndMove(t,e,n)},DocOpBuilder.cleanUpUnlockOp=function(t){var e,n,r,i;for(i=new DocOpBuilder,i.isLock=!0,r=t.getDocOps(),n=r.length,e=0;e<n;e++)r[e].isUnLock()||i.push(r[e]);return i},DocOpBuilder.isSameLockDocOps=function(t,e){var n=t.lock_data.data,r=e.lock_data.data;for(var i in n)if(n[i]!=r[i])return!1;return!0},DocOpBuilder.cutToEqLenAndMove=function(t,e,n){var r=Math.min(t.length(),e.length());return n.next1=n.next2=!1,r<t.length()?t=t.cut(r):n.next1=!0,r<e.length()?e=e.cut(r):n.next2=!0,{item1:t,item2:e}},DocOpBuilder.createDocOpBuilderFromRange=function(t){var e={type:"cursor"},n=Utils.randomString(),r=[{r:t.start},{as:{start:e,id:n}},{r:t.length},{as:{end:ZWJSONUtils.getKeys(e),id:n}}];return DocOpBuilder.build(r)};var FontUtils=function(){var t=function(t,e,n){return{width:t,height:e,baseLine:n}},e=10,n=function(){return!1},r=isV8Engine||n()?" ":"&nbsp;",i=isV8Engine||n()?"‍":"&zwj;",o=(t(0,0),{}),s=[],a=[];o[ATTR_TEXT.TS_FW]="font-weight",o[ATTR_TEXT.TS_FS]="font-style",o[ATTR_TEXT.TS_FV]="font-variant",o[ATTR_TEXT.TS_TD]="text-decoration",o[ATTR_TEXT.TS_SIZE]="font-size",o[ATTR_TEXT.TS_FF]="font-family",o[ATTR_TEXT.TS_CS]="letter-spacing",o[ATTR_TEXT.TS_TT]="text-transform",o[ATTR_TEXT.TS_BGC]="background-color",s=Object.keys(o),o[ATTR_TEXT.TS_FGC]="color",a=Object.keys(o);var l,d,c,p,E=function(){if(0===s.length)for(key in o)o.hasOwnProperty(key)&&(key!=ATTR_TEXT.TS_FGC&&s.push(key),a.push(key));return function(t,e,r,i){var l,d,c,p,E,u=[],T=[];for(t=t||{},e=e||{},e=DocUtil.updateWithCharStyle(e),t=DocUtil.updateWithCharStyle(t),u=r&&i?a:s,l=0,d=u.length;l<d;l++)if(c=u[l],c==ATTR_TEXT.TS_FW&&(t[c]||t[ATTR_TEXT.TS_FW_I])?p=Math.max("bold"===t[c]?700:0,parseInt(t[ATTR_TEXT.TS_FW_I]||400)):c==ATTR_TEXT.TS_BGC?p=t[c]:c==ATTR_TEXT.TS_FF?p=Utils.fontFamilyRenderingFix(t[c]||e[c]):c!=ATTR_TEXT.TS_SIZE||!t[ATTR_TEXT.TS_VA]||"super"!=t[ATTR_TEXT.TS_VA]&&"sub"!=t[ATTR_TEXT.TS_VA]?(n()?p=t[c]||e[c]||"":(p=0,t.hasOwnProperty(c)?p=t[c]:e.hasOwnProperty(c)&&(p=e[c])),!i&&c==ATTR_TEXT.TS_CS&&p&&n()&&(p+="ls")):(p=Math.round(.7*(t[c]||e[c]||0)),t[c]||(t[c]=t[c]||e[c]||0)),p=c==ATTR_TEXT.TS_SIZE?parseFloat(p,10)+"pt":p,E=o[c],"text-decoration"!==E&&"text-transform"!==E&&"font-variant"!==E&&"font-style"!==E&&"background-color"!==E||p)if(i||!n())T.push(o[c]+":"+p);else{if("string"==typeof p&&(p=(p||"").trim(),p.indexOf("normal")!=-1||0==p.indexOf("none")||p.indexOf("underline")!=-1||p.indexOf("line-through")!=-1||0==p.indexOf("all-caps")))continue;T.push(p)}return i||!n()?T.join(";").replace(/'/g,'"'):T.join(" ").replace(/"/g,"'")}}(),u={},T={};if(!isV8Engine){var h='<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body style="font-family:Arial;"><span id="zwCharSpan" style="position:absolute;left:-50000px;top:-50000px;z-index:-50000;"><span id="zwInnerCharSpan" style="display:inline-block;"><span></span></span></span><span id="zwImgSpan" style="position:absolute;left:-50000px;top:-50000px;z-index:-50000"></span></body></html>';h+='<canvas id="zw-char-canvas"></canvas>',c=window.frames.metricsFrame.document,c.open(),c.write(h),c.close(),l=c.getElementById("zwCharSpan"),d=c.getElementById("zwInnerCharSpan"),p=c.getElementById("zw-char-canvas")}var O=function(){function t(){n=c.createElement("span"),n.id="fontDetectorSpan",n.style.fontSize="72px",n.innerHTML="mmmmmmmmmmlli",c.body.appendChild(n),i("monospace"),i("sans-serif"),i("serif")}function e(t,e){var r=n.style.fontFamily;return n.style.fontFamily="'"+t+"',"+e,r!==n.style.fontFamily}var n,r={},i=function(t){n.style.fontFamily=t,r[t]=new ZWSize(n.offsetWidth,n.offsetHeight)};return function(i){var o=/[,]/g;if(!i||isV8Engine||o.test(i))return 0;n||t();for(var s in r)if(e(i,s)&&!r[s].isEqualSize(new ZWSize(n.offsetWidth,n.offsetHeight)))return 1;return 0}}(),g={},f=function(t){var e=g[t];return e||(e=1.2*t.convertor().pixels,g[t]=e),e},_=function(r,i,o){var s=0,a=r;if(r=r.replaceAll(UNICODE.RANGE_START,""),r=r.replaceAll(UNICODE.RANGE_END,""),n()){var l,E,u,T,h,O,g,_=0;O=i.split(" ")||[],i.indexOf("ls")!=-1?(g=O[O.length-1]||"0pt",g=g.replace(/ls/g,""),i.indexOf("ls")!=-1&&(_=g.convertor().pixels*r.length),O.pop()):p.style.letterSpacing="";var R=D(O);E=parseFloat(O[R])||11,O[R]=E*e+"pt",i=O.join(" "),i.indexOf("uppercase")!=-1&&(r=r.toUpperCase(),i=i.replace(/uppercase/gi,"")),u=p.getContext("2d"),u.font=i,l="\f"==r?0:u.measureText(r).width/e+_,T=1.2*(E+"pt").convertor().pixels,h=t(l,T,s),o&&(o[a]=h)}else{d=d||c.getElementById("zwInnerCharSpan"),d.children[0].setAttribute("style",i),d.children[0].innerHTML=r;var T,A=d.getBoundingClientRect();try{var I=i.split(/font-size\s*:\s*/)[1];T=I?f(I.split(";")[0]):A.height}catch(t){T=A.height}var h=t(A.width,T,s);o&&(o[a]=h)}return h},R=function(t,e,n){_(t,e,n)},A=function(t){return u[t]={},R(r,t,u[t]),u[t][" "]=u[t][r],R(UNICODE.MULTIBYTE_SPACE,t,u[t]),u[t]},I=function(t,e){var n=u[e]||A(e);return n[t]||R(t,e,n),n[t]},D=function(t){var e,n=t.length;for(e=0;e<n&&(!t[e]||t[e].indexOf("pt")==-1);e++);return e},S=function(){var t=[],e=[],r={},o=-1,s=-1,a=0,d=!1,c=function(i,a,l){o<0&&(o=a,r["#"+a+"#"]=l),t.length&&ZWArrayUtils.lastElementOf(t)==l||(t.push(l),r["#"+a+"#"]=l,e.push([])),n()?ZWArrayUtils.lastElementOf(e).push(i):ZWArrayUtils.lastElementOf(e).push(Utils.encodeHTMLChars(i)),s=a+1},p=function(){t.splice(0,t.length),e.splice(0,e.length),r={},a=0,o=s=-1},E=function(n,a){for(var c="#",p="",E="",u=t.length,O="",g=0;g<u;g++)O+=e[g].join("");if(isV8Engine||(O=O.replaceAll("&nbsp;"," ")),d=!!Utils.isArabic(O),u>1){for(var g=0;g<u;g++)E=e[g].join(""),d&&g!=u-1&&(E+=i),c+=E,p+=t[g]+" "+E+"; ";c+="#"}else p=t[0],c+=e[0].join(""),c+="#";var f=null;T[p]?f=ZWJSONUtils.clone(T[p][c]):T[p]={},f?a.isMetricsFilled=!0:(isV8Engine?f={height:0,width:0,baseLine:0}:(f=h(),T[p][c]=f),a.isMetricsFilled=!1);var _=f.width,R=f.height,A=f.baseLine;return isV8Engine||0!=_||l.parentNode&&l.parentNode.parentNode||PubSub.publish("Document/Error",{title:"OOPS",errorNo:ZWCollaboration.FONT_METRICS_ERROR,errorMsg:"MSG_EDIT_ERROR"}),new LineBlock(o,s,O,_,R,A,JSON.parse(JSON.stringify(r)),JSON.parse(JSON.stringify(n)),a.displayStyle,a.isSpecialBlock,a.isMetricsFilled,a.type,a.isNonEditableBlock,a.renderingFormat,a.types,a.parent)},u=function(){return o>=0?o:null},h=function(){var n,r=t.length,o={},s=0,a=0,l=0,c="";for(n=0;n<r;n++)c=e[n].join(""),o=c===UNICODE.RANGE_START||c===UNICODE.RANGE_END?{width:0,height:0,baseLine:0}:d&&n!=r-1?_(c+i,t[n]):_(c,t[n]),a+=o.width,s=Math.max(s,o.height),l=o.baseLine;return o={},o.height=s,o.width=a,o.baseLine=l,o},O=function(){return s-o==0};return{addChar:c,getBlock:E,start:u,isEmpty:O,clear:p,calculateMetrics:h}},C=function(t,e){return JSON.stringify(editor.doc.getContent(t||0,e||editor.doc.getDocumentLength()))},L=1,N=function(t){null==t||t.version&&t.version==L||(t={}),T=t||{}},y=function(){return null==T||T.version&&T.version==L||(T.version=L),T},m=function(){u={},T={}},v=function(t){var e=[];return U.each(t&&("string"==typeof t&&t.split(/[\s]*,[\s]*/g)||(t.length?t:[])),function(t){t&&!e.contains(t)&&e.push(t)}),e},P={},F=function(t,e){var n=t.toLowerCase(),r=FCWebFontsInfo.fonts[n],i=/(ttf|otf)/i;if(r&&!P.hasOwnProperty(n)){"string"==typeof r&&(t=r,r=FCWebFontsInfo.fonts[r]);var o,s,a,l,d={family:t,type:FCWebFontsInfo.types[r[0]],variants:{}},c=t.toLowerCase().replace(/( |_)*/g,"");for(o in r)if(0!==(o=parseInt(o))){s=o>10,a=r[o],l=editorProps.urls.webFontsURL+"/"+(isNaN(a)?a:c+(FCWebFontsInfo.variants[a]||""))+"/font";var p={urls:{woff2:l+".woff2",woff:l+".woff"},previewUrls:{woff2:l+"_preview.woff2",woff:l+"_preview.woff"}};i.test(e)&&(p.urls[e]=l+"."+e,p.previewUrls[e]=l+"_preview."+e),d.variants[100*(s?Math.floor(o/10):o)+(s?"i":"")]=p}else d.type=FCWebFontsInfo.types[r[o]];P[n]=new ZWWebFont(d)}return P[n]},x=function(e){for(var n,r,i,o,s="",a="",l=FontUtils.getWordMetrics(),d=function(t,e){return t-e},c=0,p=e.length;c<p;c++)if(r=e[c],s="",a="",i=r.fontStringObj,!U.isEmpty(i)){var E=Object.keys(i);if(E.length>1){var u=[];for(var T in i)u.push(T.split("#")[1]);u.sort(d);for(var h=0;h<u.length;h++){if(T="#"+u[h]+"#",s+=i[T],o=u[h+1]||r.start+r.content.length,a=r.content.slice(u[h]-r.start,o-r.start),!a.trim().length){var O=a.length;for(a="";O>0;)a+=" ",O--}s+=" "+a+"; "}}else s=i["#"+r.start+"#"];n="#"+r.content+"#",l[s][n]=t(r.width,r.height,r.baseLine)}},b=function(){var t=editor.doc.docInfo;return{metrics:y(),rid:t.RID,versionId:t.VERSION_ID}};(function(){editorProps.font_metrics&&N(editorProps.font_metrics)})();return{getFontString:E,getCharSize:I,isFontAvailableInSystem:O,isCanvasSupported:n,getWord:S,setFontMetrics:N,getWordMetrics:y,contentBetween:C,clearAllMetrics:m,SPACE_CHAR:r,ZERO_WID_JOINER:i,stringToFonts:v,getWebFont:F,setWordMetrics:x,getMetricsInfo:b}}(),DTNode=function(){"use strict";function t(t,e,n){for(this.start=t,this.end=e,this.parent=n,this.next=null,this.prev=null,this.children=[],this.id="node_"+("x"+Math.random()).replace(/\D/g,"");n.parent;)n=n.parent;this.section=n,this.section.nodes[this.id]=this,this.parentSetToRemove=!1}return t.prototype.constructor=t,extend(t.prototype,{getId:function(){return this.id},getChildNodes:function(){return this.children},getContent:function(){return editor.doc.getContent(this.getIndex(),this.getEndIndex()+1)},getFirstChild:function(){return t.prototype.firstChild.call(this)},getSection:function(){return this.section},getFormat:function(){return this.format},getLastChild:function(){return t.prototype.lastChild.call(this)},getNextSibling:function(){return this.next},getNodeRange:function(){return new ZRange(this.getIndex(),this.getEndIndex())},getType:function(){return this.type},getOps:function(){var t,e=[],n={};if(this.hasChildNodes()){this.type!==NODE_TYPE.PARA&&(n=this.getFormat(),t=Utils.randomString(),e.push({as:{start:n,id:t}}),e.push({is:UNICODE[this.type.toUpperCase()]}),e.push({as:{end:ZWJSONUtils.getKeys(n),id:t}}));for(var r=this.getFirstChild();r;)e=e.concat(r.getOps()),r=r.getNextSibling();this.type===NODE_TYPE.PARA&&(n=this.getFormat(),t=Utils.randomString(),e.push({as:{start:n,id:t}}),e.push({is:UNICODE.PARA}),e.push({as:{end:ZWJSONUtils.getKeys(n),id:t}}))}else n=this.getFormat(),t=Utils.randomString(),e.push({as:{start:n,id:t}}),e.push({is:this.getContent()}),e.push({as:{end:ZWJSONUtils.getKeys(n),id:t}});return e},getParent:function(t){if(!t)return this.parent;for(var e=this.parent;e&&e.type!==NODE_TYPE.SECTION;){if(e.isNodeType(t))return e;e=e.parent}return null},getParents:function(t){for(var e=[],n=this.parent;n&&n.type!==NODE_TYPE.SECTION;)t?n.isNodeType(t)&&e.push(n):e.push(n),n=n.parent;return e},getPreviousSibling:function(){return this.prev},isNodeType:function(t){return this.type===t},hasChildNodes:function(){return!!this.children.length},firstChild:function(){if(this.children.length)return this.children[0]},lastChild:function(){var t=this.children.length;if(t)return this.children[t-1]},setParentRemoveStatus:function(t){this.parentSetToRemove=t,this.setParentRemoveStatusToChildren(t)},setParentRemoveStatusToChildren:function(t){for(var e=0;e<this.children.length;e++)this.children[e].setParentRemoveStatus(t)},isParentSetToRemove:function(){return this.parentSetToRemove},updateIndex:function(t){this.start+=t,this.end+=t},getIndex:function(){return this.parent.getIndex()+this.start},getEndIndex:function(){return this.parent.getIndex()+this.end-1},addChild:function(t){var e=this.children,n=e[e.length-1]||null;t.prev=n,n&&(n.next=t),e.push(t)},addChildAt:function(t,e){var n=this.children,r=n[e-1]||null,i=n[e]||null;t.prev=r,t.next=i,r&&(r.next=t),i&&(i.prev=t),this.children.splice(e,0,t)},getChildIndex:function(){var t=-1,e=this;if(!e)return t;for(t=0;e=e.prev;)t++;return t},contains:function(t){return this.getIndex()<=t.getIndex()&&t.getEndIndex()<=this.getEndIndex()},deleteChildAt:function(t){var e=this.children,n=e[t],r=n.prev||null,i=n.next||null;r&&(r.next=i),i&&(i.prev=r),this.children.splice(t,1)},updateNode:function(t,e,n){if(this.type===NODE_TYPE.PARA){this.updateProperties();var r=this.getEndIndex()>e?e:this.getEndIndex();this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update",t,r,"as",n)),this.buildSegments()}else this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update"))},create:function(){},remove:function(){for(var t=this.children,e=0;e<t.length;e++)t[e].type===NODE_TYPE.PARA&&PubSub.publish("Document/NodeRemoved",t[e]),t[e].remove();this.section.updateTableNodes(this,"remove")},destroy:function(){this.prev=this.next=this.parent=null,delete this.section.nodes[this.id]},update:function(){},getChildNodesArray:function(t){for(var e,n=[],r=0;r<this.children.length;r++)e=this.children[r],t&&(n=n.concat(e.getChildNodesArray(t))),n.push(e);return n},getParasWithChart:function(){for(var t,e=this.getChildNodes(),n=e.length,r=[],i=0;i<n;i++){t=e[i];var o=t.getParasWithChart();o.length&&Array.prototype.push.apply(r,o)}return r},splitRangeBasedOnChildren:function(t,e,n){for(var r=this.getIndex(),i=[],o=t-r,s=e-r,a=0,l=0,d=this.children,c=0;c<d.length;c++){var p=d[c];if(o>s)break;if(o>=p.start&&o<p.end){if(!(s>p.end)){l=a+(s-o),i.push({from:o+r-a,to:s+r-a,str:n.slice(a,l)});break}l=a+(p.end-o),i.push({from:o+r-a,to:p.end+r-a,str:n.slice(a,l)}),a=l,o=p.end}}return i},getChildrenLength:function(){return this.children.length||0},getFirstChildNodeOfGivenType:function(t){for(var e=this.getFirstChild();e;){if(e.getType()===t)return e;if(e.getChildrenLength()){var n=e.getFirstChildNodeOfGivenType(t);if(null!==n)return n}e=e.next}return null}}),t.types={},t}();!function(){"use strict";function t(t,e,n){DTNode.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.RUN}t.prototype=Object.create(DTNode.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.RUN]=t}();var DTRun=DTNode.types[NODE_TYPE.RUN];!function(){"use strict";function t(t,e,n){DTRun.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.TEXT}t.prototype=Object.create(DTRun.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.TEXT]=t}(),function(){"use strict";function t(t,e,n){DTRun.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.CONDITIONAL_ELSE_SEPARATOR}t.prototype=Object.create(DTRun.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.CONDITIONAL_ELSE_SEPARATOR]=t}(),function(){"use strict";function t(t,e,n){DTRun.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.TAB}t.prototype=Object.create(DTRun.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.TAB]=t}(),function(){"use strict";function t(t,e,n){DTRun.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.BR}t.prototype=Object.create(DTRun.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.BR]=t}(),function(){"use strict";function t(t,e,n){DTRun.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.IMAGE}t.prototype=Object.create(DTRun.prototype),t.prototype.constructor=t,DTNode.types[NODE_TYPE.IMAGE]=t}(),function(){"use strict";function t(t,e,n){DTNode.call(this,t,e,n);var r=editor.doc.getRawFormatAt(this.getIndex());r&&(this.format=r,this.merge=r.merge,this.rspan=r.rspan,this.cspan=r.cspan),this.type=NODE_TYPE.CELL,this.borderProperties={}}t.prototype=Object.create(DTNode.prototype),t.prototype.constructor=t,extend(t.prototype,{addToCell:function(t,e){var n,r,i,o,s,a,l,d,c=this.children,p=this.getIndex();for(d=t,this.end+=e-t,s=c.length-1;s>=0&&(n=c[s],o=s,!(t>=n.start+p));s-=1)n.updateIndex(e-t);if(n){if(n.type===NODE_TYPE.TABLE&&t>n.start+p)return void n.addToTable(t,e,d);if(n.type==NODE_TYPE.TOC&&t>n.start+p)return void n.addToToc(t,e,d);n.type!==NODE_TYPE.PARA&&t===n.start+p&&n.updateIndex(e-t),t==n.end+p?(n.type==NODE_TYPE.PARA&&(n.start=getStart(UNICODE.PARA,n.start+p)-p,n.end=getEnd(UNICODE.PARA,n.start+p)-p),l=DTUtils.makeOp(n,"modify"),this.section.nodesToUpdate.push(l.node.id,l),o++):n.type==NODE_TYPE.PARA&&(t=n.start+p,n.start=getStart(UNICODE.PARA,e)-p,n.end=getEnd(UNICODE.PARA,e)-p,l=DTUtils.makeOp(n,"modify",d,e,"is"))}if(n||o||(o=0),!this.isCellContainesImage&&!this.isCellContainesTable){var E=TableUtil.isRangeContainsImage(t,e),u=TableUtil.isRangeContainsTable(t,e);(E||u)&&this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update"))}var T=!1;for(s=t;s<e;)a=editor.doc.getCharAt(s),DTNode.types[a]?(a==UNICODE.PARA?(r=getStart(UNICODE.PARA,s)-p,i=getEnd(UNICODE.PARA,s)-p):a!=UNICODE.TABLE&&a!=UNICODE.HR&&a!=UNICODE.TOCSTART||(r=s-p,i=getEnd(a,s)-p),n=a==UNICODE.TABLE||a==UNICODE.TOCSTART?new DTNode.types[a](r,r+2,this):new DTNode.types[a](r,i,this),this.section.nodesToUpdate.push(n.id,DTUtils.makeOp(n,"create")),T=!0,this.addChildAt(n,o),n.updateProperties(),"para"==n.type?n.buildSegments():"table"==n.type?n.addToTable(r+p+1,i+p-1):a==UNICODE.TOCSTART&&n.addToToc(r+p+1,i+p-1),o++,s=p+n.end):s+=1;if(l){"para"==l.node.type&&l.node.buildSegments();var h=l.node;T&&!isNaN(l.contentIndex)&&h.type===NODE_TYPE.PARA&&(editor.doc.getCharAt(l.contentIndex)===UNICODE.PARA?(l.contentIndex=null,l.endIndex=null,l.type=null):l.contentIndex=h.getIndex()>l.contentIndex?h.getIndex():l.contentIndex),this.section.nodesToUpdate.push(h.id,l)}},deleteFromCell:function(t,e,n,r){var i,o,s,a=this.children,l=!1,d=this.getIndex(),c=e;for(this.end-=e-t,n.indexOf(UNICODE.IMAGE)==-1&&n.indexOf(UNICODE.TABLE)==-1||this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update")),s=0;s<a.length;s++){if(i=a[s],o=s,i.start+d>t){o=s-1,i=i.prev||i;break}if("para"!=i.type&&i.start+d==t)break}if("table"==i.type&&i.start+d!=t)i.deleteFromTable(t,e,n,r);else if(i.type==NODE_TYPE.TOC&&i.start+d!=t)i.deleteFromToc(t,e,n,r);else{for(;i&&i.end+d<=e;)c-=i.getEndIndex()-i.getIndex()+1,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"remove")),this.deleteChildAt(o),i=i.next;var p=i;i&&(i.type==NODE_TYPE.PARA?(i.end=getEnd(UNICODE.PARA,t)-d,i.start=getStart(UNICODE.PARA,t)-d,n===UNICODE.PARA?this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"update")):(l=!0,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"modify",r,c,"ds")))):this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"update")))}for(s=a.length-1;s>=0&&(i=a[s],!(t>=i.start+d));s-=1)i.updateIndex(t-e);p&&(p.updateProperties(l),"para"==p.type&&p.buildSegments())},updateNode:function(t,e,n){var r,i,o,s,a,l=this.children,d=this.getIndex();if((d==t||d==e-1)&&(this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update")),e-t==1||d==e-1)){for(o=0;o<l.length;o++)this.section.nodesToUpdate.push(l[o].id,DTUtils.makeOp(l[o],"update"));return void(editor.browserInfo.is_firefox&&(a=this.parent.parent,this.section.nodesToUpdate.push(a.id,DTUtils.makeOp(a,"adjustBorder"))))}for(o=l.length-1;o>=0&&(r=l[o],i=o,!(t>=r.start+d));o-=1);if(e<d+r.end)return void r.updateNode(t,e,n);var c;for(r.type!=NODE_TYPE.PARA?(r.updateNode(r.start+d,r.end+d,n),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update"))):(r.updateProperties(),c=r.getEndIndex()>e?e:r.getEndIndex(),editor.doc.getCharAt(t)===UNICODE.PARA||editor.doc.getContent(t,e)===UNICODE.PARA?this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")):this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update",t,c,"as",n)),r.buildSegments()),o=r.end+d;o<e;)s=editor.doc.getCharAt(o),DTNode.types[s]?s!=UNICODE.PARA&&s!=UNICODE.TABLE&&s!=UNICODE.HR&&s!=UNICODE.TOCSTART||(r=r.next,r.type!=NODE_TYPE.PARA?r.updateNode(r.start+d,Math.min(r.end+d,e)):r.buildSegments(),r.updateProperties(),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+d):(r.updateProperties(),r=r.next,r.type===NODE_TYPE.PARA?(c=r.getEndIndex()>e?e:r.getEndIndex(),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update",r.getIndex(),c,"as",n)),r.buildSegments()):this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+d)},getCellWidth:function(){return DTTableUtils.getCellWidth(this)},updateProperties:function(){var t=editor.doc.getThemeStyleFormatAt(this.getIndex()),e=t[ATTR_CELL.TDS_MRG];this.matrixPosition=this.getMatrixPosition(),this.merge=e,this.isVisible=!e||"fc"===e,this.rspan="fc"==e?t[ATTR_CELL.TDS_RSPAN]||1:void 0,this.cspan="fc"==e?t[ATTR_CELL.TDS_CSPAN]||1:void 0,this.borderProperties=DTUtils.getBorderSize(t,this),this.isCellContainesImage=TableUtil.isRangeContainsImage(this.getIndex(),this.getEndIndex()),this.isCellContainesTable=TableUtil.isRangeContainsTable(this.getIndex(),this.getEndIndex()),this.cellPadding=DocUtil.getCellPadding(t),this.format=editor.doc.getRawFormatAt(this.getIndex())},create:function(){this.updateProperties(),this.section.updateTableNodes(this,"add"),PubSub.publish("Cell/Create",this.format)},update:function(){this.updateProperties(),this.section.updateTableNodes(this,"update"),PubSub.publish("Cell/Update",this.format)},getBorderStyle:function(){return this.format&&this.format.borders},getMatrixPosition:function(){return[this.parent.getChildIndex(),this.getChildIndex()]},getRootMergeCell:function(){var t=null,e=this,n=e.parent,r=e.getChildIndex();if("vmp"==e.merge)for(n=n&&n.prev;n;){if(e=n.children[r],e&&"fc"==e.merge){t=e;break}if(!e||"vmp"!=e.merge)break;n=n.prev}else if("hmp"==e.merge)for(e=e.prev;e;){if("hmp"!=e.merge){if("vmp"==e.merge){t=e.getRootMergeCell();break}if("fc"==e.merge){t=e;break}break}e=e.prev}else"fc"==e.merge&&(t=e);return t},getMergeCells:function(){if("fc"!==this.merge)return[];for(var t=this,e=t.parent,n=e.parent,r=t.getMatrixPosition(),i=r[0],o=r[1],s=i+t.rspan-1,a=o+t.cspan-1,l=[],d=i;d<=s;d++){e=n.children[d];for(var c=o;c<=a;c++)t=e.children[c],l.push(t)}return l},getLastVmpCell:function(){if("fc"==this.merge){var t=this.parent&&this.parent.parent,e=this.getChildIndex(),n=this.parent.getChildIndex(),r=this.rspan-1,i=t&&t.getChildNodes()[n+r];return i&&i.getChildNodes()[e]}},getTable:function(){return this.parent.parent},isContainsFormula:function(){for(var t=this.children,e=t.length,n=0;n<e;n++)if(t[n].isContainsFormula())return!0;return!1},getChildrenWithFormula:function(){for(var t=this.children,e=t.length,n=0;n<e;n++)if(t[n].isContainsFormula())return t[n]},getMergeType:function(){return this.merge||CELL_MERGE_TYPE.NONE},getRowSpan:function(){return this.rspan},getColSpan:function(){return this.cspan},getBorderProperties:function(t){return t?this.borderProperties[t]:this.borderProperties},getCellPadding:function(){return this.cellPadding},getVerticalAlign:function(){return this.format[ATTR_CELL.TDS_VA]||""},getBackgroundColor:function(){return this.format[ATTR_CELL.Z_TD_BGC]||null},getBackgroundImage:function(){return this.format[ATTR_CELL.TDS_BGIMG]||null},isEmpty:function(){return this.end-this.start<=2}}),DTNode.types[UNICODE.CELL]=t}(),function(){"use strict";function t(t,e,n){DTNode.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.ROW,this.minRowHeight=0,this.hasEqualHtChildren=!0;var r=this.start,i=this.end,o=this.parent.getIndex();o+this.start;r+=o,i+=o}t.prototype=Object.create(DTNode.prototype),t.prototype.constructor=t,extend(t.prototype,{isHeaderRow:function(){return this.parent&&parseInt(this.parent.format.theader||0)>0&&!this.prev},addToRow:function(t,e,n){var r,i,o,s,a,l,d,c=this.children,p=-1,E=this.getIndex(),u=!1;for(this.end+=e-t,d=editor.doc.getCharAt(t),s=c.length-1;s>=0;s--){if(r=c[s],d==UNICODE.CELL&&t==E+r.end){p=s,u=!0;break}if(t>r.start+E){r.addToCell(t,e,n);break}r.updateIndex(e-t)}if(u||t==E+1&&d==UNICODE.CELL){for(a=t;a<e;){l=editor.doc.getCharAt(a),i=a-E,o=getEnd(UNICODE.CELL,a)-E,r=new DTNode.types[UNICODE.CELL](i,i+1,this),this.addChildAt(r,++p),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"create")),r.addToCell(i+E+1,o+E);for(var T=c.length,h=0;h<T;h++)c[h].updateNode(c[h].getIndex(),c[h].getIndex()+1);a=E+r.end}editor.browserInfo.is_firefox&&this.section.nodesToUpdate.push(this.parent.id,DTUtils.makeOp(this.parent,"adjustBorder"))}},deleteFromRow:function(t,e,n,r){var i,o,s,a,l,d=this.children,c=this.getIndex(),p=n.charAt(0);for(this.end-=e-t,s=d.length-1;s>=0;s--){if(i=d[s],i.start+c==t&&p==UNICODE.CELL){for(o=s,a=t;a<e;)l=n.charAt(a-t),i=d[o],a+=i.end-i.start,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"remove")),this.deleteChildAt(o);editor.browserInfo.is_firefox&&this.section.nodesToUpdate.push(this.parent.id,DTUtils.makeOp(this.parent,"adjustBorder"));break}if(t>i.start+c){i.deleteFromCell(t,e,n,r);break}i.start+c>=e&&i.updateIndex(t-e)}if(p==UNICODE.CELL){var s,E=d.length;for(s=0;s<E;s++)d[s].updateNode(d[s].getIndex(),d[s].getIndex()+1)}},updateNode:function(t,e,n){var r,i,o,s,a,l=this.children,d=this.getIndex();if(this.type===NODE_TYPE.PARA?this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update",t,e,"as")):this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update")),d!=t||(editor.doc.getCharAt(this.getIndex()-1)==UNICODE.TABLE&&(this.parent.containsHeaderRow=this.format&&this.isHeaderRow()),e-t!=1)){for(o=l.length-1;o>=0&&(r=l[o],i=o,!(t>=r.start+d));o-=1);if(e<=d+r.end)return void r.updateNode(t,e,n);for(r.updateNode(r.start+d,r.end+d,n),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+d;o<e;)r=r.next,r.updateNode(r.start+d,Math.min(r.end+d,e)),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+d}else{var c=this.parent.fullRerender;if(c)for(o=0,a=l.length;o<a;o++)l[o].updateNode(l[o].getIndex(),l[o].getIndex()+1);else{var p=this.parent.affectedCols;if(p.length>0)for(o=0,a=l.length;o<a;o++)if(null!=p[o])if("hmp"==l[o].merge)for(var s=o;s>0;){if(s--,"fc"==l[s].merge){l[s].updateNode(l[s].getIndex(),l[s].getIndex()+1,n);break}if("vmp"==l[s].merge)break}else{if("vmp"==l[o].merge)continue;l[o].updateNode(l[o].getIndex(),l[o].getIndex()+1,n)}}}},computeMinHeight:function(){if(this.hasEqualHtChildren=!0,this.children.length){var t=this.children[0],e=t.getFormat();this.minRowHeight=e.ht?e.ht.convertor().pixels:0;for(var n=1;n<this.children.length;n++){t=this.children[n];var e=t.getFormat(),r=e.ht?e.ht.convertor().pixels:0;this.minRowHeight!==r&&(this.minRowHeight=Math.max(r,this.minRowHeight),this.hasEqualHtChildren=!1)}}},getMinHeight:function(){return this.minRowHeight},updateProperties:function(){this.format=editor.doc.getRawFormatAt(this.getIndex()),this.computeMinHeight()},create:function(){this.updateProperties(),this.section.updateTableNodes(this,"add")},update:function(){this.updateProperties(),this.section.updateTableNodes(this,"update")},containsMultiRowMergeCell:function(){for(var t,e=this.children,n=0;n<e.length;n++)if(t=e[n],"fc"==t.merge&&t.rspan>1)return!0;return!1},isRowHeightRuleExact:function(){return!!this.format.htRule&&this.format.htRule===ROW_HEIGHT_RULE.EXACT},isRowHeightRuleAtleast:function(){return this.format.ht===ROW_HEIGHT_RULE.AUTO&&this.hasEqualHtChildren},cantSplit:function(){return this.format.cantsplit||!1},getFirstCell:function(){return this.children[0]},isVerticalMergedRow:function(){for(var t,e=this.children,n=0;n<e.length;n++)if(t=e[n],"fc"==t.merge&&t.rspan>1||"vmp"==t.merge)return!0;return!1},isEmpty:function(t){if(t&&t.ignoreHeaderRow&&this.isHeaderRow())return!0;for(var e,n=this.children,r=0;r<n.length;r++)if(e=n[r],!e.isEmpty())return!1;return!0}}),DTNode.types[UNICODE.ROW]=t}(),function(t){"use strict";function e(t,e,n){DTNode.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.containsHeaderRow=parseInt(this.format.theader)>0,this.type=NODE_TYPE.TABLE,this.theme={},this.fullRerender=!1,this.borderProperties={}}e.prototype=Object.create(DTNode.prototype),e.prototype.constructor=e,extend(e.prototype,{addToTable:function(t,e,n){var r,i,o,s,a,l,d,c=this.children,p=-1,E=this.getIndex(),u=!1;for(this.end+=e-t,d=editor.doc.getCharAt(t),s=c.length-1;s>=0;s--){if(r=c[s],d==UNICODE.ROW&&t==r.end+E){p=s,u=!0;break}if(t>r.start+E){r.addToRow(t,e,n);break}r.updateIndex(e-t)}if(u||t==E+1&&d==UNICODE.ROW){for(a=t;a<e;)l=editor.doc.getCharAt(a),i=a-E,o=getEnd(UNICODE.ROW,a)-E,r=new DTNode.types[UNICODE.ROW](i,i+1,this),this.addChildAt(r,++p),r.addToRow(i+E+1,o+E),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"create")),a=E+r.end;editor.browserInfo.is_firefox&&this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"adjustBorder"))}},deleteFromTable:function(t,e,n,r){var i,o,s,a,l,d=this.children,c=this.getIndex();this.end-=e-t;for(var p=this.splitRangeBasedOnChildren(t,e,n),E=0;E<p.length;E++){var u=p[E].str.charAt(0);for(s=d.length-1;s>=0;s--){if(i=d[s],i.start+c==p[E].from&&u===UNICODE.ROW){for(o=s,a=p[E].from;a<p[E].to;)l=p[E].str.charAt(a-p[E].from),i=d[o],a+=i.end-i.start,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"remove")),this.deleteChildAt(o);editor.browserInfo.is_firefox&&this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"adjustBorder"));break}if(p[E].from>i.start+c){i.deleteFromRow(p[E].from,p[E].to,p[E].str,r);break}i.end+c>p[E].to&&i.updateIndex(p[E].from-p[E].to)}}},updateNode:function(t,e,n){var r,i,o,s=this.children,a=this.getIndex();if(a!=t||(this.updateProperties(),this.section.nodesToUpdate.push(this.id,DTUtils.makeOp(this,"update")),e-t!=1)){for(o=s.length-1;o>=0&&(r=s[o],i=o,!(t>=r.start+a));o-=1);if(e<=a+r.end)return void r.updateNode(t,e,n);for(r.updateNode(r.start+a,r.end+a,n),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+a;o<e;)r=r.next,r?(r.updateNode(r.start+a,Math.min(r.end+a,e)),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+a):o++}else for(o=0;o<s.length;o++)s[o].updateNode(s[o].getIndex(),s[o].getIndex()+1,n)},getWidthFromParent:function(){return"cell "==this.parent.type?this.parent.getCellWidth():DocLayoutManager.getContentWidthAtIndex(this.getIndex())},updateTableWidthInPercentage:function(){var t=this.format[ATTR_TABLE.TBLS_WID]||"";this.isTableWidthInPercentage=t.indexOf(UNITS.PERCENTAGE)!==-1},isTableColsWidthInPercentage:function(){var t=this.getCols();return t[0].wt.indexOf(UNITS.PERCENTAGE)!==-1},updateFormat:function(){this.format=editor.doc.getRawFormatAt(this.getIndex())},updateBorderProperties:function(){this.borderProperties=DTUtils.getBorderSize(this.getFormat())},updateTableTheme:function(){this.theme=this.getFormat()[ATTR_TABLE.TBLS_THEME]},updateCols:function(){var t=this.getFormat()[ATTR_TABLE.TBLS_COLS];t&&this.getFormat()[ATTR_TABLE.TBLS_VER]&&"4.0"===this.getFormat()[ATTR_TABLE.TBLS_VER]?this.cols=t:this.cols=this.createCols()},getCols:function(){return this.cols},getFormat:function(){return this.format},getTableWidth:function(){return this.getFormat()[ATTR_TABLE.TBLS_WID]},getTableAlign:function(){return this.getFormat()[ATTR_TABLE.TBLS_AL]},getTableMarginLeft:function(){return this.getFormat()[ATTR_TABLE.TBLS_ML]},updateProperties:function(){this.updateFormat(),this.updateBorderProperties(),this.affectedCols=[],this.updateTableTheme(),this.updateTableWidthInPercentage(),this.fullRerender=!0,this.updateCols()},create:function(){this.updateProperties(),this.section.updateTableNodes(this,"add"),PubSub.publish("Table/Create",this.format)},update:function(){this.updateProperties(),this.section.updateTableNodes(this,"update"),PubSub.publish("Table/Update",this.format)},adjustBorder:function(){},getRootMergeCells:function(){var t,e,n,r,i=0,o=0,s=[];for(e=this.children.length;i<e;i++)for(t=this.children[i],o=0,r=t.children.length;o<r;o++)n=t.children[o],(n.rspan||n.cspan)&&s.push(n);return s},createCols:function(){for(var t,e,n=this.getIndex(),r=n+1,i=getEnd(UNICODE.TABLE,n+1),o=0,s=-1,a=-1,l=0,d=[],c=r;c<i;c++)if(t=editor.doc.getCharAt(c),t===UNICODE.TABLE){if(e=getEnd(t,c+1),e===-1)break;c=e+1}else if(t===UNICODE.ROW){if(o===s){l=a;break}a++,o=0,d.splice(0,d.length),s=0}else if(t===UNICODE.CELL){s++;var p=DocTreeManager.doc.getComputedFormatAt(c,NODE_TYPE.CELL);d.push(p),p.merge||o++}var E=d.length,u=[],T=[],h=[],O=0,g="5%";for(c=0;c<E;c++){var f=d[c],_=f[ATTR_CELL.TDS_WID];if(!_||"number"==typeof _)return this.getColsForGivenLength(E);T.push(_),(this.isTableWidthInPercentage&&_.indexOf("%")!=-1||!this.isTableWidthInPercentage&&_.indexOf("%")==-1)&&O++}if(E==O)h=T;else{var R=(DocLayoutManager.getContentWidthAtIndex(this.getIndex())/Conversions.globalUnitInPx).toFixed(3)+Conversions.globalUnit;if(this.isTableWidthInPercentage){var A=parseFloat(this.format[ATTR_TABLE.TBLS_WID])*parseFloat(R)/100;for(c=0;c<E;c++)T[c].indexOf("%")!=-1?h.push(T[c]):h.push(Conversions.toGlobalUnit(T[c])/parseFloat(A)*100+UNITS.PERCENTAGE)}else{var A;for(A=this.format[ATTR_TABLE.TBLS_WID]?parseFloat(Conversions.toGlobalUnit(this.format[ATTR_TABLE.TBLS_WID])):parseFloat(R),c=0;c<E;c++)T[c].indexOf("%")==-1?h.push(T[c]):h.push(parseFloat(T[c])/100*parseFloat(A)+Conversions.globalUnit)}}for(c=0;c<E;c++){var f=d[c],_=h[c];if(!f.cspan||f.cspan<=1){_||(_=this.isTableWidthInPercentage?g:Conversions.toGlobalValue(20+UNITS.PIXELS));var I={wt:_};u.push(I)}else{var D=f.cspan;_||(_=this.isTableWidthInPercentage?parseFloat(g)*D+UNITS.PERCENTAGE:Conversions.toGlobalValue(20*D+UNITS.PIXELS)),_=_&&_.indexOf(UNITS.PERCENTAGE)==-1?Conversions.toGlobalValue(Conversions.toPixels(_)/D+UNITS.PIXELS):parseFloat(_)/D+UNITS.PERCENTAGE;for(var S=0;S<D;S++){var I={wt:_};u.push(I)}c+=D-1}}return u},getColsForGivenLength:function(t){for(var e=(DocLayoutManager.getContentWidthAtIndex(this.getIndex())/Conversions.globalUnitInPx).toFixed(3)+Conversions.globalUnit,n=parseFloat(e)/parseInt(t),r=[],i=0;i<t;i++){var o={wt:n+Conversions.globalUnit};r.push(o)}return r},isVerticalMergePresent:function(){var t,e,n,r,i=0,o=0;for(e=this.children.length;i<e;i++)for(t=this.children[i],o=0,r=t.children.length;o<r;o++)if(n=t.children[o],"vmp"===n.merge)return!0;return!1},isHorizontalMergePresent:function(){for(var t=editor.doc.getSelection(),e=t.getSelectedCells(),n=e.length,r=0;r<n;r++)if("hmp"==e[r].dtNode.merge)return!0;return!1},getFirstRow:function(){return this.children[0]},getLastRow:function(){return t.lastElementOf(this.children)},getFirstCell:function(){return this.getFirstRow().children[0]},isFullTableMerged:function(){var t=!1,e=this.getFirstCell();if(e&&e.getMergeType()===CELL_MERGE_TYPE.FC){var n=this.getCols()?this.getCols().length:0;e.getRowSpan()>=this.children.length&&e.getColSpan()>=n&&(t=!0)}return t},getChildrenLength:function(){return this.children.length},isColumnEmpty:function(t,e){for(var n=this.getChildrenLength(),r=0;r<n;r++){var i=this.children[r];if(i){if(e&&e.ignoreHeaderRow&&i.isHeaderRow())continue;var o=i.children[t];if(o&&!o.isEmpty())return!1}}return!0},isRowEmpty:function(t,e){var n=this.getChildrenLength();return t<n&&this.children[t].isEmptyRow(e)},isEmpty:function(t){for(var e=this.getChildrenLength(),n=0;n<e;n++){var r=this.children[n];if(r&&!r.isEmpty(t))return!1}return!0},isRTLDirection:function(){var t=this.getFormat()[ATTR_TABLE.TBLS_DIR]||PARA_DIR.LTR;return t===PARA_DIR.RTL}}),DTNode.types[UNICODE.TABLE]=e}(ZWArrayUtils),function(){"use strict";function t(t,e,n){DTNode.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.HR}t.prototype=Object.create(DTNode.prototype),t.prototype.constructor=t,DTNode.types[UNICODE.HR]=t,extend(t.prototype,{updateProperties:function(){},update:function(){},getBorderFormats:function(){return this.getFormats()[ATTR_COMMON.BORDERS]||{}},getFormats:function(){return this.format},setParentRemoveStatus:function(t){this.parentSetToRemove=t},setParentRemoveStatusToChildren:function(t){}})}(),DTUpdateQueue.prototype.priorityTable={remove:10,create:9,update:8,modify:7,adjustBorder:6,updatelist:5},DTUpdateQueue.prototype.push=function(t,e){if("create"==e.op?this.trigger("Document/NodeAdded",e.node):"remove"==e.op?(e.node.setParentRemoveStatusToChildren(!0),this.trigger("Document/NodeRemoved",e.node)):"modify"!=e.op&&"update"!=e.op||(e.type?this.trigger("Document/NodeModified",e.node,e.op,e.contentIndex,e.endIndex,e.type,e.styles):this.trigger("Document/NodeModified",e.node,e.op)),e.node.type===NODE_TYPE.ROW&&"remove"===e.op)for(var n=0,r=e.node.children.length;n<r;n++)for(var i=0,o=e.node.children[n].children.length;i<o;i++){var s,a=e.node.children[n].children[i];a.type===NODE_TYPE.PARA&&a.isList()&&a.paraProperties&&a.paraProperties.listData&&(s=a.paraProperties.listData.id),s&&e.node.section.doc.updateAllListItemsFromCurrentList(s,a)}else if(e.node.type===NODE_TYPE.PARA&&"updatelist"!==e.op&&"modify"!==e.op){var l;e.node.isList()&&(l=e.node.format.ls_data.id,"undefined"!=typeof l&&e.node.section.doc.updateAllListItemsFromCurrentList(l,e.node))}e.contentIndex=e.contentIndex||0;var d=this.nodesMap[t]||null;if(d){var c=this.priorityTable[d.op],p=this.priorityTable[e.op],E=this.nodesMap[t].contentIndex,u=e.contentIndex;return(p>=c||"done"===d.state)&&("updatelist"===d.op&&"modify"===e.op?e.contentIndex=u:e.contentIndex=Math.min(E,u),this.nodesMap[t]=e,!0)}return this.nodesMap[t]=e,this.length++,!0},DTUpdateQueue.prototype.get=function(){for(var t in this.nodesMap){var e=this.nodesMap[t];"remove"===e.op&&"para"!=e.node.type&&this.removeChildren(e.node.children)}var t,n,r=[];for(t in this.nodesMap)n=this.nodesMap[t],r.push(n);return r=r.sort(function(t,e){return t.node.getIndex()-e.node.getIndex()})},DTUpdateQueue.prototype.getBuildList=function(){var t=this.get();return t=t.sort(function(t,e){var n=0;return n="remove"==t.op&&"remove"!=e.op?-1:"remove"!=t.op&&"remove"==e.op?1:t.node.getIndex()-e.node.getIndex()})},DTUpdateQueue.prototype.remove=function(t){this.nodesMap[t]&&(delete this.nodesMap[t],this.length--)},DTUpdateQueue.prototype.getItem=function(t){return this.nodesMap[t]||null},DTUpdateQueue.prototype.removeChildren=function(t){for(var e=t&&t.length||0,n=0;n<e;n++){var r=t[n];this.remove(r.id),"para"!=r.type&&this.removeChildren(r.children)}},DTUpdateQueue.prototype.clear=function(){this.nodesMap={},this.length=0,this.resetEventHandler()},BaseEventHandler.call(DTUpdateQueue.prototype),function(){"use strict";function t(t,e,n){DTNode.call(this,t,e,n),this.format=editor.doc.getRawFormatAt(this.getIndex()),this.type=NODE_TYPE.TOC;var r=this.start,i=this.end,o=this.parent.getIndex();o+this.start;r+=o,i+=o}t.prototype=Object.create(DTNode.prototype),t.prototype.constructor=t,extend(t.prototype,{addToToc:function(t,e){var n,r,i,o,s,a,l=this.children,d=0,c=this.getIndex(),p=t;for(this.end+=e-t,o=l.length-1;o>=0&&(n=l[o],d=o,!(t>=n.start+c));o-=1)n.updateIndex(e-t);if(n&&"table"===n.type&&t>n.start+c)return void n.addToTable(t,e,p);n&&n.type!==NODE_TYPE.PARA&&t===n.start+c&&n.updateIndex(e-t),n&&"para"===n.type&&(t=n.start+c,n.start=getStart(UNICODE.PARA,e)-c,n.end=getEnd(UNICODE.PARA,e)-c,a=DTUtils.makeOp(n,"modify",p,e,"is"));var E=!1;for(o=t;o<e;)s=editor.doc.getCharAt(o),DTNode.types[s]?(s==UNICODE.PARA?(r=getStart(UNICODE.PARA,o)-c,i=getEnd(UNICODE.PARA,o)-c):s!=UNICODE.TABLE&&s!=UNICODE.HR||(r=o-c,i=getEnd(s,o)-c),n=s==UNICODE.TABLE?new DTNode.types[s](r,r+2,this):new DTNode.types[s](r,i,this),this.section.nodesToUpdate.push(n.id,DTUtils.makeOp(n,"create")),E=!0,this.addChildAt(n,d),n.updateProperties(),"para"==n.type?n.buildSegments():"table"==n.type&&n.addToTable(r+c+1,i+c-1),d++,o=c+n.end):o+=1;if(a){"para"==a.node.type&&a.node.buildSegments();var u=a.node;E&&!isNaN(a.contentIndex)&&u.type===NODE_TYPE.PARA&&(editor.doc.getCharAt(a.contentIndex)===UNICODE.PARA?(a.contentIndex=null,a.endIndex=null,a.type=null):a.contentIndex=u.getIndex()>a.contentIndex?u.getIndex():a.contentIndex),this.section.nodesToUpdate.push(u.id,a)}},deleteFromToc:function(t,e,n,r){var i,o,s,a=this.children,l=this.getIndex(),d=!1,c=e;for(this.end-=e-t,s=0;s<a.length;s++){if(i=a[s],o=s,i.start+l>t){i=i.prev||i,o=s-1;break}if("para"!=i.type&&i.start+l==t)break}if("table"==i.type&&i.start+l!=t)i.deleteFromTable(t,e,n,r);else{for(;i&&i.end+l<=e;)c-=i.getEndIndex()-i.getIndex()+1,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"remove")),this.deleteChildAt(o),i=i.next;var p=i;i&&("para"==i.type?(i.end=getEnd(UNICODE.PARA,t)-l,i.start=getStart(UNICODE.PARA,t)-l,n===UNICODE.PARA?this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"update")):(d=!0,this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"modify",r,c,"ds")))):this.section.nodesToUpdate.push(i.id,DTUtils.makeOp(i,"update")))}for(s=a.length-1;s>=0&&(i=a[s],!(t>=i.start+l));s-=1)i.updateIndex(t-e);p&&(p.updateProperties(d),"para"==p.type&&p.buildSegments())},updateNode:function(t,e,n){var r,i,o,s,a=this.children,l=this.getIndex();if(l!=t||e-t!=1){for(o=a.length-1;o>=0&&(r=a[o],i=o,!(t>=r.start+l));o-=1);if(e<l+r.end)return void r.updateNode(t,e,n);var d;for(r.type!==NODE_TYPE.PARA?(r.updateNode(t,r.end+l,n),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update"))):(r.updateProperties(),d=r.getEndIndex()>e?e:r.getEndIndex(),editor.doc.getCharAt(t)===UNICODE.PARA||editor.doc.getContent(t,e)===UNICODE.PARA?this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")):this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update",t,d,"as",n)),r.buildSegments()),o=r.end+l;o<e;)s=editor.doc.getCharAt(o),DTNode.types[s]?s!=UNICODE.PARA&&s!=UNICODE.TABLE&&s!=UNICODE.HR||(r=r.next,"para"!=r.type?r.updateNode(r.start,Math.min(r.end+l,e)):r.buildSegments(),r.updateProperties(),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=r.end+l):(r=r.next,r?(r.type===NODE_TYPE.PARA?(d=r.getEndIndex()>e?e:r.getEndIndex(),this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update",r.getIndex(),d,"as",n)),r.buildSegments()):this.section.nodesToUpdate.push(r.id,DTUtils.makeOp(r,"update")),o=getEnd(UNICODE.PARA,r.start+l)):o++)}else for(o=0;o<a.length;o++)this.section.nodesToUpdate.push(a[o].id,DTUtils.makeOp(a[o],"update"))},updateProperties:function(){this.format=editor.doc.getRawFormatAt(this.getIndex())},create:function(){this.updateProperties()},update:function(){this.updateProperties()}}),DTNode.types[UNICODE.TOCSTART]=t}(),PUtil.containsOffset=function(t,e){var n=PUtil.offsetTop(t),r=PUtil.offsetHeight(t);return n<e&&e<r+n},PUtil.nodeCompare=function(t,e){var n=PUtil.offsetTop(t);return PUtil.containsOffset(t,e)?0:n<e?-1:1},PUtil.getElementAtOffset=function(t,e){var n=J(t).contents().not("[nodeType=8], #"+CONST.PG_SPLIT_LAYER+", ."+CONST.PG_SPLIT_NODE+", #"+CONST.FTR_LAYER+", #"+CONST.FN_LAYER+", #"+CONST.HDR_LAYER);if(0==n.length||DomUtil.nodeNameEquals(t,"#text"))return t;var r=Utils.binarySearch(n,PUtil.nodeCompare,e);return null===r?t:3==r.nodeType?r:PUtil.getElementAtOffset(r,e)},PUtil.insertBefore=function(t,e){if(t&&e){var n=e.parentNode;n&&n.insertBefore(t,e)}},PUtil.offsetHeight=function(t){if(null==t)return 0;var e,n=J(t).parents("div.zw-page"),r=!0;editor.doc.isEditableMode()&&(e=n.find("div.zw-contentpane"),r=e.is(":visible"));var i=0;if(r||e.show(),3==t.nodeType){var o=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE).get(0);null==t.parentNode&&(i=t.offsetHeight),PUtil.insertBefore(o,t);var s=PUtil.offsetTop(o),a=t.nextSibling;null==a&&t.parentNode.appendChild(o),PUtil.insertBefore(o,a);var l=PUtil.offsetTop(o);i=l-s+o.offsetHeight,J(o).remove()}else if("br"==t.nodeName.toLowerCase()||"span"==t.nodeName.toLowerCase()&&DomUtil.isEmpty(t)){var o=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE)[0];J(t).before(o),i=t.offsetHeight,J(o).remove()}else i=t.offsetHeight;return r||e.hide(),i},PUtil._offset=function(t,e){var n=0,r=0;if(null==t)return{top:r,left:n};r=t.offsetTop;var i=e?e:editor.jeditorPane[0];for(n=t.offsetLeft+editor.jeditorPane.offset().left+Z("ui-editor-outer-div").scrollLeft(),t=t.offsetParent;t&&t!=i;)r+=t.offsetTop,n+=t.offsetLeft,t=t.offsetParent;return{top:r,left:n}},PUtil.offset=function(t,e){if(null==t)return 0;var n,r=J(t).parents("div.zw-page"),i=!0;editor.doc.isEditableMode()&&(n=r.find("div.zw-contentpane"),i=n.is(":visible"));var o={};if(i||n.show(),3==t.nodeType||3!=t.nodeType&&!PUtil.offsetHeight(t)){var s=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE)[0];null==t.parentNode&&(o={top:t.offsetTop,left:t.offsetLeft}),PUtil.insertBefore(s,t),o=PUtil._offset(s,e),J(s).remove()}else o=PUtil._offset(t,e);return i||n.hide(),o},PUtil._offsetWidth=function(t,e){var n=0;if(null==t)return n;n=t.offsetWidth;e?e:editor.jeditorPane[0];return t=t.offsetParent,n},PUtil._offsetTop=function(t,e){var n=0;if(null==t)return n;n=t.offsetTop;var r=e?e:editor.jeditorPane[0];for(t=t.offsetParent;t&&t!=r;)n+=t.offsetTop,t=t.offsetParent;return n},PUtil.offsetWidth=function(t,e){if(null==t)return 0;var n,r=J(t).parents("div.zw-page"),i=!0;editor.doc.isEditableMode()&&(n=r.find("div.zw-contentpane"),i=n.is(":visible"));var o=0;if(i||n.show(),3==t.nodeType){var s=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE)[0];null==t.parentNode&&(offsetTop=t.offsetTop),PUtil.insertBefore(s,t);var a=PUtil._offsetTop(s,e);J(s).remove(),offsetTop=a}else o=PUtil._offsetWidth(t,e);return i||n.hide(),o},PUtil.offsetTop=function(t,e){if(null==t)return 0;var n,r=J(t).parents("div.zw-page"),i=!0;editor.doc.isEditableMode()&&(n=r.find("div.zw-contentpane"),i=n.is(":visible"));var o=0;if(i||n.show(),3==t.nodeType){var s=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE)[0];null==t.parentNode&&(o=t.offsetTop),PUtil.insertBefore(s,t);var a=PUtil._offsetTop(s,e);J(s).remove(),o=a}else o=PUtil._offsetTop(t,e);return i||n.hide(),o},PUtil._offsetLeft=function(t,e){var n=0;if(null==t)return n;n=t.offsetLeft;var r=e?e:editor.jeditorPane[0];for(t=t.offsetParent;t&&t!=r;)n+=t.offsetLeft,t=t.offsetParent;return n},PUtil.offsetLeft=function(t,e){if(null==t)return 0;var n,r=J(t).parents("div.zw-page"),i=!0;editor.doc.isEditableMode()&&(n=r.find("div.zw-contentpane"),i=n.is(":visible"));var o=0;if(i||n.show(),3==t.nodeType){var s=J(document.createElement("span")).html(CONST.ZERO_WIDTH_SPACE)[0];null==t.parentNode&&(o=t.offsetLeft),PUtil.insertBefore(s,t);var a=PUtil._offsetLeft(s);J(s).remove(),o=a}else o=PUtil._offsetLeft(t,e);return i||n.hide(),o},TableThemeCSSGenerator=function(){"use strict";var t={"border-top":"tbody>tr:first-child>td { border-top\t:\tX;\t}","border-left":"tbody>tr>td:first-child { border-left\t:\tX;\t}","border-bottom":"tbody>tr:last-child>td\t{ border-bottom\t:\tX;\t}","border-right":"tbody>tr>td:last-child\t{ border-right\t:\tX;\t}",insideH:"tbody>tr:not(:last-child)>td { border-bottom\t:\tX;\t}",insideV:"tbody>tr>td:not(:last-child) { border-right:\tX;\t}"},e="tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td",n="tbody.zw-tbody:last-of-type>tr.zw-tr:last-child>td.zw-td",r="tbody.zw-tbody>tr.zw-tr>td.zw-td:first-child",i="tbody.zw-tbody>tr.zw-tr>td.zw-td:last-child",o="tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:first-child",s="tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:last-child",a="tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:first-child",l={"border-top":"tbody.zw-tbody>tr.zw-tr>td.zw-td { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody>tr.zw-tr>td.zw-td { border-left:\tX;\t}","border-right":"tbody.zw-tbody>tr.zw-tr>td.zw-td { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody>tr.zw-tr>td.zw-td { border-bottom:\tX;\t}"},d={"border-top":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td { border-left:\tX;\t}","border-right":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td { border-bottom:\tX;\t}"},c={"border-top":"tbody.zw-tbody:last-of-type>tr.zw-tr:last-child>td.zw-td { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:last-of-type>tr.zw-tr:last-child>td.zw-td { border-left\t:\tX;\t}","border-right":"tbody.zw-tbody:last-of-type>tr.zw-tr:last-child>td.zw-td { border-right\t:\tX;\t}","border-bottom":"tbody.zw-tbody:last-of-type>tr.zw-tr:last-child>td.zw-td { border-bottom:\tX;\t}"},p={"border-top":"tbody.zw-tbody>tr.zw-tr>td.zw-td:first-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody>tr.zw-tr>td.zw-td:first-child { border-left\t:\tX;\t}","border-right":"tbody.zw-tbody>tr.zw-tr>td.zw-td:first-child { border-right\t:\tX;\t}","border-bottom":"tbody.zw-tbody>tr.zw-tr>td.zw-td:first-child { border-bottom:\tX;\t}"},E={"border-top":"tbody.zw-tbody>tr.zw-tr>td.zw-td:last-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody>tr.zw-tr>td.zw-td:last-child { border-left\t:\tX;\t}","border-right":"tbody.zw-tbody>tr.zw-tr>td.zw-td:last-child { border-right\t:\tX;\t}","border-bottom":"tbody.zw-tbody>tr.zw-tr>td.zw-td:last-child { border-bottom\t:\tX;\t}"},u={"border-top":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:first-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:first-child { border-left:\tX;\t}","border-right":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:first-child { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:first-child { border-bottom:\tX;\t}"},T={"border-top":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:last-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:last-child { border-left:\tX;\t}","border-right":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:last-child { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody:first-of-type>tr.zw-tr:first-child>td.zw-td:last-child { border-bottom:\tX;\t}"},h={"border-top":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:first-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:first-child { border-left:\tX;\t}","border-right":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:first-child { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:first-child { border-bottom:\tX;\t}"},O={"border-top":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:last-child { border-top\t:\tX;\t}","border-left":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:last-child { border-left:\tX;\t}","border-right":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:last-child { border-right:\tX;\t}","border-bottom":"tbody.zw-tbody:first-of-type>tr.zw-tr:last-child>td.zw-td:last-child { border-bottom:\tX;\t}"},g="div.zw-cell-container>div.zw-paragraph>div.zw-line-div>div.zw-line-content>span.zw-portion",f="div.zw-cell-container>div.zw-paragraph",_=function(t){if(!t||"string"==typeof t)return t;var e="";return"nil"!=t.type?(e+=t.width?t.width+" ":"0px ",e+=t.type?t.type+" ":"none ",e+=t.color?t.color:""):e+="none",e},R=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.borders?n.borders:{},t.para?t.para:{}),i=t[e];if(!i)return{};var o,s=i.cell?i.cell:{};s&&(o=s.borders?s.borders:{}),s=DocUtil.getRenderingFormat(s);var a=s.bgc?s.bgc:null;return r=DocUtil.mergeObjs([r,i.para]),{borders:o,bgc:a,para:r}},A=function(t,n){var r=t.tblPr?t.tblPr:{},i=(r.borders?r.borders:{},"table[node-id="+n+"].zw-table>"),o="",s=R(t,"firstRow"),a=s.borders,l=s.bgc;for(var c in a)if(a[c]){var p=i+d[c];p=p.replace("X",_(a[c]))+"\n",o+=p}return l&&(o+=i+e+" { background-color : "+l+"; }\n"),U.isEmpty(s.para)||(o+=i+e+">"+f+"{ "+Utils.constructStyleText(s.para)+"}\n",o+=i+e+">"+g+"{ "+Utils.constructStyleText(s.para.textFormat)+"}\n"),o},I=function(t,e){var r=t.tblPr?t.tblPr:{},i=(r.borders?r.borders:{},"table[node-id="+e+"].zw-table>"),o="",s=R(t,"lastRow"),a=s.borders,l=s.bgc;for(var d in a)if(a[d]){var p=i+c[d];p=p.replace("X",_(a[d]))+"\n",o+=p}return l&&(o+=i+n+" { background-color : "+l+"; }\n"),U.isEmpty(s.para)||(o+=i+n+">"+f+"{ "+Utils.constructStyleText(s.para)+"}\n",o+=i+n+">"+g+"{ "+Utils.constructStyleText(s.para.textFormat)+"}\n"),o},D=function(t,e){var n=t.tblPr?t.tblPr:{},i=(n.borders?n.borders:{},"table[node-id="+e+"].zw-table>"),o="",s=R(t,"firstColumn"),a=s.borders,l=s.bgc;for(var d in a)if(a[d]){var c=i+p[d];c=c.replace("X",_(a[d]))+"\n",o+=c}return l&&(o+=i+r+" { background-color : "+l+"}\n"),U.isEmpty(s.para)||(o+=i+r+">"+f+"{ "+Utils.constructStyleText(s.para)+"}\n",o+=i+r+">"+g+"{ "+Utils.constructStyleText(s.para.textFormat)+"}\n"),o},S=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.borders?n.borders:{},"table[node-id="+e+"].zw-table>"),o="",s=R(t,"lastColumn"),a=s.borders,l=s.bgc;for(var d in a)if(a[d]){var c=r+E[d];c=c.replace("X",_(a[d]))+"\n",o+=c}return l&&(o+=r+i+" { background-color : "+l+"}\n"),U.isEmpty(s.para)||(o+=r+i+">"+f+"{ "+Utils.constructStyleText(s.para)+"}\n",o+=r+i+">"+g+"{ "+Utils.constructStyleText(s.para.textFormat)+"}\n"),o},C=function(t,e,n,r){var i=!1,o=R(n,t),s=o.borders,a="table[node-id="+r+"]>",l="";i=e.hasOwnProperty("tblLook")?!!parseInt(e.tblLook.firstRow):!!n.hasOwnProperty("firstRow");var d;"band1Horz"==t?(d=i?"even":"odd",a+="tbody.zw-tbody>tr:nth-child("+d):(d=i?"odd":"even",a+="tbody>tr:nth-child("+d),o.bgc&&(l+=a+")>td {",l+="background-color : "+o.bgc+"; }\n"),U.isEmpty(o.para)||(l+=a+")>td>"+f+"{",l+=Utils.constructStyleText(o.para)+"}\n",l+=a+")>td>"+g+"{",l+=Utils.constructStyleText(o.para.textFormat)+"}\n");for(var c in s)if(s[c]){var p=")>td {";p+=_(s[c])+"; }\n",l+=p}return l},L=function(t,e,n,r){var i=!1,o=R(n,t),s=o.borders,a="table[node-id="+r+"]>",l="";i=e.hasOwnProperty("tblLook")?!!parseInt(e.tblLook.firstColumn):!!n.hasOwnProperty("firstColumn");var d;"band1Vert"==t?(d=i?"even":"odd",a+="tbody.zw-tbody>tr.zw-tr>td.zw-td:nth-child("+d):(d=i?"odd":"even",a+="tbody.zw-tbody>tr.zw-tr>td:nth-child("+d),o.bgc&&(l=a+") {",l+="background-color : "+o.bgc+"; }\n"),U.isEmpty(o.para)||(l+=a+")>"+f+"{",l+=Utils.constructStyleText(o.para)+"}\n",l+=a+")>"+g+"{",l+=Utils.constructStyleText(o.para.textFormat)+"}\n");for(var c in s)if(s[c]){var p=a+") {";p+=_(s[c])+"; }\n",l+=p}return l},N=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.border?n.borders:{},"table[node-id="+e+"].zw-table>"),i="",s=R(t,"nwCell"),a=s.borders,l=s.bgc;for(var d in a)if(a[d]){var c=r+u[d];c=c.replace("X",_(a[d]))+"\n",i+=c}return l&&(i+=r+o+" { background-color : "+l+"}\n"),U.isEmpty(s.para)||(i+=r+o+">"+f+"{ "+Utils.constructStyleText(s.para)+"}\n",i+=r+o+">"+g+"{ "+Utils.constructStyleText(s.para.textFormat)+"}\n"),i},y=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.borders?n.borders:{},"table[node-id="+e+"].zw-table>"),i="",o=R(t,"neCell"),a=o.borders,l=o.bgc;for(var d in a)if(a[d]){var c=r+T[d];c=c.replace("X",_(a[d]))+"\n",i+=c}return l&&(i+=r+s+" { background-color : "+l+"}\n"),U.isEmpty(o.para)||(i+=r+s+">"+f+"{ "+Utils.constructStyleText(o.para)+"}\n",i+=r+s+">"+g+"{ "+Utils.constructStyleText(o.para.textFormat)+"}\n"),i},m=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.borders?n.borders:{},"table[node-id="+e+"].zw-table>"),i="",o=R(t,"swCell"),l=o.borders,d=o.bgc;for(var c in l)if(l[c]){var p=r+h[c];p=p.replace("X",_(l[c]))+"\n",i+=p}return d&&(i+=r+a+" { background-color : "+d+"}\n"),U.isEmpty(o.para)||(i+=r+s+">"+f+"{ "+Utils.constructStyleText(o.para)+"}\n",i+=r+s+">"+g+"{ "+Utils.constructStyleText(o.para.textFormat)+"}\n"),i},v=function(t,e){var n=t.tblPr?t.tblPr:{},r=(n.borders?n.borders:{},"table[node-id="+e+"].zw-table>"),i="",o=R(t,"seCell"),l=o.borders,d=o.bgc;for(var c in l)if(l[c]){var p=r+O[c];p=p.replace("X",_(l[c]))+"\n",i+=p}return d&&(i+=r+a+" { background-color : "+d+"}\n"),U.isEmpty(o.para)||(i+=r+s+">"+f+"{ "+Utils.constructStyleText(o.para)+"}\n",i+=r+s+">"+g+"{ "+Utils.constructStyleText(o.para.textFormat)+"}\n"),i},P=function(t){var e="";return e+=t.pt?t.pt.convertor().pixels+"px ":"0px ",e+=t.pr?t.pr.convertor().pixels+"px ":"0px ",e+=t.pb?t.pb.convertor().pixels+"px ":"0px ",e+=t.pl?t.pl.convertor().pixels+"px;":"0px;"},F=function(t,e){var n=t.tblPr?t.tblPr:{},r=n.cell?n.cell:{},i=r.borders?r.borders:{},o="table[node-id="+e+"].zw-table>",s="";for(var a in i)if(i[a]){var d=o+l[a];d=d.replace("X",_(i[a]))+"\n",s+=d}return s},x=function(e,n){var r=e[ATTR_TABLE.TBLS_THEME];r||(r=n.theme);var i=r[ATTR_TABLE.TBLS_THEME_OBJECT];if(i){var o=n.id,s=i.tblPr?i.tblPr:{},a=s.borders?s.borders:{},l=s.tblCellMar?s.tblCellMar:{},d=s.cell?s.cell:{},c="table[node-id="+o+"]>",p="";e=DocUtil.mergeObjs([a,e]);for(var E in e)if(t.hasOwnProperty(E)){var u=c+t[E];u=u.replace("X",_(e[E]))+"\n",p+=u}U.isEmpty(l)||(p+=c+"tbody>tr>td>div.zw-cell-container { padding : "+P(l)+"}\n"),U.isEmpty(d)||(d.hasOwnProperty("bgc")&&(p+=c+"tbody>tr>td {",p+="background-color : "+d.bgc+";\n",p+="}\n"),d.hasOwnProperty(ATTR_CELL.TDS_VA)&&(p+=c+"tbody>tr>td {",p+="vertical-align : "+d[ATTR_CELL.TDS_VA]+";\n",p+="}\n"),d.hasOwnProperty("borders")&&(p+=F(i,o))),U.isEmpty(i.para)||(p+=c+"tbody>tr>td>div.zw-paragraph { "+Utils.constructStyleText(i.para)+"}\n",p+=c+"tbody>tr>td>span.zw-portion { "+i.para.textFormat+"}\n"),i.firstRow&&!U.isEmpty(i.firstRow)&&(p+=A(i,o)),i.lastRow&&!U.isEmpty(i.lastRow)&&(p+=I(i,o)),i.firstColumn&&!U.isEmpty(i.firstColumn)&&(p+=D(i,o)),i.lastColumn&&!U.isEmpty(i.lastColumn)&&(p+=S(i,o)),i.band1Horz&&!U.isEmpty(i.band1Horz)&&(p+=C("band1Horz",e,i,o)),i.band2Horz&&!U.isEmpty(i.band2Horz)&&(p+=C("band2Horz",e,i,o)),i.band1Vert&&!U.isEmpty(i.band1Vert)&&(p+=L("band1Vert",e,i,o)),i.band2Vert&&!U.isEmpty(i.band2Vert)&&(p+=L("band2Vert",e,i,o)),i.nwCell&&!U.isEmpty(i.nwCell)&&(p+=N(i,o)),i.neCell&&!U.isEmpty(i.neCell)&&(p+=y(i,o)),i.swCell&&!U.isEmpty(i.swCell)&&(p+=m(i,o)),i.seCell&&!U.isEmpty(i.seCell)&&(p+=v(i,o));var T=J("#"+o).length?J("#"+o):J("<style>");T.attr({id:o,class:"table-theme-style"}),T.text(p).appendTo(document.head)}};return{getCellStyles:R,getCSSBorder:_,setStyleTag:x}}();var Numeral=function(){var t,e=["ar","ar-DZ","ar-KW","ar-LY","ar-MA","ar-SA","ar-TN","fa","ca","tzl","ug"],n=["bn","mr","ur-IN"],r=["my","ne","sd"],i=function(t,i){return e.contains(t)?t="en-US":n.contains(t)?t="en-IN":r.contains(t)&&i===!1&&(t="en-US"),t},o={};o={"en-US":{delimiters:{decimal:".",thousands:","}}};var s,a=function(t){s=t},l=function(t){return"number"==typeof t&&isNaN(t)},d=/([\d])([\d,\.\s]+[\d])?/,c=function(t){return"bg"==t?" ":","},p=function(t){var e=["es","es-CL","es-CO","id","vi"];return e.contains(t)?",":"."},E=function(t){try{var e=parseFloat(t.value).toLocaleString(t.langCountryCode,{minimumFractionDigits:t.decimalPlaces,maximumFractionDigits:t.decimalPlaces,minimumIntegerDigits:t.integerPlaces,useGrouping:t.useThousandGrouping,style:t.isCurrency?"currency":"decimal",currency:t.currencyCode});e=e.replaceAll(String.fromCharCode(160),String.fromCharCode(32))}catch(t){e="0"}return e},u=function(t,e){var n=123456.12345,r={};r.minimumFractionDigits=2,e&&(r.style="currency",r.currency=e,r.currencyDisplay="symbol");var i=new Intl.NumberFormat(t,r),o=i.formatToParts(n);return{numberFormat:i,formattedToParts:o}},T=function(){return"undefined"!=typeof Intl&&Intl.NumberFormat&&Intl.NumberFormat.prototype.formatToParts},h=function(t){var e,n,r={};try{if(T())formatParts=(s?u(t,s(t)):u(t)).formattedToParts,e=formatParts.filter(function(t){return"group"==t.type}),e=e[0]&&e[0].value,n=formatParts.filter(function(t){return"decimal"==t.type}),n=n[0]&&n[0].value;else{var i={value:123456789.1234,langCountryCode:t,decimalPlaces:2,useThousandGrouping:!0,integerPlaces:5},o=E(i);o=o.match(d),o&&o[0]&&(o=o[0],o=o.replace(/\d/g,""),o[o.length-1]&&(n=o[o.length-1]),o[o.length-2]&&(e=o[o.length-2]))}if(e=e||c(),n=n||p(),n==e)throw"same thousand and decimal separator"}catch(t){e=",",n="."}return r.decimal=n,r.thousands=e,r},O=function(t,e){if(t&&e){var n,r;try{if(T())for(var i=u(t,e),o=i.numberFormat,s=i.formattedToParts,a=o.format(123456.12345),l=0,d=s.length;l<d;l++)"currency"===s[l].type&&(r=s[l].value,n=a.replace(r,"").trim());else{var c={value:123456.12345,langCountryCode:t,decimalPlaces:2,useThousandGrouping:!0,integerPlaces:5};n=E(c),c.isCurrency=!0,c.currencyCode=e;var p=E(c);r=p.replace(n,"").trim()}}catch(t){n="123,456.12",r="$"}return{format:n,symbol:r}}},g=function(){var e=h(t);o[t]={delimiters:e}},f=function(e){var n,r,i=o[t],n=1,s=8239;return e=e.replaceAll("[ ]",String.fromCharCode(s)),e=e.replaceAll("["+i.delimiters.thousands+"]",""),"."!==i.delimiters.decimal&&(e=e.replace(i.delimiters.decimal,".")),n*=(e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2?1:-1,r=e.match(/[0-9\.]+/g,""),r&&(e=r[0]),n*=Number(e)},_=function(e,n){return t=n||"en-US",0===e||"undefined"==typeof e?value=0:null===e||l(e)?value=null:"string"==typeof e?(o[t]||g(),value=f(e)):value=Number(e)||null,value};return{applyThousandAndDecimalSeperator:E,getFormattedNumberAndCurrencySymbol:O,getThousandAndDecimalSeperator:h,getValidLocale:i,getNumber:_,setLocaleCurrencyProvider:a}}();var BIDI_CHAR_TYPES_REGEX = {
    //Left To Right
    L: new RegExp("^[\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02B8\u02BB-\u02C1\u02D0\u02D1\u02E0-\u02E4\u02EE\u0370-\u0373\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0482\u048A-\u052F\u0531-\u0556\u0559-\u0589\u0903-\u0939\u093B\u093D-\u0940\u0949-\u094C\u094E-\u0950\u0958-\u0961\u0964-\u0980\u0982\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD-\u09C0\u09C7\u09C8\u09CB\u09CC\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09FA\u09FC\u09FD\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3E-\u0A40\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A76\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD-\u0AC0\u0AC9\u0ACB\u0ACC\u0AD0\u0AE0\u0AE1\u0AE6-\u0AF0\u0AF9\u0B02\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B3E\u0B40\u0B47\u0B48\u0B4B\u0B4C\u0B57\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE\u0BBF\u0BC1\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD0\u0BD7\u0BE6-\u0BF2\u0C01-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C41-\u0C44\u0C58-\u0C5A\u0C60\u0C61\u0C66-\u0C6F\u0C77\u0C7F\u0C80\u0C82-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD-\u0CC4\u0CC6-\u0CC8\u0CCA\u0CCB\u0CD5\u0CD6\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D02\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D4E\u0D4F\u0D54-\u0D61\u0D66-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E4F-\u0E5B\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00-\u0F17\u0F1A-\u0F34\u0F36\u0F38\u0F3E-\u0F47\u0F49-\u0F6C\u0F7F\u0F85\u0F88-\u0F8C\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE-\u0FDA\u1000-\u102C\u1031\u1038\u103B\u103C\u103F-\u1057\u105A-\u105D\u1061-\u1070\u1075-\u1081\u1083\u1084\u1087-\u108C\u108E-\u109C\u109E-\u10C5\u10C7\u10CD\u10D0-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1360-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u167F\u1681-\u169A\u16A0-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1735\u1736\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17B6\u17BE-\u17C5\u17C7\u17C8\u17D4-\u17DA\u17DC\u17E0-\u17E9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1923-\u1926\u1929-\u192B\u1930\u1931\u1933-\u1938\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A19\u1A1A\u1A1E-\u1A55\u1A57\u1A61\u1A63\u1A64\u1A6D-\u1A72\u1A80-\u1A89\u1A90-\u1A99\u1AA0-\u1AAD\u1B04-\u1B33\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B4B\u1B50-\u1B6A\u1B74-\u1B7C\u1B82-\u1BA1\u1BA6\u1BA7\u1BAA\u1BAE-\u1BE5\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2\u1BF3\u1BFC-\u1C2B\u1C34\u1C35\u1C3B-\u1C49\u1C4D-\u1C88\u1C90-\u1CBA\u1CBD-\u1CC7\u1CD3\u1CE1\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5-\u1CF7\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200E\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u214F\u2160-\u2188\u2336-\u237A\u2395\u249C-\u24E9\u26AC\u2800-\u28FF\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D70\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u302E\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3190-\u31BA\u31F0-\u321C\u3220-\u324F\u3260-\u327B\u327F-\u32B0\u32C0-\u32CB\u32D0-\u32FE\u3300-\u3376\u337B-\u33DD\u33E0-\u33FE\u3400-\u4DB5\u4E00-\u9FEF\uA000-\uA48C\uA4D0-\uA60C\uA610-\uA62B\uA640-\uA66E\uA680-\uA69D\uA6A0-\uA6EF\uA6F2-\uA6F7\uA722-\uA787\uA789-\uA7BF\uA7C2-\uA7C6\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA824\uA827\uA830-\uA837\uA840-\uA873\uA880-\uA8C3\uA8CE-\uA8D9\uA8F2-\uA8FE\uA900-\uA925\uA92E-\uA946\uA952\uA953\uA95F-\uA97C\uA983-\uA9B2\uA9B4\uA9B5\uA9BA\uA9BB\uA9BE-\uA9CD\uA9CF-\uA9D9\uA9DE-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA2F\uAA30\uAA33\uAA34\uAA40-\uAA42\uAA44-\uAA4B\uAA4D\uAA50-\uAA59\uAA5C-\uAA7B\uAA7D-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAAEB\uAAEE-\uAAF5\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB67\uAB70-\uABE4\uABE6\uABE7\uABE9-\uABEC\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uD800-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC\\u{10000}-\\u{1000B}\\u{1000D}-\\u{10026}\\u{10028}-\\u{1003A}\\u{1003C}\\u{1003D}\\u{1003F}-\\u{1004D}\\u{10050}-\\u{1005D}\\u{10080}-\\u{100FA}\\u{10100}\\u{10102}\\u{10107}-\\u{10133}\\u{10137}-\\u{1013F}\\u{1018D}\\u{1018E}\\u{101D0}-\\u{101FC}\\u{10280}-\\u{1029C}\\u{102A0}-\\u{102D0}\\u{10300}-\\u{10323}\\u{1032D}-\\u{1034A}\\u{10350}-\\u{10375}\\u{10380}-\\u{1039D}\\u{1039F}-\\u{103C3}\\u{103C8}-\\u{103D5}\\u{10400}-\\u{1049D}\\u{104A0}-\\u{104A9}\\u{104B0}-\\u{104D3}\\u{104D8}-\\u{104FB}\\u{10500}-\\u{10527}\\u{10530}-\\u{10563}\\u{1056F}\\u{10600}-\\u{10736}\\u{10740}-\\u{10755}\\u{10760}-\\u{10767}\\u{11000}\\u{11002}-\\u{11037}\\u{11047}-\\u{1104D}\\u{11066}-\\u{1106F}\\u{11082}-\\u{110B2}\\u{110B7}\\u{110B8}\\u{110BB}-\\u{110C1}\\u{110CD}\\u{110D0}-\\u{110E8}\\u{110F0}-\\u{110F9}\\u{11103}-\\u{11126}\\u{1112C}\\u{11136}-\\u{11146}\\u{11150}-\\u{11172}\\u{11174}-\\u{11176}\\u{11182}-\\u{111B5}\\u{111BF}-\\u{111C8}\\u{111CD}\\u{111D0}-\\u{111DF}\\u{111E1}-\\u{111F4}\\u{11200}-\\u{11211}\\u{11213}-\\u{1122E}\\u{11232}\\u{11233}\\u{11235}\\u{11238}-\\u{1123D}\\u{11280}-\\u{11286}\\u{11288}\\u{1128A}-\\u{1128D}\\u{1128F}-\\u{1129D}\\u{1129F}-\\u{112A9}\\u{112B0}-\\u{112DE}\\u{112E0}-\\u{112E2}\\u{112F0}-\\u{112F9}\\u{11302}\\u{11303}\\u{11305}-\\u{1130C}\\u{1130F}\\u{11310}\\u{11313}-\\u{11328}\\u{1132A}-\\u{11330}\\u{11332}\\u{11333}\\u{11335}-\\u{11339}\\u{1133D}-\\u{1133F}\\u{11341}-\\u{11344}\\u{11347}\\u{11348}\\u{1134B}-\\u{1134D}\\u{11350}\\u{11357}\\u{1135D}-\\u{11363}\\u{11400}-\\u{11437}\\u{11440}\\u{11441}\\u{11445}\\u{11447}-\\u{11459}\\u{1145B}\\u{1145D}\\u{1145F}\\u{11480}-\\u{114B2}\\u{114B9}\\u{114BB}-\\u{114BE}\\u{114C1}\\u{114C4}-\\u{114C7}\\u{114D0}-\\u{114D9}\\u{11580}-\\u{115B1}\\u{115B8}-\\u{115BB}\\u{115BE}\\u{115C1}-\\u{115DB}\\u{11600}-\\u{11632}\\u{1163B}\\u{1163C}\\u{1163E}\\u{11641}-\\u{11644}\\u{11650}-\\u{11659}\\u{11680}-\\u{116AA}\\u{116AC}\\u{116AE}\\u{116AF}\\u{116B6}\\u{116B8}\\u{116C0}-\\u{116C9}\\u{11700}-\\u{1171A}\\u{11720}\\u{11721}\\u{11726}\\u{11730}-\\u{1173F}\\u{11800}-\\u{1182E}\\u{11838}\\u{1183B}\\u{118A0}-\\u{118F2}\\u{118FF}\\u{119A0}-\\u{119A7}\\u{119AA}-\\u{119D3}\\u{119DC}-\\u{119DF}\\u{119E1}-\\u{119E4}\\u{11A00}\\u{11A07}\\u{11A08}\\u{11A0B}-\\u{11A32}\\u{11A39}\\u{11A3A}\\u{11A3F}-\\u{11A46}\\u{11A50}\\u{11A57}\\u{11A58}\\u{11A5C}-\\u{11A89}\\u{11A97}\\u{11A9A}-\\u{11AA2}\\u{11AC0}-\\u{11AF8}\\u{11C00}-\\u{11C08}\\u{11C0A}-\\u{11C2F}\\u{11C3E}-\\u{11C45}\\u{11C50}-\\u{11C6C}\\u{11C70}-\\u{11C8F}\\u{11CA9}\\u{11CB1}\\u{11CB4}\\u{11D00}-\\u{11D06}\\u{11D08}\\u{11D09}\\u{11D0B}-\\u{11D30}\\u{11D46}\\u{11D50}-\\u{11D59}\\u{11D60}-\\u{11D65}\\u{11D67}\\u{11D68}\\u{11D6A}-\\u{11D8E}\\u{11D93}\\u{11D94}\\u{11D96}\\u{11D98}\\u{11DA0}-\\u{11DA9}\\u{11EE0}-\\u{11EF2}\\u{11EF5}-\\u{11EF8}\\u{11FC0}-\\u{11FD4}\\u{11FFF}-\\u{12399}\\u{12400}-\\u{1246E}\\u{12470}-\\u{12474}\\u{12480}-\\u{12543}\\u{13000}-\\u{1342E}\\u{13430}-\\u{13438}\\u{14400}-\\u{14646}\\u{16800}-\\u{16A38}\\u{16A40}-\\u{16A5E}\\u{16A60}-\\u{16A69}\\u{16A6E}\\u{16A6F}\\u{16AD0}-\\u{16AED}\\u{16AF5}\\u{16B00}-\\u{16B2F}\\u{16B37}-\\u{16B45}\\u{16B50}-\\u{16B59}\\u{16B5B}-\\u{16B61}\\u{16B63}-\\u{16B77}\\u{16B7D}-\\u{16B8F}\\u{16E40}-\\u{16E9A}\\u{16F00}-\\u{16F4A}\\u{16F50}-\\u{16F87}\\u{16F93}-\\u{16F9F}\\u{16FE0}\\u{16FE1}\\u{16FE3}\\u{17000}-\\u{187F7}\\u{18800}-\\u{18AF2}\\u{1B000}-\\u{1B11E}\\u{1B150}-\\u{1B152}\\u{1B164}-\\u{1B167}\\u{1B170}-\\u{1B2FB}\\u{1BC00}-\\u{1BC6A}\\u{1BC70}-\\u{1BC7C}\\u{1BC80}-\\u{1BC88}\\u{1BC90}-\\u{1BC99}\\u{1BC9C}\\u{1BC9F}\\u{1D000}-\\u{1D0F5}\\u{1D100}-\\u{1D126}\\u{1D129}-\\u{1D166}\\u{1D16A}-\\u{1D172}\\u{1D183}\\u{1D184}\\u{1D18C}-\\u{1D1A9}\\u{1D1AE}-\\u{1D1E8}\\u{1D2E0}-\\u{1D2F3}\\u{1D360}-\\u{1D378}\\u{1D400}-\\u{1D454}\\u{1D456}-\\u{1D49C}\\u{1D49E}\\u{1D49F}\\u{1D4A2}\\u{1D4A5}\\u{1D4A6}\\u{1D4A9}-\\u{1D4AC}\\u{1D4AE}-\\u{1D4B9}\\u{1D4BB}\\u{1D4BD}-\\u{1D4C3}\\u{1D4C5}-\\u{1D505}\\u{1D507}-\\u{1D50A}\\u{1D50D}-\\u{1D514}\\u{1D516}-\\u{1D51C}\\u{1D51E}-\\u{1D539}\\u{1D53B}-\\u{1D53E}\\u{1D540}-\\u{1D544}\\u{1D546}\\u{1D54A}-\\u{1D550}\\u{1D552}-\\u{1D6A5}\\u{1D6A8}-\\u{1D6DA}\\u{1D6DC}-\\u{1D714}\\u{1D716}-\\u{1D74E}\\u{1D750}-\\u{1D788}\\u{1D78A}-\\u{1D7C2}\\u{1D7C4}-\\u{1D7CB}\\u{1D800}-\\u{1D9FF}\\u{1DA37}-\\u{1DA3A}\\u{1DA6D}-\\u{1DA74}\\u{1DA76}-\\u{1DA83}\\u{1DA85}-\\u{1DA8B}\\u{1E100}-\\u{1E12C}\\u{1E137}-\\u{1E13D}\\u{1E140}-\\u{1E149}\\u{1E14E}\\u{1E14F}\\u{1E2C0}-\\u{1E2EB}\\u{1E2F0}-\\u{1E2F9}\\u{1F110}-\\u{1F12E}\\u{1F130}-\\u{1F169}\\u{1F170}-\\u{1F1AC}\\u{1F1E6}-\\u{1F202}\\u{1F210}-\\u{1F23B}\\u{1F240}-\\u{1F248}\\u{1F250}\\u{1F251}\\u{20000}-\\u{2A6D6}\\u{2A700}-\\u{2B734}\\u{2B740}-\\u{2B81D}\\u{2B820}-\\u{2CEA1}\\u{2CEB0}-\\u{2EBE0}\\u{2F800}-\\u{2FA1D}\\u{F0000}-\\u{FFB9A}]", "u"),
    //Arabic Letter
    AL: new RegExp("^[\u0608\u060B\u060D\u061B\u061C\u061E-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u070D\u070F\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\uFB50-\uFBC1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFC\uFE70-\uFE74\uFE76-\uFEFC\\u{10D00}-\\u{10D23}\\u{10F30}-\\u{10F45}\\u{10F51}-\\u{10F59}\\u{1EC71}-\\u{1ECB4}\\u{1ED01}-\\u{1ED3D}\\u{1EE00}-\\u{1EE03}\\u{1EE05}-\\u{1EE1F}\\u{1EE21}\\u{1EE22}\\u{1EE24}\\u{1EE27}\\u{1EE29}-\\u{1EE32}\\u{1EE34}-\\u{1EE37}\\u{1EE39}\\u{1EE3B}\\u{1EE42}\\u{1EE47}\\u{1EE49}\\u{1EE4B}\\u{1EE4D}-\\u{1EE4F}\\u{1EE51}\\u{1EE52}\\u{1EE54}\\u{1EE57}\\u{1EE59}\\u{1EE5B}\\u{1EE5D}\\u{1EE5F}\\u{1EE61}\\u{1EE62}\\u{1EE64}\\u{1EE67}-\\u{1EE6A}\\u{1EE6C}-\\u{1EE72}\\u{1EE74}-\\u{1EE77}\\u{1EE79}-\\u{1EE7C}\\u{1EE7E}\\u{1EE80}-\\u{1EE89}\\u{1EE8B}-\\u{1EE9B}\\u{1EEA1}-\\u{1EEA3}\\u{1EEA5}-\\u{1EEA9}\\u{1EEAB}-\\u{1EEBB}]", "u"),
    //Arabic Number
    AN: new RegExp("^[\u0600-\u0605\u0660-\u0669\u066B\u066C\u06DD\u08E2\\u{10D30}-\\u{10D39}\\u{10E60}-\\u{10E7E}]", "u"),
    //Paragraph Separator
    B: new RegExp("^[\u000A\u000D\u001C-\u001E\u0085\u2029]", ""),
    //Boundary Neutral
    BN: new RegExp("^[\u0000-\u0008\u000E-\u001B\u007F-\u0084\u0086-\u009F\u00AD\u180E\u200B-\u200D\u2060-\u2064\u206A-\u206F\uFEFF\\u{1BCA0}-\\u{1BCA3}\\u{1D173}-\\u{1D17A}\\u{E0001}\\u{E0020}-\\u{E007F}]", "u"),
    //Common Separator
    CS: new RegExp("^[\u002C\u002E\u002F\u003A\u00A0\u060C\u202F\u2044\uFE50\uFE52\uFE55\uFF0C\uFF0E\uFF0F\uFF1A]", ""),
    //European Number
    EN: new RegExp("^[\u0030-\u0039\u00B2\u00B3\u00B9\u06F0-\u06F9\u2070\u2074-\u2079\u2080-\u2089\u2488-\u249B\uFF10-\uFF19\\u{102E1}-\\u{102FB}\\u{1D7CE}-\\u{1D7FF}\\u{1F100}-\\u{1F10A}]", "u"),
    //European Separator
    ES: new RegExp("^[\u002B\\u002D\u207A\u207B\u208A\u208B\u2212\uFB29\uFE62\uFE63\uFF0B\uFF0D]", ""),
    //European Terminator
    ET: new RegExp("^[\u0023-\u0025\u00A2-\u00A5\u00B0\u00B1\u058F\u0609\u060A\u066A\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u2030-\u2034\u20A0-\u20BF\u212E\u2213\uA838\uA839\uFE5F\uFE69\uFE6A\uFF03-\uFF05\uFFE0\uFFE1\uFFE5\uFFE6\\u{11FDD}-\\u{11FE0}\\u{1E2FF}]", "u"),
    //First Strong Isolate
    FSI: new RegExp("^[\u2068]", ""),
    //Left To Right Embedding
    LRE: new RegExp("^[\u202A]", ""),
    //Left To Right Isolate
    LRI: new RegExp("^[\u2066]", ""),
    //Left To Right Override
    LRO: new RegExp("^[\u202D]", ""),
    //Pop Directional Format
    PDF: new RegExp("^[\u202C]", ""),
    //Pop Directional Isolate
    PDI: new RegExp("^[\u2069]", ""),
    //Right To Left Embedding
    RLE: new RegExp("^[\u202B]", ""),
    //Right To Left Isolate
    RLI: new RegExp("^[\u2067]", ""),
    //Right To Left Override
    RLO: new RegExp("^[\u202E]", ""),
    //Segment Separator
    S: new RegExp("^[\u0009\u000B\u001F]", ""),
    //White Space
    WS: new RegExp("^[\u000C\u0020\u1680\u2000-\u200A\u2028\u205F\u3000]", ""),
    //Nonspacing Mark
    NSM: new RegExp("^[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2\u09E3\u09FE\u0A01\u0A02\u0A3C\u0A41\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7\u0AC8\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C04\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81\u0CBC\u0CCC\u0CCD\u0CE2\u0CE3\u0D00\u0D01\u0D3B\u0D3C\u0D41-\u0D44\u0D4D\u0D62\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039\u103A\u103D\u103E\u1058\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193B\u1A17\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80\u1B81\u1BA2-\u1BA5\u1BA8\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA825\uA826\uA8C4\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9BD\uA9E5\uAA29-\uAA2E\uAA31\uAA32\uAA35\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEC\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\\u{101FD}\\u{102E0}\\u{10376}-\\u{1037A}\\u{10A01}-\\u{10A03}\\u{10A05}\\u{10A06}\\u{10A0C}-\\u{10A0F}\\u{10A38}-\\u{10A3A}\\u{10A3F}\\u{10AE5}\\u{10AE6}\\u{10D24}-\\u{10D27}\\u{10F46}-\\u{10F50}\\u{11001}\\u{11038}-\\u{11046}\\u{1107F}-\\u{11081}\\u{110B3}-\\u{110B6}\\u{110B9}\\u{110BA}\\u{11100}-\\u{11102}\\u{11127}-\\u{1112B}\\u{1112D}-\\u{11134}\\u{11173}\\u{11180}\\u{11181}\\u{111B6}-\\u{111BE}\\u{111C9}-\\u{111CC}\\u{1122F}-\\u{11231}\\u{11234}\\u{11236}\\u{11237}\\u{1123E}\\u{112DF}\\u{112E3}-\\u{112EA}\\u{11300}\\u{11301}\\u{1133B}\\u{1133C}\\u{11340}\\u{11366}-\\u{1136C}\\u{11370}-\\u{11374}\\u{11438}-\\u{1143F}\\u{11442}-\\u{11444}\\u{11446}\\u{1145E}\\u{114B3}-\\u{114B8}\\u{114BA}\\u{114BF}\\u{114C0}\\u{114C2}\\u{114C3}\\u{115B2}-\\u{115B5}\\u{115BC}\\u{115BD}\\u{115BF}\\u{115C0}\\u{115DC}\\u{115DD}\\u{11633}-\\u{1163A}\\u{1163D}\\u{1163F}\\u{11640}\\u{116AB}\\u{116AD}\\u{116B0}-\\u{116B5}\\u{116B7}\\u{1171D}-\\u{1171F}\\u{11722}-\\u{11725}\\u{11727}-\\u{1172B}\\u{1182F}-\\u{11837}\\u{11839}\\u{1183A}\\u{119D4}-\\u{119D7}\\u{119DA}\\u{119DB}\\u{119E0}\\u{11A01}-\\u{11A06}\\u{11A09}\\u{11A0A}\\u{11A33}-\\u{11A38}\\u{11A3B}-\\u{11A3E}\\u{11A47}\\u{11A51}-\\u{11A56}\\u{11A59}-\\u{11A5B}\\u{11A8A}-\\u{11A96}\\u{11A98}\\u{11A99}\\u{11C30}-\\u{11C36}\\u{11C38}-\\u{11C3D}\\u{11C92}-\\u{11CA7}\\u{11CAA}-\\u{11CB0}\\u{11CB2}\\u{11CB3}\\u{11CB5}\\u{11CB6}\\u{11D31}-\\u{11D36}\\u{11D3A}\\u{11D3C}\\u{11D3D}\\u{11D3F}-\\u{11D45}\\u{11D47}\\u{11D90}\\u{11D91}\\u{11D95}\\u{11D97}\\u{11EF3}\\u{11EF4}\\u{16AF0}-\\u{16AF4}\\u{16B30}-\\u{16B36}\\u{16F4F}\\u{16F8F}-\\u{16F92}\\u{1BC9D}\\u{1BC9E}\\u{1D167}-\\u{1D169}\\u{1D17B}-\\u{1D182}\\u{1D185}-\\u{1D18B}\\u{1D1AA}-\\u{1D1AD}\\u{1D242}-\\u{1D244}\\u{1DA00}-\\u{1DA36}\\u{1DA3B}-\\u{1DA6C}\\u{1DA75}\\u{1DA84}\\u{1DA9B}-\\u{1DA9F}\\u{1DAA1}-\\u{1DAAF}\\u{1E000}-\\u{1E006}\\u{1E008}-\\u{1E018}\\u{1E01B}-\\u{1E021}\\u{1E023}\\u{1E024}\\u{1E026}-\\u{1E02A}\\u{1E130}-\\u{1E136}\\u{1E2EC}-\\u{1E2EF}\\u{1E8D0}-\\u{1E8D6}\\u{1E944}-\\u{1E94A}\\u{E0100}-\\u{E01EF}]", "u"),
    //Other Neutral
    ON: new RegExp("^[\u0021\u0022\u0026-\u002A\u003B-\u0040\u005B-\u0060\u007B-\u007E\u00A1\u00A6-\u00A9\u00AB\u00AC\u00AE\u00AF\u00B4\u00B6-\u00B8\u00BB-\u00BF\u00D7\u00F7\u02B9\u02BA\u02C2-\u02CF\u02D2-\u02DF\u02E5-\u02ED\u02EF-\u02FF\u0374\u0375\u037E\u0384\u0385\u0387\u03F6\u058A\u058D\u058E\u0606\u0607\u060E\u060F\u06DE\u06E9\u07F6-\u07F9\u0BF3-\u0BF8\u0BFA\u0C78-\u0C7E\u0F3A-\u0F3D\u1390-\u1399\u1400\u169B\u169C\u17F0-\u17F9\u1800-\u180A\u1940\u1944\u1945\u19DE-\u19FF\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2010-\u2027\u2035-\u2043\u2045-\u205E\u207C-\u207E\u208C-\u208E\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u213A\u213B\u2140-\u2144\u214A-\u214D\u2150-\u215F\u2189-\u218B\u2190-\u2211\u2214-\u2335\u237B-\u2394\u2396-\u2426\u2440-\u244A\u2460-\u2487\u24EA-\u26AB\u26AD-\u27FF\u2900-\u2B73\u2B76-\u2B95\u2B98-\u2BFF\u2CE5-\u2CEA\u2CF9-\u2CFF\u2E00-\u2E4F\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFB\u3001-\u3004\u3008-\u3020\u3030\u3036\u3037\u303D-\u303F\u309B\u309C\u30A0\u30FB\u31C0-\u31E3\u321D\u321E\u3250-\u325F\u327C-\u327E\u32B1-\u32BF\u32CC-\u32CF\u3377-\u337A\u33DE\u33DF\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA60D-\uA60F\uA673\uA67E\uA67F\uA700-\uA721\uA788\uA828-\uA82B\uA874-\uA877\uFD3E\uFD3F\uFDFD\uFE10-\uFE19\uFE30-\uFE4F\uFE51\uFE54\uFE56-\uFE5E\uFE60\uFE61\uFE64-\uFE66\uFE68\uFE6B\uFF01\uFF02\uFF06-\uFF0A\uFF1B-\uFF20\uFF3B-\uFF40\uFF5B-\uFF65\uFFE2-\uFFE4\uFFE8-\uFFEE\uFFF9-\uFFFD\\u{10101}\\u{10140}-\\u{1018C}\\u{10190}-\\u{1019B}\\u{101A0}\\u{1091F}\\u{10B39}-\\u{10B3F}\\u{11052}-\\u{11065}\\u{11660}-\\u{1166C}\\u{11FD5}-\\u{11FDC}\\u{11FE1}-\\u{11FF1}\\u{16FE2}\\u{1D200}-\\u{1D241}\\u{1D245}\\u{1D300}-\\u{1D356}\\u{1D6DB}\\u{1D715}\\u{1D74F}\\u{1D789}\\u{1D7C3}\\u{1EEF0}\\u{1EEF1}\\u{1F000}-\\u{1F02B}\\u{1F030}-\\u{1F093}\\u{1F0A0}-\\u{1F0AE}\\u{1F0B1}-\\u{1F0BF}\\u{1F0C1}-\\u{1F0CF}\\u{1F0D1}-\\u{1F0F5}\\u{1F10B}\\u{1F10C}\\u{1F12F}\\u{1F16A}-\\u{1F16C}\\u{1F260}-\\u{1F265}\\u{1F300}-\\u{1F6D5}\\u{1F6E0}-\\u{1F6EC}\\u{1F6F0}-\\u{1F6FA}\\u{1F700}-\\u{1F773}\\u{1F780}-\\u{1F7D8}\\u{1F7E0}-\\u{1F7EB}\\u{1F800}-\\u{1F80B}\\u{1F810}-\\u{1F847}\\u{1F850}-\\u{1F859}\\u{1F860}-\\u{1F887}\\u{1F890}-\\u{1F8AD}\\u{1F900}-\\u{1F90B}\\u{1F90D}-\\u{1F971}\\u{1F973}-\\u{1F976}\\u{1F97A}-\\u{1F9A2}\\u{1F9A5}-\\u{1F9AA}\\u{1F9AE}-\\u{1F9CA}\\u{1F9CD}-\\u{1FA53}\\u{1FA60}-\\u{1FA6D}\\u{1FA70}-\\u{1FA73}\\u{1FA78}-\\u{1FA7A}\\u{1FA80}-\\u{1FA82}\\u{1FA90}-\\u{1FA95}]", "u"),
    //Right To Left
    R: new RegExp("^[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05EA\u05EF-\u05F4\u07C0-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u083E\u0840-\u0858\u085E\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFB4F\\u{10800}-\\u{10805}\\u{10808}\\u{1080A}-\\u{10835}\\u{10837}\\u{10838}\\u{1083C}\\u{1083F}-\\u{10855}\\u{10857}-\\u{1089E}\\u{108A7}-\\u{108AF}\\u{108E0}-\\u{108F2}\\u{108F4}\\u{108F5}\\u{108FB}-\\u{1091B}\\u{10920}-\\u{10939}\\u{1093F}\\u{10980}-\\u{109B7}\\u{109BC}-\\u{109CF}\\u{109D2}-\\u{10A00}\\u{10A10}-\\u{10A13}\\u{10A15}-\\u{10A17}\\u{10A19}-\\u{10A35}\\u{10A40}-\\u{10A48}\\u{10A50}-\\u{10A58}\\u{10A60}-\\u{10A9F}\\u{10AC0}-\\u{10AE4}\\u{10AEB}-\\u{10AF6}\\u{10B00}-\\u{10B35}\\u{10B40}-\\u{10B55}\\u{10B58}-\\u{10B72}\\u{10B78}-\\u{10B91}\\u{10B99}-\\u{10B9C}\\u{10BA9}-\\u{10BAF}\\u{10C00}-\\u{10C48}\\u{10C80}-\\u{10CB2}\\u{10CC0}-\\u{10CF2}\\u{10CFA}-\\u{10CFF}\\u{10F00}-\\u{10F27}\\u{10FE0}-\\u{10FF6}\\u{1E800}-\\u{1E8C4}\\u{1E8C7}-\\u{1E8CF}\\u{1E900}-\\u{1E943}\\u{1E94B}\\u{1E950}-\\u{1E959}\\u{1E95E}\\u{1E95F}]", "u")

}