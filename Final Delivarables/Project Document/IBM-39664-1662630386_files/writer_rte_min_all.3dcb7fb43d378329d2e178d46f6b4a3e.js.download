var ProseMirror=function(e){"use strict";function t(e){"@babel/helpers - typeof";return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function o(e,t){return t={exports:{}},e(t,t.exports),t.exports}function i(e){this.content=e}function s(e,t){return e+t*ue}function a(e){return e&pe}function c(e){return(e-(e&pe))/ue}function f(e){var t=Error.call(this,e);return t.__proto__=f.prototype,t}function l(){throw new Error("Override me")}function p(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var s=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}return!1}function u(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function h(e){for(var t=e.parent,n=t.content.cutByIndex(e.startIndex,e.endIndex),r=e.depth;;--r){var o=e.$from.node(r),i=e.$from.index(r),s=e.$to.indexAfter(r);if(r<e.depth&&o.canReplace(i,s,n))return r;if(0==r||o.type.spec.isolating||!u(o,i,s))break}}function d(e,t,n,r){void 0===r&&(r=e);var o=v(e,t),i=o&&g(r,t);return i?o.map(m).concat({type:t,attrs:n}).concat(i.map(m)):null}function m(e){return{type:e,attrs:null}}function v(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var s=i.length?i[0]:t;return n.canReplaceWith(r,o,s)?i:null}function g(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),s=t.contentMatch.findWrapping(i.type);if(!s)return null;for(var a=s.length?s[s.length-1]:t,c=a.contentMatch,f=r;c&&f<o;f++)c=c.matchType(n.child(f).type);return c&&c.validEnd?s:null}function y(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}function x(e,t,n,r){void 0===n&&(n=1);var o=e.resolve(t),i=o.depth-n,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var a=o.depth-1,c=n-2;a>i;a--,c--){var f=o.node(a),l=o.index(a);if(f.type.spec.isolating)return!1;var p=f.content.cutByIndex(l,f.childCount),u=r&&r[c]||f;if(u!=f&&(p=p.replaceChild(0,u.type.create(u.attrs))),!f.canReplace(l+1,f.childCount)||!u.type.validContent(p))return!1}var h=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(h,h,d?d.type:o.node(i+1).type)}function w(e,t){var n=e.resolve(t),r=n.index();return b(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function b(e,t){return e&&t&&!e.isLeaf&&e.canAppend(t)}function k(e,t,n){void 0===n&&(n=-1);for(var r=e.resolve(t),o=r.depth;;o--){var i=void 0,s=void 0,a=r.index(o);if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):n>0?(i=r.node(o+1),a++,s=r.node(o).maybeChild(a)):(i=r.node(o).maybeChild(a-1),s=r.node(o+1)),i&&!i.isTextblock&&b(i,s)&&r.node(o).canReplace(a,a+1))return t;if(0==o)break;t=n<0?r.before(o):r.after(o)}}function S(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var s=r.depth-1;s>=0;s--){var a=r.indexAfter(s);if(r.node(s).canReplaceWith(a,a,n))return r.after(s+1);if(a<r.node(s).childCount)return null}}function M(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(var a=r.depth;a>=0;a--){var c=a==r.depth?0:r.pos<=(r.start(a+1)+r.end(a+1))/2?-1:1,f=r.index(a)+(c>0?1:0);if(1==s?r.node(a).canReplace(f,f,o):r.node(a).contentMatchAt(f).findWrapping(o.firstChild.type))return 0==c?r.pos:c<0?r.before(a+1):r.after(a+1)}return null}function O(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(O(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return ie.fromArray(r)}function C(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=se.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return T(o,i,r)?new be(t,n,r):new Oe(o,i,r).fit()}function T(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}function E(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(E(e.firstChild.content,t-1,n)))}function N(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(N(e.lastChild.content,t-1,n)))}function j(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function z(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,z(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(ie.empty,!0)))),e.copy(r)}function D(e,t,n,r,o){var i=e.node(t),s=o?e.indexAfter(t):e.index(t);if(s==i.childCount&&!n.compatibleContent(i.type))return null;var a=r.fillBefore(i.content,!0,s);return a&&!P(n,i.content,s)?a:null}function P(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}function A(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(A(i.content,t+1,n,r,i)))}if(t>r){var s=o.contentMatchAt(0),a=s.fillBefore(e).append(e);e=a.append(s.matchFragment(a).fillBefore(ie.empty,!0))}return e}function R(e,t){for(var n=[],r=Math.min(e.depth,t.depth),o=r;o>=0;o--){var i=e.start(o);if(i<e.pos-(e.depth-o)||t.end(o)>t.pos+(t.depth-o)||e.node(o).type.spec.isolating||t.node(o).type.spec.isolating)break;i==t.start(o)&&n.push(o)}return n}function I(e){var t=ot&&(e.ctrlKey||e.altKey||e.metaKey)||(et||rt)&&e.shiftKey&&e.key&&1==e.key.length,n=!t&&e.key||(e.shiftKey?Ye:Xe)[e.keyCode]||e.key||"Unidentified";return"Esc"==n&&(n="Escape"),"Del"==n&&(n="Delete"),"Left"==n&&(n="ArrowLeft"),"Up"==n&&(n="ArrowUp"),"Right"==n&&(n="ArrowRight"),"Down"==n&&(n="ArrowDown"),n}function V(e){var t=e.split(/-(?!$)/),n=t[t.length-1];"Space"==n&&(n=" ");for(var r,o,i,s,a=0;a<t.length-1;a++){var c=t[a];if(/^(cmd|meta|m)$/i.test(c))s=!0;else if(/^a(lt)?$/i.test(c))r=!0;else if(/^(c|ctrl|control)$/i.test(c))o=!0;else if(/^s(hift)?$/i.test(c))i=!0;else{if(!/^mod$/i.test(c))throw new Error("Unrecognized modifier name: "+c);ft?s=!0:o=!0}}return r&&(n="Alt-"+n),o&&(n="Ctrl-"+n),s&&(n="Meta-"+n),i&&(n="Shift-"+n),n}function B(e){var t=Object.create(null);for(var n in e)t[V(n)]=e[n];return t}function L(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n!==!1&&t.shiftKey&&(e="Shift-"+e),e}function $(e){return new ze({props:{handleKeyDown:F(e)}})}function F(e){var t=B(e);return function(e,n){var r,o=I(n),i=1==o.length&&" "!=o,s=t[L(o,n,!i)];if(s&&s(e.state,e.dispatch,e))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=Xe[n.keyCode])&&r!=o){var a=t[L(r,n,!0)];if(a&&a(e.state,e.dispatch,e))return!0}else if(i&&n.shiftKey){var c=t[L(o,n,!0)];if(c&&c(e.state,e.dispatch,e))return!0}return!1}}function _(e,t,n){var r=!1,o=!1;e.forEach(function(e){r=r||e.docChanged,o=o?o:e.meta.paste});var i=n.selection.ranges[0].$from.pos;if(!(!r||i<=1||o)){var s,a=n.doc.resolve(i),c=a.depth,f=a.parentOffset;f?s=i-1:(a=n.doc.resolve(i-2),s=i-2);var l=a.start(c),p=n.doc.textBetween(l,i,"`","`");if(p.endsWith(" ")||p.endsWith("`")){p=p.slice(0,p.length-1);var u=p.split(/[\s`]/),h=u.pop();return h&&{word:h,end:s,start:s-h.length}}}}function q(e,t,n){var r=n?new RegExp("(^|\\s|\\0)"+e+"([\\w-\\+]+[.]?\\s?[\\w-\\+]*)$"):new RegExp("(^|\\s)"+e+"([\\w-\\+]+)$"),o=new RegExp("(^|\\s)"+t+"([\\w-]+)$");return{mention:r,tag:o}}function J(e,t){var n,r=e.before(),o=e.doc.textBetween(r,e.pos,"\n",pt),i=q(t.mentionTrigger,t.hashtagTrigger,t.allowSpace),s=o.match(i.mention),a=t.hashtagTrigger&&o.match(i.tag),c=s||a;if(s?n="mention":a&&(n="tag"),c){c[0].startsWith(" ")||c[0].startsWith(pt)?(c.index=c.index+1,c[0]=c[0].substring(1,c[0].length)):c.index=c.index;var f=e.start()+c.index,l=f+c[0].length,p=c[2];return{range:{from:f,to:l},queryText:p,type:n}}}function K(e,t){var n={mentionTrigger:"@",hashtagTrigger:"#",allowSpace:!0,getSuggestions:function(e,t,n){n([])},getSuggestionsHTML:function(){},activeClass:"suggestion-item-active",suggestionTextClass:"prosemirror-suggestion",maxNoOfSuggestions:6,delay:200,extras:{}},e=Object.assign({},n,e),r=null,o=document.createElement("div");o.style.zIndex="1000";var i=function(e,t,n,r){if(!n.length)return a();o.innerHTML=r.getSuggestionsHTML(n,t.type),o.querySelectorAll(".suggestion-item").forEach(function(n,o){n.addEventListener("click",function(){h(e,t,r),e.focus()}),n.addEventListener("mouseover",function(){l(o,t,r)}),n.addEventListener("mouseout",function(){l(o,t,r)})}),f(t.index,r.activeClass);var i=e.domAtPos(e.state.selection.$from.pos),c=i.node,p=c.querySelector("."+r.suggestionTextClass);return p?void s(o,p):a()},s=function(e,t){var n=t&&t.getBoundingClientRect();document.body.appendChild(e),e.style.display="block",e.style.position="fixed",e.style.left="",e.style.right="";var r=e.offsetWidth,o=document.documentElement.clientWidth,i=document.documentElement.clientHeight;if(n.left+r+1<o?e.style.left=n.left+"px":e.style.right=o-n.right+"px",t.offsetHeight+n.top+e.scrollHeight<i)var s=t.offsetHeight+n.top;else var s=n.top-e.scrollHeight;e.style.top=s+"px"},a=function(){o.style.display="none"},c=function(e,t){var n=o.querySelector(".suggestion-item-list").children,r=n[e];r.classList.remove(t)},f=function(e,t){var n=o.querySelector(".suggestion-item-list").children;if(n.length){var r=n[e];return r.classList.add(t),!0}return!1},l=function(e,t,n){c(t.index,n.activeClass),t.index=e,f(t.index,n.activeClass)},p=function(e,t,n){c(t.index,n.activeClass),t.index++,t.index=t.index===t.suggestions.length?0:t.index,f(t.index,n.activeClass)},u=function(e,t,n){c(t.index,n.activeClass),t.index--,t.index=t.index===-1?t.suggestions.length-1:t.index,f(t.index,n.activeClass)},h=function(e,t,n){var r,o=t.suggestions[t.index];r="mention"===t.type?{name:o.fullname,zuid:o.zuid,email:o.emailid}:{tag:o.tag};var i=e.state.schema.nodes[t.type].create(r),s=e.state.tr.replaceWith(t.range.from,t.range.to,i),a=e.state.apply(s);e.updateState(a)};return new ze({key:t.pluginKeys.mentions,state:{init:function(){return dt()},apply:function(t,n){var r=dt(),o=t.selection;if(o.from!==o.to)return r;var i=o.$from,s=J(i,e);return s&&(r.active=!0,r.range=s.range,r.type=s.type,r.text=s.queryText),r}},props:{handleKeyDown:function(t,n){var o=this.getState(t.state);if(!o.active||!o.suggestions.length)return!1;var i,s,c,f;return c=13===n.keyCode,i=40===n.keyCode,s=38===n.keyCode,f=27===n.keyCode,i?(p(t,o,e),!0):s?(u(t,o,e),!0):c?(h(t,o,e),!0):!!f&&(clearTimeout(r),a(),this.state=dt(),!0)},handleDOMEvents:{blur:function(e,t){var n=this.getState(e.state);if(n&&n.suggestions.length)return setTimeout(function(){a()},500),!1},focus:function(n,r){var o=this.getState(n.state);o&&o.suggestions.length&&e.getSuggestions(o.type,o.text,function(t){o.suggestions=t,i(n,o,t,e)},e.extras,t)}},decorations:function(t){var n=this.getState(t),r=n.active,o=n.range;return r?Ie.create(t.doc,[Re.inline(o.from,o.to,{nodeName:"a",class:e.suggestionTextClass})]):null},handleExternalScroll:function(){ht(a,200)}},view:function(){var n=this;return{update:function(o){var s=n.key.getState(o.state);return a(),s.text?void(r=ut(function(){e.getSuggestions(s.type,s.text,function(t){s.suggestions=t.slice(0,e.maxNoOfSuggestions),i(o,s,s.suggestions,e)},e.extras,t)},e.delay,n)):void clearTimeout(r)}}}})}function H(e){return e.append({mention:mt})}function W(e){return e.append({tag:vt})}function U(e){return e.append({emoji:gt})}function G(e,t){if(e=e.startsWith(":")?e.slice(1):e,e=e.endsWith(":")?e.slice(0,-1):e,"UNICODE"===t)return{UNICODE:bt(e)};if("ZOMOJI"===t)return{ZOMOJI:kt(e)};var n=bt(e),r=kt(e);return{UNICODE:n,ZOMOJI:r}}function Z(e){return yt[e]}function X(){return yt}function Y(){return xt}function Q(){return wt}function ee(e){return e.slice(1,-1)}function te(e,t,n){function r(t){var n=360,r=document.body.getBoundingClientRect(),o=e.editorView.dom.parentElement.getBoundingClientRect(),i=o.y+o.height,s=r.width-(o.x+o.width),a=n;t.type===j.dropdown&&(a=o.width>n?o.width:n);var c=document.documentElement.clientHeight;if(V){var f=V.firstElementChild.offsetHeight;i+f>=c&&(i=o.y-f-5),V.style.position="fixed",V.style.right=s+"px",V.style.top=i+"px",V.style.width=a+"px",V.style["z-index"]=1020}}function o(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect();return n.top<r.top?n.top>r.top:n.bottom<r.bottom}function i(){return V}function s(e,t){P.clear(),i()?(f(e,t),U(e,t),r(e)):$(e,t),e.type===j.dropdown&&C(e)?(u(V,e),h()):e.type===j.popup&&k()}function a(){V&&(V.style.display="none")}function c(){var e=V.getElementsByClassName("emoji-tab");e.length&&w(e[0]);var t=V.querySelector("#search-box");t&&(t.value="")}function f(e){V&&"none"===V.style.display&&(V.style.display="block",e.type===j.popup&&c())}function l(){i()&&(document.body.removeChild(V),V=null)}function p(e,t){var n=V.getElementsByClassName("emoji");n[e.index]&&n[e.index].classList.remove("focus-emoji"),t&&t.classList.add("focus-emoji"),e.index=parseInt(t.getAttribute("index")),o(t,t.offsetParent)||t.scrollIntoView&&t.scrollIntoView()}function u(e,t){var n=e.getElementsByClassName("emoji-type-2")[0];p(t,n)}function h(){var e=V.querySelector("#emoji-dropdown-container").offsetWidth,t=V.querySelector(".emoji-type-2").offsetWidth;B.setFactor(Math.floor((e-10)/t))}function d(e,t){var n=e.index,r=C(e);if("horizontal"===t)n=(n+1)%r;else{var o=B.getFactor(),i=e.index%o;n+o<r?n+=o:n=i}var s=V.getElementsByClassName("emoji");p(e,s[n])}function m(e,t){var n=e.index,r=C(e);if("horizontal"===t)n=0!==n?n-1:r-1;else{var o=B.getFactor(),i=e.index%o;if(n-o>=0)n-=o;else{var s=r%o;n=r-(s>i?s-i:s+(o-i))}}var a=V.getElementsByClassName("emoji");p(e,a[n])}function v(e){var t=T(e,e.index);M(t,e)}function g(t){function n(t){var n=setTimeout(function(){var t=e.editorView.state.tr.setMeta("hideEmojiDropDown",{});e.editorView.dispatch(t)},300);P.set(n)}t.addEventListener("input",y),t.addEventListener("blur",n),t.addEventListener("keydown",function(t){if(27==t.keyCode){var n=e.editorView.state.tr.setMeta("hideEmojiDropDown",{});e.editorView.dispatch(n)}else if(9==t.keyCode){var r=V.getElementsByClassName("emoji-tab");if(r.length){var o=V.getElementsByClassName("tab-sel")[0];b("unicode"===o.getAttribute("tabName")?r[1]:r[0])}t.preventDefault()}})}function y(t){var n=e.editorView,r=n.state.tr.setMeta("searchTextUpdated",{text:t.target.value});n.dispatch(r)}function x(e,t){t.onclick=function(t){var n=t.target,r=n.getAttribute("index")||n.parentElement.getAttribute("index");n=T(e,r),M(n,e)}}function w(e){for(var t=V.getElementsByClassName("emoji-tab"),n=0;n<t.length;n++)e!=t[n]&&t[n].classList.remove("tab-sel");e.classList.add("tab-sel")}function b(t){P.clear(),w(t);var n=e.editorView,r=t.getAttribute("tabName"),o=n.state.tr.setMeta("tabSwitched",{tab:N[r]});n.dispatch(o),k()}function k(){var e=V.querySelector("#search-box");e&&e.focus()}function S(){for(var e=V.getElementsByClassName("emoji-tab"),t=function(e){var t=e.currentTarget;b(t)},n=0;n<e.length;n++)e[n].onclick=t}function M(t,n){var r=t.type,o=e.editorView,i=n.range.from,s=n.range.to;if(r===N.unicode)var a=Z(":"+t.name+":"),c=a.map(function(e){return"0"+e.slice(2)}),f=o.state.schema.text(String.fromCodePoint.apply(null,c));else{if(!o.state.schema.nodes.emoji)return;var l=t.name,f=o.state.schema.nodes.emoji.create({emojiName:l})}O(f,i,s,o),e.focus()}function O(e,t,n,r){var o=t===n&&t>1?t-1:t,i=r.state.doc.nodeAt(o),s=i&&i.marks||[],a=r.state.schema.text(" ",s),c=[e,a],f=r.state.tr.replaceWith(t,n,c);r.dispatch(f)}function C(e,t){var n=e.emojiMatched;return t=t?t:e.emojiType,t===N.unicode?n[t]&&n[t].length:t===N.zomoji?n[t]&&n[t].length:n[N.unicode].length+n[N.zomoji].length}function T(e,t){var n,r=e.emojiType;if(r!=N.combined)n=e.emojiMatched[r][t],n.type=r;else{var o=e.emojiMatched[N.unicode].length;if(t<o){var i=N.unicode;n=e.emojiMatched[i][t],n.type=i}else{var s=N.zomoji;t-=o,n=e.emojiMatched[s][t],n.type=s}}return n}function E(e){var t=e.before(),n=e.doc.textBetween(t,e.pos,"\n","\0"),r=new RegExp("(^|\\s|\\0):([\\S]*)$"),o=n.match(r);if(o){o[0].startsWith(" ")||o[0].startsWith(z)?(o.index=o.index+1,o[0]=o[0].substring(1,o[0].length)):o.index=o.index;var i=e.start()+o.index,s=i+o[0].length,a=o[0];return{range:{from:i,to:s},text:a}}return{range:{from:e.start(),to:e.start()},text:""}}var N={unicode:"UNICODE",zomoji:"ZOMOJI",combined:"COMBINED"},j={popup:"POPUP",dropdown:"DROPDOWN"},z="\0",D=lt(),P={timeOutId:"",set:function(e){clearTimeout(this.timeOutId),this.timeOutId=e},clear:function(){clearTimeout(this.timeOutId)}},A=document.getElementById("emoji-dropdown-template").innerHTML,R=Handlebars.compile(A),I=NodeSerializer(t,"emoji",{hasZomoji:n}),V=null,B={_factor:1,setFactor:function(e){this._factor=e},getFactor:function(){return this._factor}},L=function(e){var t=e.parentElement.querySelector("#rte-menubar");return t&&t.querySelector("#rte-format")},$=function(e,t){V=document.createElement("div"),V.classList.add("emoji-parent-container"),document.body.append(V),F(e),r(e)},F=function(e){var t=e.type===j.popup,r=t&&n,o=R({searchBox:t,hasTabs:r});V.innerHTML=o,J(e),t&&te(e)},q=function(e){var t=V.querySelector("#emoji-container"),n=V.querySelector("#combined-container");if(!t)return n;var r=t.querySelector("#unicode-cont"),o=t.querySelector("#zomoji-cont");return e.emojiType===N.unicode?(r.classList.remove("ui-zomoji-active"),r):e.emojiType===N.zomoji?(r.classList.add("ui-zomoji-active"),o):void 0},J=function(e){var t=q(e),n=K(e);t.innerHTML=n,x(e,t)},K=function(e){return e.type===j.popup?H(e):W(e)},H=function(e){var t=document.getElementById("emoji-container-template-1").innerHTML,n=Handlebars.compile(t),r={isEmoji:e.emojiType===N.unicode,isZomoji:e.emojiType===N.zomoji};r.emoji=r.isEmoji?e.emojiMatched[N.unicode]:e.emojiMatched[N.zomoji];var o=n(r);return o},W=function(e){var t=document.getElementById("emoji-container-template-2").innerHTML,n=Handlebars.compile(t),r=!!C(e,N.unicode),o=!!C(e,N.zomoji),i={};r&&(i.hasEmoji=r,i.emoji=e.emojiMatched[N.unicode]),o&&(i.hasZomoji=o,i.zomoji=e.emojiMatched[N.zomoji]);var s=n(i);return s},U=function(e){var t=V.querySelector("#search-container");e.type===j.popup&&t||e.type===j.dropdown&&!t?J(e):F(e)},te=function(e){n&&S();var t=V.querySelector("#search-box");t&&(g(t),t.focus())},ne=function(e){var t=G(e.text,e.emojiType),n=0;for(key in t){var r=t[key];r.forEach(function(e){e.index=n++})}return t},re=function(){return{active:!1,text:"",range:{from:"",to:""},emojiMatched:{},emojiType:N.unicode,type:j.popup,index:0}};return new ze({key:e.pluginKeys.emoji,state:{init:function(){return re()},apply:function(e,t){var r=re(),o=e.selection,i=e.getMeta("showEmojiDropDown"),s=e.getMeta("searchTextUpdated"),a=e.getMeta("tabSwitched"),c=i||s||a,f=e.getMeta("hideEmojiDropDown");if(f)return r;if(!c&&o.from!==o.to)return r;if(c)r.active=!0,s?r.text=s.text:t.type===j.popup&&(r.text=t.text),a?r.emojiType=a.tab:t.type===j.popup&&(r.emojiType=t.emojiType),r.emojiMatched=ne(r),r.range.from=o.from,r.range.to=o.to;else{r.type=j.dropdown;var l=E(e.selection.$from);l.text&&(r.text=l.text,r.range=l.range,n&&(r.emojiType=N.combined),r.emojiMatched=ne(r),C(r)&&(r.active=!0))}return r}},props:{handleKeyDown:function(e,t){var n=this.getState(e.state);if(!n.active||n.type===j.popup)return!1;var r,o,i,s,c,f;return c=13===t.keyCode,f=27===t.keyCode,s=37===t.keyCode,o=38===t.keyCode,i=39===t.keyCode,r=40===t.keyCode,f?(a(),!0):r?(d(n,"vertical"),!0):s?(m(n,"horizontal"),!0):o?(m(n,"vertical"),!0):i?(d(n,"horizontal"),!0):!!c&&(v(n),!0)},transformPasted:function(e){var t=I.serializeFragment(e.content),n=new se(t,e.openStart,e.openEnd);return n},handleDOMEvents:{blur:function(e,t){var n=this.getState(e.state);if(n){var r=setTimeout(function(){a()},500);return P.set(r),!1}},focus:function(e,t){var n=this.getState(e.state),r=L(e.dom),o=r&&r.querySelector("#rte-format");o&&n.active&&s(o,n)}},handleExternalScroll:function(){D(a,200)}},appendTransaction:function(e,t,r){var o=_(e,t,r);if(o){var i=o.word,s=Y(),a=X(),c=Q(),f=s[i]||i,l=a[f],p=c[f];if(l){var u=l.map(function(e){return"0"+e.slice(2)}),h=r.tr.replaceWith(o.start,o.end,r.schema.text(String.fromCodePoint.apply(null,u)));return h}if(n&&p){var d=r.tr.replaceWith(o.start,o.end,r.schema.nodes.emoji.create({emojiName:ee(f),class:p}));return d}}},view:function(){var e=this;return{update:function(t){var n=e.key.getState(t.state),r=L(t.dom);r&&(n.active?s(n,r):a())},destroy:function(){l()}}}})}i.prototype={constructor:i,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return t==-1?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),s=r.content.slice();return o==-1?s.push(n||e,t):(s[o+1]=t,n&&(s[o]=n)),new i(s)},remove:function(e){var t=this.find(e);if(t==-1)return this;var n=this.content.slice();return n.splice(t,2),new i(n)},addToStart:function(e,t){return new i([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new i(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),s=r.find(e);return o.splice(s==-1?o.length:s,0,t,n),new i(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return e=i.from(e),e.size?new i(e.content.concat(this.subtract(e).content)):this},append:function(e){return e=i.from(e),e.size?new i(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=i.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},i.from=function(e){if(e instanceof i)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new i(t)};var ne=i,re=o(function(e,n){function r(e){return e&&"object"===t(e)&&"default"in e?e.default:e}function o(e,t,n){for(var r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;var i=e.child(r),s=t.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(var a=0;i.text[a]==s.text[a];a++)n++;return n}if(i.content.size||s.content.size){var c=o(i.content,s.content,n+1);if(null!=c)return c}n+=i.nodeSize}else n+=i.nodeSize}}function i(e,t,n,r){for(var o=e.childCount,s=t.childCount;;){if(0==o||0==s)return o==s?null:{a:n,b:r};var a=e.child(--o),c=t.child(--s),f=a.nodeSize;if(a!=c){if(!a.sameMarkup(c))return{a:n,b:r};if(a.isText&&a.text!=c.text){for(var l=0,p=Math.min(a.text.length,c.text.length);l<p&&a.text[a.text.length-l-1]==c.text[c.text.length-l-1];)l++,n--,r--;return{a:n,b:r}}if(a.content.size||c.content.size){var u=i(a.content,c.content,n-1,r-1);if(u)return u}n-=f,r-=f}else n-=f,r-=f}}function s(e,t){return U.index=e,U.offset=t,U}function a(e,n){if(e===n)return!0;if(!e||"object"!=t(e)||!n||"object"!=t(n))return!1;var r=Array.isArray(e);if(Array.isArray(n)!=r)return!1;if(r){if(e.length!=n.length)return!1;for(var o=0;o<e.length;o++)if(!a(e[o],n[o]))return!1}else{for(var i in e)if(!(i in n&&a(e[i],n[i])))return!1;for(var s in n)if(!(s in e))return!1}return!0}function c(e){var t=Error.call(this,e);return t.__proto__=c.prototype,t}function f(e,t,n){var r=e.findIndex(t),o=r.index,i=r.offset,s=e.maybeChild(o),a=e.findIndex(n),c=a.index,l=a.offset;if(i==t||s.isText){if(l!=n&&!e.child(c).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(o!=c)throw new RangeError("Removing non-flat range");return e.replaceChild(o,s.copy(f(s.content,t-i-1,n-i-1)))}function l(e,t,n,r){var o=e.findIndex(t),i=o.index,s=o.offset,a=e.maybeChild(i);if(s==t||a.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));var c=l(a.content,t-s-1,n);return c&&e.replaceChild(i,a.copy(c))}function p(e,t,n){if(n.openStart>e.depth)throw new c("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new c("Inconsistent open depths");return u(e,t,n,0)}function u(e,t,n,r){var o=e.index(r),i=e.node(r);if(o==t.index(r)&&r<e.depth-n.openStart){var s=u(e,t,n,r+1);return i.copy(i.content.replaceChild(o,s))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){var a=w(n,e),c=a.start,f=a.end;return g(i,y(e,c,f,t,r))}var l=e.parent,p=l.content;return g(l,p.cut(0,e.parentOffset).append(n.content).append(p.cut(t.parentOffset)))}return g(i,x(e,t,r))}function h(e,t){if(!t.type.compatibleContent(e.type))throw new c("Cannot join "+t.type.name+" onto "+e.type.name)}function d(e,t,n){var r=e.node(n);return h(r,t.node(n)),r}function m(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function v(e,t,n,r){var o=(t||e).node(n),i=0,s=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(m(e.nodeAfter,r),i++));for(var a=i;a<s;a++)m(o.child(a),r);t&&t.depth==n&&t.textOffset&&m(t.nodeBefore,r)}function g(e,t){if(!e.type.validContent(t))throw new c("Invalid content for node "+e.type.name);return e.copy(t)}function y(e,t,n,r,o){var i=e.depth>o&&d(e,t,o+1),s=r.depth>o&&d(n,r,o+1),a=[];return v(null,e,o,a),i&&s&&t.index(o)==n.index(o)?(h(i,s),m(g(i,y(e,t,n,r,o+1)),a)):(i&&m(g(i,x(e,t,o+1)),a),v(t,n,o,a),s&&m(g(s,x(n,r,o+1)),a)),v(r,null,o,a),new H(a)}function x(e,t,n){var r=[];if(v(null,e,n,r),e.depth>n){var o=d(e,t,n+1);m(g(o,x(e,t,n+1)),r)}return v(t,null,n,r),new H(r)}function w(e,t){for(var n=t.depth-e.openStart,r=t.node(n),o=r.copy(e.content),i=n-1;i>=0;i--)o=t.node(i).copy(H.from(o));return{start:o.resolveNoCache(e.openStart+n),end:o.resolveNoCache(o.content.size-e.openEnd-n)}}function b(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}function k(e){var t=[];do t.push(S(e));while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function S(e){var t=[];do t.push(M(e));while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function M(e){for(var t=E(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=C(e,t)}return t}function O(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function C(e,t){var n=O(e),r=n;return e.eat(",")&&(r="}"!=e.next?O(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function T(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var s=n[i];s.groups.indexOf(t)>-1&&o.push(s)}return 0==o.length&&e.err("No node type or group '"+t+"' found"),o}function E(e){if(e.eat("(")){var t=k(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=T(e,e.next).map(function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}});return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}function N(e){function t(){return i.push([])-1}function n(e,t,n){var r={term:n,to:t};return i[e].push(r),r}function r(e,t){e.forEach(function(e){return e.to=t})}function o(e,i){if("choice"==e.type)return e.exprs.reduce(function(e,t){return e.concat(o(t,i))},[]);if("seq"==e.type)for(var s=0;;s++){var a=o(e.exprs[s],i);if(s==e.exprs.length-1)return a;r(a,i=t())}else{if("star"==e.type){var c=t();return n(i,c),r(o(e.expr,c),c),[n(c)]}if("plus"==e.type){var f=t();return r(o(e.expr,i),f),r(o(e.expr,f),f),[n(f)]}if("opt"==e.type)return[n(i)].concat(o(e.expr,i));if("range"==e.type){for(var l=i,p=0;p<e.min;p++){var u=t();r(o(e.expr,l),u),l=u}if(e.max==-1)r(o(e.expr,l),l);else for(var h=e.min;h<e.max;h++){var d=t();n(l,d),r(o(e.expr,l),d),l=d}return[n(l)]}if("name"==e.type)return[n(i,null,e.value)]}}var i=[[]];return r(o(e,0),t()),i}function j(e,t){return e-t}function z(e,t){function n(t){var o=e[t];if(1==o.length&&!o[0].term)return n(o[0].to);r.push(t);for(var i=0;i<o.length;i++){var s=o[i],a=s.term,c=s.to;a||r.indexOf(c)!=-1||n(c)}}var r=[];return n(t),r.sort(j)}function D(e){function t(r){var o=[];r.forEach(function(t){e[t].forEach(function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),s=i>-1&&o[i+1];z(e,r).forEach(function(e){s||o.push(n,s=[]),s.indexOf(e)==-1&&s.push(e)})}})});for(var i=n[r.join(",")]=new le(r.indexOf(e.length-1)>-1),s=0;s<o.length;s+=2){var a=o[s+1].sort(j);i.next.push(o[s],n[a.join(",")]||t(a))}return i}var n=Object.create(null);return t(z(e,0))}function P(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,s=[],a=0;a<o.next.length;a+=2){var c=o.next[a],f=o.next[a+1];s.push(c.name),!i||c.isText||c.hasRequiredAttrs()||(i=!1),r.indexOf(f)==-1&&r.push(f)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position")}}function A(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function R(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function I(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new ve(e[n]);return t}function V(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],s=i;if(i)n.push(i);else for(var a in e.marks){var c=e.marks[a];("_"==o||c.spec.group&&c.spec.group.split(" ").indexOf(o)>-1)&&n.push(s=c)}if(!s)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}function B(e){return(e?Me:0)|("full"===e?Oe:0)}function L(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&Se.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}function $(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function F(e){for(var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];t=n.exec(e);)r.push(t[1],t[2].trim());return r}function _(e){var t={};for(var n in e)t[n]=e[n];return t}function q(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function J(e){return e.document||window.document}Object.defineProperty(n,"__esModule",{value:!0});var K=r(ne),H=function(e,t){var n=this;if(this.content=e,this.size=t||0,null==t)for(var r=0;r<e.length;r++)n.size+=e[r].nodeSize},W={firstChild:{},lastChild:{},childCount:{}};H.prototype.nodesBetween=function(e,t,n,r,o){var i=this;void 0===r&&(r=0);for(var s=0,a=0;a<t;s++){var c=i.content[s],f=a+c.nodeSize;if(f>e&&n(c,r+a,o,s)!==!1&&c.content.size){var l=a+1;c.nodesBetween(Math.max(0,e-l),Math.min(c.content.size,t-l),n,r+l)}a=f}},H.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},H.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,function(s,a){s.isText?(o+=s.text.slice(Math.max(e,a)-a,t-a),i=!n):s.isLeaf&&r?(o+=r,i=!n):!i&&s.isBlock&&(o+=n,i=!0)},0),o},H.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new H(r,this.size+e.size)},H.prototype.cut=function(e,t){var n=this;if(null==t&&(t=this.size),0==e&&t==this.size)return this;var r=[],o=0;if(t>e)for(var i=0,s=0;s<t;i++){var a=n.content[i],c=s+a.nodeSize;c>e&&((s<e||c>t)&&(a=a.isText?a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),o+=a.nodeSize),s=c;}return new H(r,o)},H.prototype.cutByIndex=function(e,t){return e==t?H.empty:0==e&&t==this.content.length?this:new H(this.content.slice(e,t))},H.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new H(r,o)},H.prototype.addToStart=function(e){return new H([e].concat(this.content),this.size+e.nodeSize)},H.prototype.addToEnd=function(e){return new H(this.content.concat(e),this.size+e.nodeSize)},H.prototype.eq=function(e){var t=this;if(this.content.length!=e.content.length)return!1;for(var n=0;n<this.content.length;n++)if(!t.content[n].eq(e.content[n]))return!1;return!0},W.firstChild.get=function(){return this.content.length?this.content[0]:null},W.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},W.childCount.get=function(){return this.content.length},H.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},H.prototype.maybeChild=function(e){return this.content[e]},H.prototype.forEach=function(e){for(var t=this,n=0,r=0;n<this.content.length;n++){var o=t.content[n];e(o,r,n),r+=o.nodeSize}},H.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),o(this,e,t)},H.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),i(this,e,t,n)},H.prototype.findIndex=function(e,t){var n=this;if(void 0===t&&(t=-1),0==e)return s(0,e);if(e==this.size)return s(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var r=0,o=0;;r++){var i=n.child(r),a=o+i.nodeSize;if(a>=e)return a==e||t>0?s(r+1,a):s(r,o);o=a}},H.prototype.toString=function(){return"<"+this.toStringInner()+">"},H.prototype.toStringInner=function(){return this.content.join(", ")},H.prototype.toJSON=function(){return this.content.length?this.content.map(function(e){return e.toJSON()}):null},H.fromJSON=function(e,t){if(!t)return H.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new H(t.map(e.nodeFromJSON))},H.fromArray=function(e){if(!e.length)return H.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new H(t||e,n)},H.from=function(e){return e?e instanceof H?e:Array.isArray(e)?this.fromArray(e):new H([e],e.nodeSize):H.empty},Object.defineProperties(H.prototype,W);var U={index:0,offset:0};H.empty=new H([],0);var G=function(e,t){this.type=e,this.attrs=t};G.prototype.addToSet=function(e){for(var t,n=this,r=!1,o=0;o<e.length;o++){var i=e[o];if(n.eq(i))return e;if(n.type.excludes(i.type))t||(t=e.slice(0,o));else{if(i.type.excludes(n.type))return e;!r&&i.type.rank>n.type.rank&&(t||(t=e.slice(0,o)),t.push(n),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t},G.prototype.removeFromSet=function(e){for(var t=this,n=0;n<e.length;n++)if(t.eq(e[n]))return e.slice(0,n).concat(e.slice(n+1));return e},G.prototype.isInSet=function(e){for(var t=this,n=0;n<e.length;n++)if(t.eq(e[n]))return!0;return!1},G.prototype.eq=function(e){return this==e||this.type==e.type&&a(this.attrs,e.attrs)},G.prototype.toJSON=function(){var e=this,t={type:this.type.name};for(var n in e.attrs){t.attrs=e.attrs;break}return t},G.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},G.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},G.setFrom=function(e){if(!e||0==e.length)return G.none;if(e instanceof G)return[e];var t=e.slice();return t.sort(function(e,t){return e.type.rank-t.type.rank}),t},G.none=[],c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,c.prototype.name="ReplaceError";var Z=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},X={size:{}};X.size.get=function(){return this.content.size-this.openStart-this.openEnd},Z.prototype.insertAt=function(e,t){var n=l(this.content,e+this.openStart,t,null);return n&&new Z(n,this.openStart,this.openEnd)},Z.prototype.removeBetween=function(e,t){return new Z(f(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},Z.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},Z.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},Z.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},Z.fromJSON=function(e,t){if(!t)return Z.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new Z(H.fromJSON(e,t.content),t.openStart||0,t.openEnd||0)},Z.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new Z(e,n,r)},Object.defineProperties(Z.prototype,X),Z.empty=new Z(H.empty,0,0);var Y=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},Q={parent:{},doc:{},textOffset:{},nodeAfter:{},nodeBefore:{}};Y.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},Q.parent.get=function(){return this.node(this.depth)},Q.doc.get=function(){return this.node(0)},Y.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},Y.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},Y.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},Y.prototype.start=function(e){return e=this.resolveDepth(e),0==e?0:this.path[3*e-1]+1},Y.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},Y.prototype.before=function(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},Y.prototype.after=function(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},Q.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},Q.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},Q.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},Y.prototype.marks=function e(){var t=this.parent,n=this.index();if(0==t.content.size)return G.none;if(this.textOffset)return t.child(n).marks;var r=t.maybeChild(n-1),o=t.maybeChild(n);if(!r){var i=r;r=o,o=i}for(var e=r.marks,s=0;s<e.length;s++)e[s].type.spec.inclusive!==!1||o&&e[s].isInSet(o.marks)||(e=e[s--].removeFromSet(e));return e},Y.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)n[o].type.spec.inclusive!==!1||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},Y.prototype.sharedDepth=function(e){for(var t=this,n=this.depth;n>0;n--)if(t.start(n)<=e&&t.end(n)>=e)return n;return 0},Y.prototype.blockRange=function(e,t){var n=this;if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=n.end(r)&&(!t||t(n.node(r))))return new oe(n,e,r)},Y.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},Y.prototype.max=function(e){return e.pos>this.pos?e:this},Y.prototype.min=function(e){return e.pos<this.pos?e:this},Y.prototype.toString=function(){for(var e=this,t="",n=1;n<=this.depth;n++)t+=(t?"/":"")+e.node(n).type.name+"_"+e.index(n-1);return t+":"+this.parentOffset},Y.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var s=i.content.findIndex(o),a=s.index,c=s.offset,f=o-c;if(n.push(i,a,r+c),!f)break;if(i=i.child(a),i.isText)break;o=f-1,r+=c+1}return new Y(t,n,o)},Y.resolveCached=function(e,t){for(var n=0;n<ee.length;n++){var r=ee[n];if(r.pos==t&&r.doc==e)return r}var o=ee[te]=Y.resolve(e,t);return te=(te+1)%re,o},Object.defineProperties(Y.prototype,Q);var ee=[],te=0,re=12,oe=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},ie={start:{},end:{},parent:{},startIndex:{},endIndex:{}};ie.start.get=function(){return this.$from.before(this.depth+1)},ie.end.get=function(){return this.$to.after(this.depth+1)},ie.parent.get=function(){return this.$from.node(this.depth)},ie.startIndex.get=function(){return this.$from.index(this.depth)},ie.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(oe.prototype,ie);var se=Object.create(null),ae=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||H.empty,this.marks=r||G.none},ce={nodeSize:{},childCount:{},textContent:{},firstChild:{},lastChild:{},isBlock:{},isTextblock:{},inlineContent:{},isInline:{},isText:{},isLeaf:{},isAtom:{}};ce.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},ce.childCount.get=function(){return this.content.childCount},ae.prototype.child=function(e){return this.content.child(e)},ae.prototype.maybeChild=function(e){return this.content.maybeChild(e)},ae.prototype.forEach=function(e){this.content.forEach(e)},ae.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},ae.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},ce.textContent.get=function(){return this.textBetween(0,this.content.size,"")},ae.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},ce.firstChild.get=function(){return this.content.firstChild},ce.lastChild.get=function(){return this.content.lastChild},ae.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},ae.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},ae.prototype.hasMarkup=function(e,t,n){return this.type==e&&a(this.attrs,t||e.defaultAttrs||se)&&G.sameSet(this.marks,n||G.none)},ae.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},ae.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},ae.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},ae.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return Z.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),s=r.start(i),a=r.node(i),c=a.content.cut(r.pos-s,o.pos-s);return new Z(c,r.depth-i,o.depth-i)},ae.prototype.replace=function(e,t,n){return p(this.resolve(e),this.resolve(t),n)},ae.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(t=t.maybeChild(r),!t)return null;if(o==e||t.isText)return t;e-=o+1}},ae.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},ae.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},ae.prototype.resolve=function(e){return Y.resolveCached(this,e)},ae.prototype.resolveNoCache=function(e){return Y.resolve(this,e)},ae.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,function(e){return n.isInSet(e.marks)&&(r=!0),!r}),r},ce.isBlock.get=function(){return this.type.isBlock},ce.isTextblock.get=function(){return this.type.isTextblock},ce.inlineContent.get=function(){return this.type.inlineContent},ce.isInline.get=function(){return this.type.isInline},ce.isText.get=function(){return this.type.isText},ce.isLeaf.get=function(){return this.type.isLeaf},ce.isAtom.get=function(){return this.type.isAtom},ae.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),b(this.marks,e)},ae.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},ae.prototype.canReplace=function(e,t,n,r,o){var i=this;void 0===n&&(n=H.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var s=this.contentMatchAt(e).matchFragment(n,r,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(var c=r;c<o;c++)if(!i.type.allowsMarks(n.child(c).marks))return!1;return!0},ae.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},ae.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},ae.prototype.defaultContentType=function(e){return this.contentMatchAt(e).defaultType},ae.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));this.content.forEach(function(e){return e.check()})},ae.prototype.toJSON=function(){var e=this,t={type:this.type.name};for(var n in e.attrs){t.attrs=e.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(function(e){return e.toJSON()})),t},ae.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=H.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(ae.prototype,ce);var fe=function(e){function t(t,n,r,o){if(e.call(this,t,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{},nodeSize:{}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):b(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,n),t}(ae),le=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},pe={inlineContent:{},defaultType:{},edgeCount:{}};le.parse=function(e,t){var n=new ue(e,t);if(null==n.next)return le.empty;var r=k(n);n.next&&n.err("Unexpected trailing text");var o=D(N(r));return P(o,n),o},le.prototype.matchType=function(e){for(var t=this,n=0;n<this.next.length;n+=2)if(t.next[n]==e)return t.next[n+1];return null},le.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},pe.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},pe.defaultType.get=function(){for(var e=this,t=0;t<this.next.length;t+=2){var n=e.next[t];if(!n.isText&&!n.hasRequiredAttrs())return n}},le.prototype.compatible=function(e){for(var t=this,n=0;n<this.next.length;n+=2)for(var r=0;r<e.next.length;r+=2)if(t.next[n]==e.next[r])return!0;return!1},le.prototype.fillBefore=function(e,t,n){function r(i,s){var a=i.matchFragment(e,n);if(a&&(!t||a.validEnd))return H.from(s.map(function(e){return e.createAndFill()}));for(var c=0;c<i.next.length;c+=2){var f=i.next[c],l=i.next[c+1];if(!f.isText&&!f.hasRequiredAttrs()&&o.indexOf(l)==-1){o.push(l);var p=r(l,s.concat(f));if(p)return p}}}void 0===t&&(t=!1),void 0===n&&(n=0);var o=[this];return r(this,[])},le.prototype.findWrapping=function(e){for(var t=this,n=0;n<this.wrapCache.length;n+=2)if(t.wrapCache[n]==e)return t.wrapCache[n+1];var r=this.computeWrapping(e);return this.wrapCache.push(e,r),r},le.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],s=r;s.type;s=s.via)i.push(s.type);return i.reverse()}for(var a=0;a<o.next.length;a+=2){var c=o.next[a];c.isLeaf||c.hasRequiredAttrs()||c.name in t||r.type&&!o.next[a+1].validEnd||(n.push({match:c.contentMatch,type:c,via:r}),t[c.name]=!0)}}},pe.edgeCount.get=function(){return this.next.length>>1},le.prototype.edge=function(e){var t=e<<1;if(t>this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},le.prototype.toString=function(){function e(n){t.push(n);for(var r=1;r<n.next.length;r+=2)t.indexOf(n.next[r])==-1&&e(n.next[r])}var t=[];return e(this),t.map(function(e,n){for(var r=n+(e.validEnd?"*":" ")+" ",o=0;o<e.next.length;o+=2)r+=(o?", ":"")+e.next[o].name+"->"+t.indexOf(e.next[o+1]);return r}).join("\n")},Object.defineProperties(le.prototype,pe),le.empty=new le(!0);var ue=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.unshift()},he={next:{}};he.next.get=function(){return this.tokens[this.pos]},ue.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},ue.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(ue.prototype,he);var de=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=I(n.attrs),this.defaultAttrs=A(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},me={isInline:{},isTextblock:{},isLeaf:{},isAtom:{}};me.isInline.get=function(){return!this.isBlock},me.isTextblock.get=function(){return this.isBlock&&this.inlineContent},me.isLeaf.get=function(){return this.contentMatch==le.empty},me.isAtom.get=function(){return this.isLeaf||this.spec.atom},de.prototype.hasRequiredAttrs=function(e){var t=this;for(var n in t.attrs)if(t.attrs[n].isRequired&&(!e||!(n in e)))return!0;return!1},de.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},de.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:R(this.attrs,e)},de.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new ae(this,this.computeAttrs(e),H.from(t),G.setFrom(n))},de.prototype.createChecked=function(e,t,n){if(t=H.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new ae(this,this.computeAttrs(e),t,G.setFrom(n))},de.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),t=H.from(t),t.size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(H.empty,!0);return o?new ae(this,e,t.append(o),G.setFrom(n)):null},de.prototype.validContent=function(e){var t=this,n=this.contentMatch.matchFragment(e);if(!n||!n.validEnd)return!1;for(var r=0;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!1;return!0},de.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},de.prototype.allowsMarks=function(e){var t=this;if(null==this.markSet)return!0;for(var n=0;n<e.length;n++)if(!t.allowsMarkType(e[n].type))return!1;return!0},de.prototype.allowedMarks=function(e){var t=this;if(null==this.markSet)return e;for(var n,r=0;r<e.length;r++)t.allowsMarkType(e[r].type)?n&&n.push(e[r]):n||(n=e.slice(0,r));return n?n.length?n:G.empty:e},de.compile=function(e,t){var n=Object.create(null);e.forEach(function(e,r){return n[e]=new de(e,t,r)});var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(de.prototype,me);var ve=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},ge={isRequired:{}};ge.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(ve.prototype,ge);var ye=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=I(r.attrs),this.rank=t,this.excluded=null;var o=A(this.attrs);this.instance=o&&new G(this,o)};ye.prototype.create=function(e){return!e&&this.instance?this.instance:new G(this,R(this.attrs,e))},ye.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach(function(e,o){return n[e]=new ye(e,r++,t,o)}),n},ye.prototype.removeFromSet=function(e){for(var t=this,n=0;n<e.length;n++)if(e[n].type==t)return e.slice(0,n).concat(e.slice(n+1));return e},ye.prototype.isInSet=function(e){for(var t=this,n=0;n<e.length;n++)if(e[n].type==t)return e[n]},ye.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var xe=function(e){var t=this;this.spec={};for(var n in e)t.spec[n]=e[n];this.spec.nodes=K.from(e.nodes),this.spec.marks=K.from(e.marks),this.nodes=de.compile(this.spec.nodes,this),this.marks=ye.compile(this.spec.marks,this);var r=Object.create(null);for(var o in t.nodes){if(o in t.marks)throw new RangeError(o+" can not be both a node and a mark");var i=t.nodes[o],s=i.spec.content||"",a=i.spec.marks;i.contentMatch=r[s]||(r[s]=le.parse(s,t.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.markSet="_"==a?null:a?V(t,a.split(" ")):""!=a&&i.inlineContent?null:[]}for(var c in t.marks){var f=t.marks[c],l=f.spec.excludes;f.excluded=null==l?[f]:""==l?[]:V(t,l.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};xe.prototype.node=function(e,t,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof de))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)},xe.prototype.text=function(e,t){var n=this.nodes.text;return new fe(n,n.defaultAttrs,e,G.setFrom(t))},xe.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},xe.prototype.nodeFromJSON=function(e){return ae.fromJSON(this,e)},xe.prototype.markFromJSON=function(e){return G.fromJSON(this,e)},xe.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var we=function(e,t){var n=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(function(e){e.tag?n.tags.push(e):e.style&&n.styles.push(e)})};we.prototype.parse=function(e,t){void 0===t&&(t={});var n=new Ee(this,t,!1);return n.addAll(e,null,t.from,t.to),n.finish()},we.prototype.parseSlice=function(e,t){void 0===t&&(t={});var n=new Ee(this,t,!0);return n.addAll(e,null,t.from,t.to),Z.maxOpen(n.finish())},we.prototype.matchTag=function(e,t){for(var n=this,r=0;r<this.tags.length;r++){var o=n.tags[r];if($(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(i===!1)continue;o.attrs=i}return o}}},we.prototype.matchStyle=function(e,t,n){for(var r=this,o=0;o<this.styles.length;o++){var i=r.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!n.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var s=i.getAttrs(t);if(s===!1)continue;i.attrs=s}return i}}},we.schemaRules=function(e){function t(e){for(var t=null==e.priority?50:e.priority,r=0;r<n.length;r++){var o=n[r],i=null==o.priority?50:o.priority;if(i<t)break}n.splice(r,0,e)}var n=[],r=function(n){var r=e.marks[n].spec.parseDOM;r&&r.forEach(function(e){t(e=_(e)),e.mark=n})};for(var o in e.marks)r(o);var i=function(n){var r=e.nodes[s].spec.parseDOM;r&&r.forEach(function(e){t(e=_(e)),e.node=s})};for(var s in e.nodes)i(o);return n},we.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new we(e,we.schemaRules(e)))};var be={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},ke={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Se={ol:!0,ul:!0},Me=1,Oe=2,Ce=4,Te=function(e,t,n,r,o,i){this.type=e,this.attrs=t,this.solid=r,this.match=o||(i&Ce?null:e.contentMatch),this.options=i,this.content=[],this.marks=n,this.activeMarks=G.none};Te.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(H.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},Te.prototype.finish=function(e){if(!(this.options&Me)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/\s+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=H.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(H.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r};var Ee=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.pendingMarks=[];var r,o=t.topNode,i=B(t.preserveWhitespace)|(n?Ce:0);r=o?new Te(o.type,o.attrs,G.none,!0,t.topMatch||o.type.contentMatch,i):n?new Te(null,null,G.none,!0,null,i):new Te(e.schema.topNodeType,null,G.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},Ne={top:{},currentPos:{}};Ne.top.get=function(){return this.nodes[this.open]},Ee.prototype.addDOM=function(e){var t=this;if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var n=e.getAttribute("style"),r=n?this.readStyles(F(n)):null;if(null!=r)for(var o=0;o<r.length;o++)t.addPendingMark(r[o]);if(this.addElement(e),null!=r)for(var i=0;i<r.length;i++)t.removePendingMark(r[i])}},Ee.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if((n.type?n.type.inlineContent:n.content.length&&n.content[0].isInline)||/\S/.test(t)){if(n.options&Me)n.options&Oe||(t=t.replace(/\r?\n|\r/g," "));else if(t=t.replace(/\s+/g," "),/^\s/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/\s$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},Ee.prototype.addElement=function(e){var t=e.nodeName.toLowerCase();Se.hasOwnProperty(t)&&L(e);var n=this.options.ruleFromNode&&this.options.ruleFromNode(e)||this.parser.matchTag(e,this);if(n?n.ignore:ke.hasOwnProperty(t))this.findInside(e);else if(!n||n.skip){n&&n.skip.nodeType&&(e=n.skip);var r,o=this.top,i=this.needsBlock;be.hasOwnProperty(t)&&(r=!0,o.type||(this.needsBlock=!0)),this.addAll(e),r&&this.sync(o),this.needsBlock=i}else this.addElementByRule(e,n)},Ee.prototype.readStyles=function(e){for(var t=this,n=G.none,r=0;r<e.length;r+=2){var o=t.parser.matchStyle(e[r],e[r+1],t);if(o){if(o.ignore)return null;n=t.parser.schema.marks[o.mark].create(o.attrs).addToSet(n)}}return n},Ee.prototype.addElementByRule=function(e,t){var n,r,o,i,s=this;t.node?(r=this.parser.schema.nodes[t.node],r.isLeaf?this.insertNode(r.create(t.attrs)):n=this.enter(r,t.attrs,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark],i=o.create(t.attrs),this.addPendingMark(i));var a=this.top;if(r&&r.isLeaf)this.findInside(e);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(function(e){return s.insertNode(e)});else{var c=t.contentElement;"string"==typeof c?c=e.querySelector(c):"function"==typeof c&&(c=c(e)),c||(c=e),this.findAround(e,c,!0),this.addAll(c,n)}return n&&(this.sync(a),this.open--),i&&this.removePendingMark(i),!0},Ee.prototype.addAll=function(e,t,n,r){for(var o=this,i=n||0,s=n?e.childNodes[n]:e.firstChild,a=null==r?null:e.childNodes[r];s!=a;s=s.nextSibling,++i)o.findAtPoint(e,i),o.addDOM(s),t&&be.hasOwnProperty(s.nodeName.toLowerCase())&&o.sync(t);this.findAtPoint(e,i)},Ee.prototype.findPlace=function(e){for(var t,n,r=this,o=this.open;o>=0;o--){var i=r.nodes[o],s=i.findWrapping(e);if(s&&(!t||t.length>s.length)&&(t=s,n=i,!s.length))break;if(i.solid)break}if(!t)return!1;this.sync(n);for(var a=0;a<t.length;a++)r.enterInner(t[a],null,!1);return!0},Ee.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;this.applyPendingMarks(n),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));n.content.push(e.mark(r))}},Ee.prototype.applyPendingMarks=function(e){for(var t=this,n=0;n<this.pendingMarks.length;n++){var r=t.pendingMarks[n];e.type&&!e.type.allowsMarkType(r.type)||r.type.isInSet(e.activeMarks)||(e.activeMarks=r.addToSet(e.activeMarks),t.pendingMarks.splice(n--,1))}},Ee.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&(this.applyPendingMarks(this.top),this.enterInner(e,t,!0,n)),r},Ee.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.match=o.match&&o.match.matchType(e,t);var i=null==r?o.options&~Ce:B(r);o.options&Ce&&0==o.content.length&&(i|=Ce),this.nodes.push(new Te(e,t,o.activeMarks,n,null,i)),this.open++},Ee.prototype.closeExtra=function(e){var t=this,n=this.nodes.length-1;if(n>this.open){for(;n>this.open;n--)t.nodes[n-1].content.push(t.nodes[n].finish(e));this.nodes.length=this.open+1}},Ee.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Ee.prototype.sync=function(e){for(var t=this,n=this.open;n>=0;n--)if(t.nodes[n]==e)return void(t.open=n)},Ee.prototype.addPendingMark=function(e){this.pendingMarks.push(e)},Ee.prototype.removePendingMark=function(e){var t=this.pendingMarks.lastIndexOf(e);if(t>-1)this.pendingMarks.splice(t,1);else{var n=this.top;n.activeMarks=e.removeFromSet(n.activeMarks)}},Ne.currentPos.get=function(){var e=this;this.closeExtra();for(var t=0,n=this.open;n>=0;n--){for(var r=e.nodes[n].content,o=r.length-1;o>=0;o--)t+=r[o].nodeSize;n&&t++}return t},Ee.prototype.findAtPoint=function(e,t){var n=this;if(this.find)for(var r=0;r<this.find.length;r++)n.find[r].node==e&&n.find[r].offset==t&&(n.find[r].pos=n.currentPos)},Ee.prototype.findInside=function(e){var t=this;if(this.find)for(var n=0;n<this.find.length;n++)null==t.find[n].pos&&1==e.nodeType&&e.contains(t.find[n].node)&&(t.find[n].pos=t.currentPos)},Ee.prototype.findAround=function(e,t,n){var r=this;if(e!=t&&this.find)for(var o=0;o<this.find.length;o++)if(null==r.find[o].pos&&1==e.nodeType&&e.contains(r.find[o].node)){var i=t.compareDocumentPosition(r.find[o].node);i&(n?2:4)&&(r.find[o].pos=r.currentPos)}},Ee.prototype.findInText=function(e){var t=this;if(this.find)for(var n=0;n<this.find.length;n++)t.find[n].node==e&&(t.find[n].pos=t.currentPos-(e.nodeValue.length-t.find[n].offset))},Ee.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=function e(s,a){for(;s>=0;s--){var c=n[s];if(""==c){if(s==n.length-1||0==s)continue;for(;a>=i;a--)if(e(s-1,a))return!0;return!1}var f=a>0||0==a&&o?t.nodes[a].type:r&&a>=i?r.node(a-i).type:null;if(!f||f.name!=c&&f.groups.indexOf(c)==-1)return!1;a--}return!0};return s(n.length-1,this.open)},Ee.prototype.textblockFromContext=function(){var e=this,t=this.options.context;if(t)for(var n=t.depth;n>=0;n--){var r=t.node(n).contentMatchAt(t.indexAfter(n)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(var o in e.parser.schema.nodes){var i=e.parser.schema.nodes[o];if(i.isTextblock&&i.defaultAttrs)return i}},Object.defineProperties(Ee.prototype,Ne);var je=function(e,t){this.nodes=e||{},this.marks=t||{}};je.prototype.serializeFragment=function(e,t,n){var r=this;void 0===t&&(t={}),n||(n=J(t).createDocumentFragment());var o=n,i=null;return e.forEach(function(e){if(i||e.marks.length){i||(i=[]);for(var n=0,s=0;n<i.length&&s<e.marks.length;){var a=e.marks[s];if(r.marks[a.type.name]){if(!a.eq(i[n])||a.type.spec.spanning===!1)break;n+=2,s++}else s++}for(;n<i.length;)o=i.pop(),i.pop();for(;s<e.marks.length;){var c=e.marks[s++],f=r.serializeMark(c,e.isInline,t);f&&(i.push(c,o),o.appendChild(f.dom),o=f.contentDOM||f.dom)}}o.appendChild(r.serializeNode(e,t))}),n},je.prototype.serializeNode=function(e,t){void 0===t&&(t={});var n=je.renderSpec(J(t),this.nodes[e.type.name](e)),r=n.dom,o=n.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return r},je.prototype.serializeNodeAndMarks=function(e,t){var n=this;void 0===t&&(t={});for(var r=this.serializeNode(e,t),o=e.marks.length-1;o>=0;o--){var i=n.serializeMark(e.marks[o],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r},je.prototype.serializeMark=function(e,t,n){void 0===n&&(n={});var r=this.marks[e.type.name];return r&&je.renderSpec(J(n),r(e,t))},je.renderSpec=function(e,n){if("string"==typeof n)return{dom:e.createTextNode(n)};if(null!=n.nodeType)return{dom:n};var r=e.createElement(n[0]),o=null,i=n[1],s=1;if(i&&"object"==t(i)&&null==i.nodeType&&!Array.isArray(i)){s=2;for(var a in i)null!=i[a]&&r.setAttribute(a,i[a])}for(var c=s;c<n.length;c++){var f=n[c];if(0===f){if(c<n.length-1||c>s)throw new RangeError("Content hole must be the only child of its parent node");return{dom:r,contentDOM:r}}var l=je.renderSpec(e,f),p=l.dom,u=l.contentDOM;if(r.appendChild(p),u){if(o)throw new RangeError("Multiple content holes");o=u}}return{dom:r,contentDOM:o}},je.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new je(this.nodesFromSchema(e),this.marksFromSchema(e)))},je.nodesFromSchema=function(e){var t=q(e.nodes);return t.text||(t.text=function(e){return e.text}),t},je.marksFromSchema=function(e){return q(e.marks)},n.Node=ae,n.ResolvedPos=Y,n.NodeRange=oe,n.Fragment=H,n.Slice=Z,n.ReplaceError=c,n.Mark=G,n.Schema=xe,n.NodeType=de,n.MarkType=ye,n.ContentMatch=le,n.DOMParser=we,n.DOMSerializer=je});r(re);var oe=re.Node,ie=(re.ResolvedPos,re.NodeRange,re.Fragment),se=re.Slice,ae=re.ReplaceError,ce=(re.Mark,re.Schema),fe=(re.NodeType,re.MarkType),le=(re.ContentMatch,re.DOMParser,re.DOMSerializer),pe=65535,ue=Math.pow(2,16),he=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},de=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};de.prototype.recover=function(e){var t=0,n=a(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+c(e)},de.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},de.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},de.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var c=this.ranges[a]-(this.inverted?r:0);if(c>e)break;var f=this.ranges[a+o],l=this.ranges[a+i],p=c+f;if(e<=p){var u=f?e==c?-1:e==p?1:t:t,h=c+r+(u<0?0:l);if(n)return h;var d=e==(t<0?c:p)?null:s(a/3,e-c);return new he(h,t<0?e!=c:e!=p,d)}r+=l-f}return n?e+r:new he(e+r)},de.prototype.touches=function(e,t){for(var n=0,r=a(t),o=this.inverted?2:1,i=this.inverted?1:2,s=0;s<this.ranges.length;s+=3){var c=this.ranges[s]-(this.inverted?n:0);if(c>e)break;var f=this.ranges[s+o],l=c+f;if(e<=l&&s==3*r)return!0;n+=this.ranges[s+i]-f}return!1},de.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],s=i-(this.inverted?o:0),a=i+(this.inverted?0:o),c=this.ranges[r+t],f=this.ranges[r+n];e(s,s+c,a,a+f),o+=f-c}},de.prototype.invert=function(){return new de(this.ranges,!this.inverted)},de.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},de.offset=function(e){return 0==e?de.empty:new de(e<0?[0,-e,0]:[0,0,e])},de.empty=new de([]);var me=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};me.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new me(this.maps,this.mirror,e,t)},me.prototype.copy=function(){return new me(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},me.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},me.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},me.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},me.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},me.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},me.prototype.invert=function(){var e=new me;return e.appendMappingInverted(this),e},me.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},me.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},me.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o],s=i.mapResult(e,t);if(null!=s.recover){var a=this.getMirror(o);if(null!=a&&a>o&&a<this.to){o=a,e=this.maps[a].recover(s.recover);continue}}s.deleted&&(r=!0),e=s.pos}return n?e:new he(e,r)},f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.name="TransformError";var ve=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new me},ge={before:{configurable:!0},docChanged:{configurable:!0}};ge.before.get=function(){return this.docs.length?this.docs[0]:this.doc},ve.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new f(t.failed);return this},ve.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},ge.docChanged.get=function(){return this.steps.length>0},ve.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(ve.prototype,ge);var ye=Object.create(null),xe=function(){};xe.prototype.apply=function(e){return l()},xe.prototype.getMap=function(){return de.empty},xe.prototype.invert=function(e){return l()},xe.prototype.map=function(e){return l()},xe.prototype.merge=function(e){return null},xe.prototype.toJSON=function(){return l()},xe.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=ye[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},xe.jsonID=function(e,t){if(e in ye)throw new RangeError("Duplicate use of step JSON ID "+e);return ye[e]=t,t.prototype.jsonID=e,t};var we=function(e,t){this.doc=e,this.failed=t};we.ok=function(e){return new we(e,null)},we.fail=function(e){return new we(null,e)},we.fromReplace=function(e,t,n,r){try{return we.ok(e.replace(t,n,r))}catch(e){if(e instanceof ae)return we.fail(e.message);throw e}};var be=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&p(e,this.from,this.to)?we.fail("Structure replace would overwrite content"):we.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new de([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure!=this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?se.empty:new se(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?se.empty:new se(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,se.fromJSON(e,n.slice),!!n.structure)},t}(xe);xe.jsonID("replace",be);var ke=function(e){function t(t,n,r,o,i,s,a){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=!!a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(p(e,this.from,this.gapFrom)||p(e,this.gapTo,this.to)))return we.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return we.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?we.fromReplace(e,this.from,this.to,n):we.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new de([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,se.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(xe);xe.jsonID("replaceAround",ke),ve.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),s=r.after(o+1),a=i,c=s,f=ie.empty,l=0,p=o,u=!1;p>t;p--)u||n.index(p)>0?(u=!0,f=ie.from(n.node(p).copy(f)),l++):a--;for(var h=ie.empty,d=0,m=o,v=!1;m>t;m--)v||r.after(m+1)<r.end(m)?(v=!0,h=ie.from(r.node(m).copy(h)),d++):c++;return this.step(new ke(a,c,i,s,new se(f.append(h),l,d),f.size-l,!0))},ve.prototype.wrap=function(e,t){for(var n=ie.empty,r=t.length-1;r>=0;r--)n=ie.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new ke(o,i,o,i,new se(n,0,0),t.length,!0))},ve.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&y(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var s=o.mapping.slice(i),a=s.map(t,1),c=s.map(t+e.nodeSize,1);return o.step(new ke(a,c,a+1,c-1,new se(ie.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}}),this},ve.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new ke(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new se(ie.from(i),0,0),1,!0))},ve.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=ie.empty,i=ie.empty,s=r.depth,a=r.depth-t,c=t-1;s>a;s--,c--){o=ie.from(r.node(s).copy(o));var f=n&&n[c];i=ie.from(f?f.type.create(f.attrs,i):r.node(s).copy(i))}return this.step(new be(e,e,new se(o.append(i),t,t),!0))},ve.prototype.join=function(e,t){void 0===t&&(t=1);var n=new be(e-t,e+t,se.empty,!0);return this.step(n)};var Se=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new se(O(n.content,function(e,n){return n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e},o),n.openStart,n.openEnd);return we.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new Me(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(xe);xe.jsonID("addMark",Se);var Me=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new se(O(n.content,function(e){return e.mark(t.mark.removeFromSet(e.marks))}),n.openStart,n.openEnd);return we.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new Se(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(xe);xe.jsonID("removeMark",Me),ve.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],s=null,a=null;return this.doc.nodesBetween(e,t,function(r,c,f){if(r.isInline){var l=r.marks;if(!n.isInSet(l)&&f.type.allowsMarkType(n.type)){for(var p=Math.max(c,e),u=Math.min(c+r.nodeSize,t),h=n.addToSet(l),d=0;d<l.length;d++)l[d].isInSet(h)||(s&&s.to==p&&s.mark.eq(l[d])?s.to=u:o.push(s=new Me(p,u,l[d])));a&&a.to==p?a.to=u:i.push(a=new Se(p,u,n))}}}),o.forEach(function(e){return r.step(e)}),i.forEach(function(e){return r.step(e)}),this},ve.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,function(r,s){if(r.isInline){i++;var a=null;if(n instanceof fe){var c=n.isInSet(r.marks);c&&(a=[c])}else n?n.isInSet(r.marks)&&(a=[n]):a=r.marks;if(a&&a.length)for(var f=Math.min(s+r.nodeSize,t),l=0;l<a.length;l++){for(var p=a[l],u=void 0,h=0;h<o.length;h++){var d=o[h];d.step==i-1&&p.eq(o[h].style)&&(u=d)}u?(u.to=f,u.step=i):o.push({style:p,from:Math.max(s,e),to:f,step:i})}}}),o.forEach(function(e){return r.step(new Me(e.from,e.to,e.style))}),this},ve.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,s=0;s<r.childCount;s++){var a=r.child(s),c=i+a.nodeSize,f=n.matchType(a.type,a.attrs);if(f){n=f;for(var l=0;l<a.marks.length;l++)t.allowsMarkType(a.marks[l].type)||this.step(new Me(i,c,a.marks[l]))}else o.push(new be(i,c,se.empty));i=c}if(!n.validEnd){var p=n.fillBefore(ie.empty,!0);this.replace(i,i,new se(p,0,0))}for(var u=o.length-1;u>=0;u--)this.step(o[u]);return this},ve.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=se.empty);var r=C(this.doc,e,t,n);return r&&this.step(r),this},ve.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new se(ie.from(n),0,0))},ve.prototype.delete=function(e,t){return this.replace(e,t,se.empty)},ve.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var Oe=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=ie.empty;for(var i=e.depth;i>0;i--)this.placed=ie.from(e.node(i).copy(this.placed))},Ce={depth:{configurable:!0}};Ce.depth.get=function(){return this.frontier.length-1},Oe.prototype.fit=function e(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,s=r.depth,a=o.depth;s&&a&&1==i.childCount;)i=i.firstChild.content,s--,a--;var c=new se(i,s,a);return t>-1?new ke(r.pos,t,this.$to.pos,this.$to.end(),c,n):c.size||r.pos!=this.$to.pos?new be(r.pos,o.pos,c):void 0},Oe.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--){var n=void 0,r=void 0;t?(r=j(this.unplaced.content,t-1).firstChild,n=r.content):n=this.unplaced.content;for(var o=n.firstChild,i=this.depth;i>=0;i--){var s=this.frontier[i],a=s.type,c=s.match,f=void 0,l=void 0;if(1==e&&(o?c.matchType(o.type)||(l=c.fillBefore(ie.from(o),!1)):a.compatibleContent(r.type)))return{sliceDepth:t,frontierDepth:i,parent:r,inject:l};if(2==e&&o&&(f=c.findWrapping(o.type)))return{sliceDepth:t,frontierDepth:i,parent:r,wrap:f};if(r&&c.matchType(r.type))break}}},Oe.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=j(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new se(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},Oe.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=j(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new se(E(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new se(E(t,n,1),n,r)},Oe.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var s=0;s<i.length;s++)this.openFrontierNode(i[s]);var a=this.unplaced,c=r?r.content:a.content,f=a.openStart-t,l=0,p=[],u=this.frontier[n],h=u.match,d=u.type;if(o){for(var m=0;m<o.childCount;m++)p.push(o.child(m));h=h.matchFragment(o)}for(var v=c.size+t-(a.content.size-a.openEnd);l<c.childCount;){var g=c.child(l),y=h.matchType(g.type);if(!y)break;l++,(l>1||0==f||g.content.size)&&(h=y,p.push(z(g.mark(d.allowedMarks(g.marks)),1==l?f:0,l==c.childCount?v:-1)))}var x=l==c.childCount;x||(v=-1),this.placed=N(this.placed,n,ie.from(p)),this.frontier[n].match=h,x&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var w=0,b=c;w<v;w++){var k=b.lastChild;this.frontier.push({type:k.type,match:k.contentMatchAt(k.childCount)}),b=k.content}this.unplaced=x?0==t?se.empty:new se(E(a.content,t-1,1),t-1,v<0?a.openEnd:t-1):new se(E(a.content,t,l),a.openStart,a.openEnd)},Oe.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!D(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to,r=n.depth,o=this.$to.after(r);r>1&&o==this.$to.end(--r);)++o;return o},Oe.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=D(e,t,o,r,i);if(s){for(var a=t-1;a>=0;a--){var c=this.frontier[a],f=c.match,l=c.type,p=D(e,a,l,f,!0);if(!p||p.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}},Oe.prototype.close=function e(t){var e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=N(this.placed,e.depth,e.fit)),t=e.move;for(var n=e.depth+1;n<=t.depth;n++){var r=t.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,t.index(n));this.openFrontierNode(r.type,r.attrs,o)}return t},Oe.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=N(this.placed,this.depth,ie.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},Oe.prototype.closeFrontierNode=function(){var e=this.frontier.pop(),t=e.match.fillBefore(ie.empty,!0);t.childCount&&(this.placed=N(this.placed,this.frontier.length,t))},Object.defineProperties(Oe.prototype,Ce),ve.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(T(r,o,n))return this.step(new be(e,t,n));var i=R(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var s=-(r.depth+1);i.unshift(s);for(var a=r.depth,c=r.pos-1;a>0;a--,c--){var f=r.node(a).type.spec;if(f.defining||f.isolating)break;i.indexOf(a)>-1?s=a:r.before(a)==c&&i.splice(1,0,-a)}for(var l=i.indexOf(s),p=[],u=n.openStart,h=n.content,d=0;;d++){var m=h.firstChild;if(p.push(m),d==n.openStart)break;h=m.content}u>0&&p[u-1].type.spec.defining&&r.node(l).type!=p[u-1].type?u-=1:u>=2&&p[u-1].isTextblock&&p[u-2].type.spec.defining&&r.node(l).type!=p[u-2].type&&(u-=2);for(var v=n.openStart;v>=0;v--){var g=(v+u+1)%(n.openStart+1),y=p[g];if(y)for(var x=0;x<i.length;x++){var w=i[(x+l)%i.length],b=!0;w<0&&(b=!1,w=-w);var k=r.node(w-1),S=r.index(w-1);if(k.canReplaceWith(S,S,y.type,y.marks))return this.replace(r.before(w),b?o.after(w):t,new se(A(n.content,0,n.openStart,g),g,n.openEnd))}}for(var M=this.steps.length,O=i.length-1;O>=0&&(this.replace(e,t,n),!(this.steps.length>M));O--){var C=i[O];O<0||(e=r.before(C),t=o.after(C))}return this},ve.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=S(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new se(ie.from(n),0,0))},ve.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=R(n,r),i=0;i<o.length;i++){var s=o[i],a=i==o.length-1;if(a&&0==s||n.node(s).type.contentMatch.validEnd)return this.delete(n.start(s),r.end(s));if(s>0&&(a||n.node(s-1).canReplace(n.index(s-1),r.indexAfter(s-1))))return this.delete(n.before(s),r.after(s))}for(var c=1;c<=n.depth&&c<=r.depth;c++)if(e-n.start(c)==n.depth-c&&t>n.end(c)&&r.end(c)-t!=r.depth-c)return this.delete(n.before(c),t);return this.delete(e,t)};var Te=Object.freeze({AddMarkStep:Se,MapResult:he,Mapping:me,RemoveMarkStep:Me,ReplaceAroundStep:ke,ReplaceStep:be,Step:xe,StepMap:de,StepResult:we,Transform:ve,TransformError:f,canJoin:w,canSplit:x,dropPoint:M,findWrapping:d,insertPoint:S,joinPoint:k,liftTarget:h,replaceStep:C}),Ee=o(function(e,n){function r(e,t,n,o,i,s){if(t.inlineContent)return u.create(e,n);for(var a=o-(i>0?0:1);i>0?a<t.childCount:a>=0;a+=i){var c=t.child(a);if(c.isAtom){if(!s&&d.isSelectable(c))return d.create(e,n-(i<0?c.nodeSize:0))}else{var f=r(e,c,n+i,i<0?c.childCount:0,i,s);if(f)return f}n+=c.nodeSize*i}}function o(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o=e.steps[r];if(o instanceof Te.ReplaceStep||o instanceof Te.ReplaceAroundStep){var i,s=e.mapping.maps[r];s.forEach(function(e,t,n,r){null==i&&(i=r)}),e.setSelection(f.near(e.doc.resolve(i),n))}}}function i(e,t){return t&&e?e.bind(t):e}function s(e,t,n){for(var r in e){var o=e[r];o instanceof Function?o=o.bind(t):"handleDOMEvents"==r&&(o=s(o,t,{})),n[r]=o}return n}function a(e){return e in N?e+"$"+ ++N[e]:(N[e]=0,e+"$")}Object.defineProperty(n,"__esModule",{value:!0});var c=Object.create(null),f=function(e,t,n){this.ranges=n||[new p(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},l={anchor:{},head:{},from:{},to:{},$from:{},$to:{},empty:{}};l.anchor.get=function(){return this.$anchor.pos},l.head.get=function(){return this.$head.pos},l.from.get=function(){return this.$from.pos},l.to.get=function(){return this.$to.pos},l.$from.get=function(){return this.ranges[0].$from},l.$to.get=function(){return this.ranges[0].$to},l.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},f.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},f.prototype.replace=function(e,t){void 0===t&&(t=re.Slice.empty);for(var n=t.content.lastChild,r=null,i=0;i<t.openEnd;i++)r=n,n=n.lastChild;for(var s=e.steps.length,a=this.ranges,c=0;c<a.length;c++){var f=a[c],l=f.$from,p=f.$to,u=e.mapping.slice(s);e.replaceRange(u.map(l.pos),u.map(p.pos),c?re.Slice.empty:t),0==c&&o(e,s,(n?n.isInline:r&&r.isTextblock)?-1:1)}},f.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,i=0;i<r.length;i++){var s=r[i],a=s.$from,c=s.$to,f=e.mapping.slice(n),l=f.map(a.pos),p=f.map(c.pos);i?e.deleteRange(l,p):(e.replaceRangeWith(l,p,t),o(e,n,t.isInline?-1:1))}},f.findFrom=function(e,t,n){var o=e.parent.inlineContent?new u(e):r(e.node(0),e.parent,e.pos,e.index(),t,n);if(o)return o;for(var i=e.depth-1;i>=0;i--){var s=t<0?r(e.node(0),e.node(i),e.before(i+1),e.index(i),t,n):r(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,n);if(s)return s}},f.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new v(e.node(0))},f.atStart=function(e){return r(e,e,0,0,1)||new v(e)},f.atEnd=function(e){return r(e,e,e.content.size,e.childCount,-1)||new v(e)},f.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=c[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},f.jsonID=function(e,t){if(e in c)throw new RangeError("Duplicate use of selection JSON ID "+e);return c[e]=t,t.prototype.jsonID=e,t},f.prototype.getBookmark=function(){return u.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(f.prototype,l),f.prototype.visible=!0;var p=function(e,t){this.$from=e,this.$to=t},u=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=re.Slice.empty),e.prototype.replace.call(this,t,n),n==re.Slice.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new h(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var s=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!s)return e.near(r,o);r=s.$head}return n.parent.inlineContent||(0==i?n=r:(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor,n.pos<r.pos!=i<0&&(n=r))),new t(n,r)},Object.defineProperties(t.prototype,n),t}(f);f.jsonID("text",u);var h=function(e,t){this.anchor=e,this.head=t};h.prototype.map=function(e){return new h(e.map(this.anchor),e.map(this.head))},h.prototype.resolve=function(e){return u.between(e.resolve(this.anchor),e.resolve(this.head))};var d=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,s=o.pos,a=n.resolve(s);return i?e.near(a):new t(a)},t.prototype.content=function(){return new re.Slice(re.Fragment.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new m(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&e.type.spec.selectable!==!1},t}(f);d.prototype.visible=!1,f.jsonID("node",d);var m=function(e){this.anchor=e};m.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new h(r,r):new m(r)},m.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&d.isSelectable(n)?new d(t):f.near(t)};var v=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return g},t}(f);f.jsonID("all",v);var g={map:function(){return this},resolve:function(e){return new v(e)}},y=1,x=2,w=4,b=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{},selectionSet:{},storedMarksSet:{},isGeneric:{},scrolledIntoView:{}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|y)&~x,this.storedMarks=null,this},n.selectionSet.get=function(){return(this.updated&y)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=x,this},t.prototype.ensureMarks=function(e){return re.Mark.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(this.updated&x)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=this.updated&~x,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return t!==!1&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||re.Mark.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o))},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){var e=this;for(var t in e.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=w,this},n.scrolledIntoView.get=function(){return(this.updated&w)>0},Object.defineProperties(t.prototype,n),t}(Te.Transform),k=function(e,t,n){this.name=e,this.init=i(t.init,n),this.apply=i(t.apply,n)},S=[new k("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new k("selection",{init:function(e,t){return e.selection||f.atStart(t.doc)},apply:function(e){return e.selection}}),new k("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new k("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],M=function(e,t){var n=this;this.schema=e,this.fields=S.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach(function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new k(e.key,e.spec.state,e))})},O=function(e){this.config=e},C={schema:{},plugins:{},tr:{}};C.schema.get=function(){return this.config.schema},C.plugins.get=function(){return this.config.plugins},O.prototype.apply=function(e){return this.applyTransaction(e).state},O.prototype.filterTransaction=function(e,t){var n=this;void 0===t&&(t=-1);for(var r=0;r<this.config.plugins.length;r++)if(r!=t){var o=n.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,n))return!1}return!0},O.prototype.applyTransaction=function(e){var t=this;if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var n=[e],r=this.applyInner(e),o=null;;){for(var i=!1,s=0;s<this.config.plugins.length;s++){var a=t.config.plugins[s];if(a.spec.appendTransaction){var c=o?o[s].n:0,f=o?o[s].state:t,l=c<n.length&&a.spec.appendTransaction.call(a,c?n.slice(c):n,f,r);if(l&&r.filterTransaction(l,s)){if(l.setMeta("appendedTransaction",e),!o){o=[];for(var p=0;p<this.config.plugins.length;p++)o.push(p<s?{state:r,n:n.length}:{state:t,n:0})}n.push(l),r=r.applyInner(l),i=!0}o&&(o[s]={state:r,n:n.length})}}if(!i)return{state:r,transactions:n}}},O.prototype.applyInner=function(e){var t=this;if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var n=new O(this.config),r=this.config.fields,o=0;o<r.length;o++){var i=r[o];n[i.name]=i.apply(e,t[i.name],t,n)}for(var s=0;s<T.length;s++)T[s](t,e,n);return n},C.tr.get=function(){return new b(this)},O.create=function(e){for(var t=new M(e.schema||e.doc.type.schema,e.plugins),n=new O(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},O.prototype.reconfigure=function(e){for(var t=this,n=new M(e.schema||this.schema,e.plugins),r=n.fields,o=new O(n),i=0;i<r.length;i++){var s=r[i].name;o[s]=t.hasOwnProperty(s)?t[s]:r[i].init(e,o)}return o},O.prototype.toJSON=function(e){var n=this,r={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(r.storedMarks=this.storedMarks.map(function(e){return e.toJSON()})),e&&"object"==t(e))for(var o in e){if("doc"==o||"selection"==o)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var i=e[o],s=i.spec.state;s&&s.toJSON&&(r[o]=s.toJSON.call(i,n[i.key]))}return r},O.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new M(e.schema,e.plugins),o=new O(r);return r.fields.forEach(function(r){if("doc"==r.name)o.doc=re.Node.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=f.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var s=n[i],a=s.spec.state;if(s.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=a.fromJSON.call(s,e,t[i],o))}o[r.name]=r.init(e,o)}}),o},O.addApplyListener=function(e){T.push(e)},O.removeApplyListener=function(e){var t=T.indexOf(e);t>-1&&T.splice(t,1)},Object.defineProperties(O.prototype,C);var T=[],E=function(e){this.props={},e.props&&s(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:a("plugin")};E.prototype.getState=function(e){return e[this.key]};var N=Object.create(null),j=function(e){void 0===e&&(e="key"),this.key=a(e)};j.prototype.get=function(e){return e.config.pluginsByKey[this.key]},j.prototype.getState=function(e){return e[this.key]},n.Selection=f,n.SelectionRange=p,n.TextSelection=u,n.NodeSelection=d,n.AllSelection=v,n.Transaction=b,n.EditorState=O,n.Plugin=E,n.PluginKey=j});r(Ee);var Ne=(Ee.Selection,Ee.SelectionRange,Ee.TextSelection),je=(Ee.NodeSelection,Ee.AllSelection,Ee.Transaction,Ee.EditorState),ze=Ee.Plugin,De=Ee.PluginKey,Pe=o(function(e,t){function n(e,t,n,i,s){for(;;){if(e==n&&t==i)return!0;if(t==(s<0?0:r(e))){var a=e.parentNode;if(1!=a.nodeType||o(e)||It.test(e.nodeName)||"false"==e.contentEditable)return!1;t=Dt(e)+(s<0?0:1),e=a}else{if(1!=e.nodeType)return!1;e=e.childNodes[t+(s<0?-1:0)],t=s<0?r(e):0}}}function r(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function o(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function i(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function s(e){return{left:0,right:e.innerWidth,top:0,bottom:e.innerHeight}}function a(e,t){return"number"==typeof e?e:e[t]}function c(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,c=i.defaultView,f=n||e.dom;f;f=Pt(f))if(1==f.nodeType){var l=f==i.body||1!=f.nodeType,p=l?s(c):f.getBoundingClientRect(),u=0,h=0;if(t.top<p.top+a(r,"top")?h=-(p.top-t.top+a(o,"top")):t.bottom>p.bottom-a(r,"bottom")&&(h=t.bottom-p.bottom+a(o,"bottom")),t.left<p.left+a(r,"left")?u=-(p.left-t.left+a(o,"left")):t.right>p.right-a(r,"right")&&(u=t.right-p.right+a(o,"right")),(u||h)&&(l?c.scrollBy(u,h):(h&&(f.scrollTop+=h),u&&(f.scrollLeft+=u))),l)break}}function f(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=e.dom.ownerDocument,s=(r.left+r.right)/2,a=o+1;a<Math.min(innerHeight,r.bottom);a+=5){var c=e.root.elementFromPoint(s,a);if(c!=e.dom&&e.dom.contains(c)){var f=c.getBoundingClientRect();if(f.top>=o-20){t=c,n=f.top;break}}}for(var l=[],p=e.dom;p&&(l.push({dom:p,top:p.scrollTop,left:p.scrollLeft}),p!=i.body);p=Pt(p));return{refDOM:t,refTop:n,stack:l}}function l(e){for(var t=e.refDOM,n=e.refTop,r=e.stack,o=t?t.getBoundingClientRect().top:0,i=0==o?0:o-n,s=0;s<r.length;s++){var a=r[s],c=a.dom,f=a.top,l=a.left;c.scrollTop!=f+i&&(c.scrollTop=f+i),c.scrollLeft!=l&&(c.scrollLeft=l)}}function p(e,t){for(var n,r,o=2e8,i=0,s=t.top,a=t.top,c=e.firstChild,f=0;c;c=c.nextSibling,f++){var l=void 0;if(1==c.nodeType)l=c.getClientRects();else{if(3!=c.nodeType)continue;l=At(c).getClientRects()}for(var h=0;h<l.length;h++){var d=l[h];if(d.top<=s&&d.bottom>=a){s=Math.max(d.bottom,s),a=Math.min(d.top,a);var m=d.left>t.left?d.left-t.left:d.right<t.left?t.left-d.right:0;if(m<o){n=c,o=m,r=m&&3==n.nodeType?{left:d.right<t.left?d.right:d.left,top:t.top}:t,1==c.nodeType&&m&&(i=f+(t.left>=(d.left+d.right)/2?1:0));continue}}!n&&(t.left>=d.right&&t.top>=d.top||t.left>=d.left&&t.top>=d.bottom)&&(i=f+1)}}return n&&3==n.nodeType?u(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:p(n,r)}function u(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=x(r,1);if(i.top!=i.bottom&&h(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}function h(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function d(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}function m(e,t,n){var r=p(t,n),o=r.node,i=r.offset,s=-1;if(1==o.nodeType&&!o.firstChild){var a=o.getBoundingClientRect();s=a.left!=a.right&&n.left>(a.left+a.right)/2?1:-1}return e.docView.posFromDOM(o,i,s)}function v(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var s=e.docView.nearestDesc(i,!0);if(!s)return null;if(s.node.isBlock&&s.parent){var a=s.dom.getBoundingClientRect();if(a.left>r.left||a.top>r.top)o=s.posBefore;else{if(!(a.right<r.left||a.bottom<r.top))break;o=s.posAfter}}i=s.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}function g(e,t,n){var r=e.childNodes.length;if(r&&n.top<n.bottom)for(var o=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),i=o;;){var s=e.childNodes[i];if(1==s.nodeType)for(var a=s.getClientRects(),c=0;c<a.length;c++){var f=a[c];if(h(t,f))return g(s,t,f)}if((i=(i+1)%r)==o)break}return e}function y(e,t){var n,r,o=e.root;if(o.caretPositionFromPoint){var i=o.caretPositionFromPoint(t.left,t.top);if(i){var s;s=i,n=s.offsetNode,r=s.offset}}if(!n&&o.caretRangeFromPoint){var a=o.caretRangeFromPoint(t.left,t.top);if(a){var c;c=a,n=c.startContainer,r=c.startOffset}}var f,l=o.elementFromPoint(t.left,t.top+1);if(!l||!e.dom.contains(1!=l.nodeType?l.parentNode:l)){var p=e.dom.getBoundingClientRect();if(!h(t,p))return null;if(l=g(e.dom,t,p),!l)return null}if(l=d(l,t),n){if(Ct.gecko&&1==n.nodeType&&(r=Math.min(r,n.childNodes.length),r<n.childNodes.length)){var u,y=n.childNodes[r];"IMG"==y.nodeName&&(u=y.getBoundingClientRect()).right<=t.left&&u.bottom>t.top&&r++}n==e.dom&&r==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?f=e.state.doc.content.size:0!=r&&1==n.nodeType&&"BR"==n.childNodes[r-1].nodeName||(f=v(e,n,r,t))}null==f&&(f=m(e,l,t));var x=e.docView.nearestDesc(l,!0);return{pos:f,inside:x?x.posAtStart-x.border:-1}}function x(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}function w(e,t){var n=e.docView.domFromPos(t),o=n.node,i=n.offset;if(3==o.nodeType&&(Ct.chrome||Ct.gecko)){var s=x(At(o,i,i),0);if(Ct.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var a=x(At(o,i-1,i-1),-1);if(Math.abs(a.left-s.left)<1&&a.top==s.top){var c=x(At(o,i,i+1),-1);return b(c,c.left<a.left)}}return s}if(1==o.nodeType&&!e.state.doc.resolve(t).parent.inlineContent){var f,l=!0;if(i<o.childNodes.length){var p=o.childNodes[i];1==p.nodeType&&(f=p.getBoundingClientRect())}if(!f&&i){var u=o.childNodes[i-1];1==u.nodeType&&(f=u.getBoundingClientRect(),l=!1)}return k(f||o.getBoundingClientRect(),l)}for(var h=-1;h<2;h+=2)if(h<0&&i){var d=void 0,m=3==o.nodeType?At(o,i-1,i):3==(d=o.childNodes[i-1]).nodeType?At(d):1==d.nodeType&&"BR"!=d.nodeName?d:null;if(m){var v=x(m,1);if(v.top<v.bottom)return b(v,!1)}}else if(h>0&&i<r(o)){var g=void 0,y=3==o.nodeType?At(o,i,i+1):3==(g=o.childNodes[i]).nodeType?At(g):1==g.nodeType?g:null;if(y){var w=x(y,-1);if(w.top<w.bottom)return b(w,!0)}}return b(x(3==o.nodeType?At(o):o,0),!1)}function b(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function k(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function S(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o.focus()}}function M(e,t,n){var r=t.selection,o="up"==n?r.$anchor.min(r.$head):r.$anchor.max(r.$head);return S(e,t,function(){for(var t=e.docView.domFromPos(o.pos),r=t.node;;){var i=e.docView.nearestDesc(r,!0);if(!i)break;if(i.node.isBlock){r=i.dom;break}r=i.dom.parentNode}for(var s=w(e,o.pos),a=r.firstChild;a;a=a.nextSibling){var c=void 0;if(1==a.nodeType)c=a.getClientRects();else{if(3!=a.nodeType)continue;c=At(a,0,a.nodeValue.length).getClientRects()}for(var f=0;f<c.length;f++){var l=c[f];if(l.bottom>l.top&&("up"==n?l.bottom<s.top+1:l.top>s.bottom-1))return!1}}return!0})}function O(e,t,n){var r=t.selection,o=r.$head;if(!o.parent.isTextblock)return!1;var i=o.parentOffset,s=!i,a=i==o.parent.content.size,c=getSelection();return Bt.test(o.parent.textContent)&&c.modify?S(e,t,function(){var t=c.getRangeAt(0),r=c.focusNode,i=c.focusOffset,s=c.caretBidiLevel;c.modify("move",n,"character");var a=o.depth?e.docView.domAfterPos(o.before()):e.dom,f=!a.contains(1==c.focusNode.nodeType?c.focusNode:c.focusNode.parentNode)||r==c.focusNode&&i==c.focusOffset;return c.removeAllRanges(),c.addRange(t),null!=s&&(c.caretBidiLevel=s),f}):"left"==n||"backward"==n?s:a}function C(e,t,n){return Lt==t&&$t==n?Ft:(Lt=t,$t=n,Ft="up"==n||"down"==n?M(e,t,n):O(e,t,n))}function T(e,t,n,r,o){return P(r,t,e),new Yt(null,e,t,n,r,r,r,o,0)}function E(e,t){for(var n=e.firstChild,r=0;r<t.length;r++){var o=t[r],i=o.dom;if(i.parentNode==e){for(;i!=n;)n=R(n);n=n.nextSibling}else e.insertBefore(i,n);if(o instanceof Xt){var s=n?n.previousSibling:e.lastChild;E(o.contentDOM,o.children),n=s?s.nextSibling:e.firstChild}}for(;n;)n=R(n)}function N(e){e&&(this.nodeName=e)}function j(e,t,n){if(0==e.length)return nn;for(var r=n?nn[0]:new N,o=[r],i=0;i<e.length;i++){var s=e[i].type.attrs,a=r;if(s){s.nodeName&&o.push(a=new N(s.nodeName));for(var c in s){var f=s[c];null!=f&&(n&&1==o.length&&o.push(a=r=new N(t.isInline?"span":"div")),"class"==c?a.class=(a.class?a.class+" ":"")+f:"style"==c?a.style=(a.style?a.style+";":"")+f:"nodeName"!=c&&(a[c]=f))}}}return o}function z(e,t,n,r){if(n==nn&&r==nn)return t;for(var o=t,i=0;i<r.length;i++){var s=r[i],a=n[i];if(i){var c=void 0;a&&a.nodeName==s.nodeName&&o!=e&&(c=t.parentNode)&&c.tagName.toLowerCase()==s.nodeName?o=c:(c=document.createElement(s.nodeName),c.appendChild(o),o=c)}D(o,a||nn[0],s)}return o}function D(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" "):Ut,s=n.class?n.class.split(" "):Ut,a=0;a<i.length;a++)s.indexOf(i[a])==-1&&e.classList.remove(i[a]);for(var c=0;c<s.length;c++)i.indexOf(s[c])==-1&&e.classList.add(s[c])}if(t.style!=n.style){if(t.style)for(var f,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;f=l.exec(t.style);)e.style[f[1].toLowerCase()]="";n.style&&(e.style.cssText+=n.style)}}function P(e,t,n){return z(e,e,nn,j(t,n,1!=e.nodeType))}function A(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function R(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}function I(e,t){for(var n=[],r=e.childCount,o=t.length-1;r>0&&o>=0;o--){var i=t[o],s=i.node;if(s){if(s!=e.child(r-1))break;n.push(i),--r}}return{nodes:n.reverse(),offset:r}}function V(e,t){return e.type.side-t.type.side}function B(e,t,n,r){var o=t.locals(e),i=0;if(0!=o.length)for(var s=0,a=[],c=null,f=0;;){if(s<o.length&&o[s].to==i){for(var l=o[s++],p=void 0;s<o.length&&o[s].to==i;)(p||(p=[l])).push(o[s++]);if(p){p.sort(V);for(var u=0;u<p.length;u++)n(p[u],f)}else n(l,f)}var h=void 0,d=void 0;if(c)d=-1,h=c,c=null;else{if(!(f<e.childCount))break;d=f,h=e.child(f++)}for(var m=0;m<a.length;m++)a[m].to<=i&&a.splice(m--,1);for(;s<o.length&&o[s].from==i;)a.push(o[s++]);var v=i+h.nodeSize;if(h.isText){var g=v;s<o.length&&o[s].from<g&&(g=o[s].from);for(var y=0;y<a.length;y++)a[y].to<g&&(g=a[y].to);g<v&&(c=h.cut(g-i),h=h.cut(0,g-i),v=g,d=-1)}r(h,a.length?a.slice():Ut,t.forChild(i,h),d),i=v}else for(var x=0;x<e.childCount;x++){var w=e.child(x);r(w,o,t.forChild(i,w),x),i+=w.nodeSize}}function L(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}function $(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];e=e.childNodes[t-1],t=r(e)}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}function F(e,t,n,r){for(var o="",i=0,s=0;i<e.childCount;i++){var a=e.child(i),c=s+a.nodeSize;if(a.isText){if(o+=a.text,c>=r){for(var f=c-o.length,l=o.lastIndexOf(t);l>-1&&f+l>n;)l=o.lastIndexOf(t,l-1);if(l>-1&&f+l+t.length>=r)return f+l;if(c>r)break}}else o="";s=c}return-1}function _(e,t,n,r,o){for(var i=[],s=0,a=0;s<e.length;s++){var c=e[s],f=a,l=a+=c.size;f>=n||l<=t?i.push(c):(f<t&&i.push(c.slice(0,t-f,r)),o&&(i.push(o),o=null),l>n&&i.push(c.slice(n-f,c.size,r)))}return i}function q(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Ee.Selection.findFrom(s,t)}function J(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function K(e,t,n){var r=e.state.selection;if(r instanceof Ee.TextSelection){if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var o=q(e.state,t);return!!(o&&o instanceof Ee.NodeSelection)&&J(e,o)}var i,s=r.$head,a=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!a||a.isText)return!1;var c=t<0?s.pos-a.nodeSize:s.pos;return!!(a.isAtom||(i=e.docView.descAt(c))&&!i.contentDOM)&&(Ee.NodeSelection.isSelectable(a)?J(e,new Ee.NodeSelection(t<0?e.state.doc.resolve(s.pos-a.nodeSize):s)):!!Ct.webkit&&J(e,new Ee.TextSelection(e.state.doc.resolve(t<0?c:c+a.nodeSize))))}if(r instanceof Ee.NodeSelection&&r.node.isInline)return J(e,new Ee.TextSelection(t>0?r.$to:r.$from));var f=q(e.state,t);return!!f&&J(e,f)}function H(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function W(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function U(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,s=!1;for(Ct.gecko&&1==n.nodeType&&r<H(n)&&W(n.childNodes[r])&&(s=!0);;)if(r>0){if(1!=n.nodeType)break;var a=n.childNodes[r-1];if(W(a))o=n,i=--r;else{if(3!=a.nodeType)break;n=a,r=n.nodeValue.length}}else{if(Z(n))break;for(var c=n.previousSibling;c&&W(c);)o=n.parentNode,i=Dt(c),c=c.previousSibling;if(c)n=c,r=H(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}s?X(e,t,n,r):o&&X(e,t,o,i)}}function G(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,s=H(n);;)if(r<s){if(1!=n.nodeType)break;var a=n.childNodes[r];if(!W(a))break;o=n,i=++r}else{if(Z(n))break;for(var c=n.nextSibling;c&&W(c);)o=c.parentNode,i=Dt(c)+1,c=c.nextSibling;if(c)n=c,r=0,s=H(n);else{if(n=n.parentNode,n==e.dom)break;r=s=0}}o&&X(e,t,o,i)}}function Z(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function X(e,t,n,r){if(Vt(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection()}function Y(e,t,n){var r=e.state.selection;if(r instanceof Ee.TextSelection&&!r.empty||n.indexOf("s")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var s=q(e.state,t);if(s&&s instanceof Ee.NodeSelection)return J(e,s)}if(!o.parent.inlineContent){var a=Ee.Selection.findFrom(t<0?o:i,t);return!a||J(e,a)}return!1}function Q(e,t){if(!(e.state.selection instanceof Ee.TextSelection))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var s=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(s&&!s.isText){var a=e.state.tr;return t<0?a.delete(r.pos-s.nodeSize,r.pos):a.delete(r.pos,r.pos+s.nodeSize),e.dispatch(a),!0}return!1}function ee(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function te(e){if(Ct.chrome&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;ee(e,o,!0),setTimeout(function(){return ee(e,o,!1)},20)}}}function ne(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}function oe(e,t){var n=t.keyCode,r=ne(t);return 8==n||Ct.mac&&72==n&&"c"==r?Q(e,-1)||U(e):46==n||Ct.mac&&68==n&&"c"==r?Q(e,1)||G(e):13==n||27==n||(37==n?K(e,-1,r)||U(e):39==n?K(e,1,r)||G(e):38==n?Y(e,-1,r)||U(e):40==n?te(e)||Y(e,1,r)||G(e):r==(Ct.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function ie(e,t){var n,r,o=e.root.getSelection(),i=e.state.doc,s=e.docView.nearestDesc(o.focusNode),a=s&&0==s.size,c=e.docView.posFromDOM(o.focusNode,o.focusOffset),f=i.resolve(c);if(Vt(o)){for(n=f;s&&!s.node;)s=s.parent;if(s&&s.node.isAtom&&Ee.NodeSelection.isSelectable(s.node)&&s.parent){var l=s.posBefore;r=new Ee.NodeSelection(c==l?f:i.resolve(l))}}else n=i.resolve(e.docView.posFromDOM(o.anchorNode,o.anchorOffset));if(!r){var p="pointer"==t||e.state.selection.head<f.pos&&!a?1:-1;r=ue(e,n,f,p)}return r}function se(e,t,n){var r=e.state.selection;if(le(e,r),e.editable&&!e.hasFocus()){if(!t)return;Ct.gecko&&Ct.gecko_version<=55&&(e.domObserver.disconnectSelection(),e.dom.focus(),e.domObserver.connectSelection())}else if(!(e.editable||de(e)&&document.activeElement.contains(e.dom)||t))return;if(e.domObserver.disconnectSelection(),e.cursorWrapper)fe(e);else{var o,i,s=r.anchor,a=r.head;!on||r instanceof Ee.TextSelection||(r.$from.parent.inlineContent||(o=ae(e,r.from)),r.empty||r.$from.parent.inlineContent||(i=ae(e,r.to))),e.docView.setSelection(s,a,e.root,n),on&&(o&&(o.contentEditable="false"),i&&(i.contentEditable="false")),r.visible?e.dom.classList.remove("ProseMirror-hideselection"):s!=a&&(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&ce(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}function ae(e,t){var n=e.docView.domFromPos(t),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,s=o?r.childNodes[o-1]:null;if(!(i&&"false"!=i.contentEditable||s&&"false"!=s.contentEditable)){if(i)return i.contentEditable="true",i;if(s)return s.contentEditable="true",s}}function ce(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),e.dom.classList.remove("ProseMirror-hideselection"))})}function fe(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,Dt(r)+1):n.setEnd(r,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&Ct.ie&&Ct.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}function le(e,t){if(t instanceof Ee.NodeSelection){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(pe(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else pe(e)}function pe(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function ue(e,t,n,r){return e.someProp("createSelectionBetween",function(r){return r(e,t,n)})||Ee.TextSelection.between(t,n,r)}function he(e){return(!e.editable||e.root.activeElement==e.dom)&&de(e)}function de(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function me(e){var t=e.docView.domFromPos(e.state.selection.anchor),n=e.root.getSelection();return Rt(t.node,t.offset,n.anchorNode,n.anchorOffset)}function ve(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,s=r.toOffset,a=r.from,c=r.to,f=e.root.getSelection(),l=null,p=f.anchorNode;if(p&&e.dom.contains(1==p.nodeType?p:p.parentNode)&&(l=[{node:p,offset:f.anchorOffset}],Vt(f)||l.push({node:f.focusNode,offset:f.focusOffset})),Ct.chrome&&8===e.lastKeyCode)for(var u=s;u>i;u--){var h=o.childNodes[u-1],d=h.pmViewDesc;if("BR"==h.nodeType&&!d){s=u;break}if(!d||d.size)break}var m=e.state.doc,v=e.someProp("domParser")||re.DOMParser.fromSchema(e.state.schema),g=m.resolve(a),y=null,x=v.parse(o,{topNode:g.parent,topMatch:g.parent.contentMatchAt(g.index()),topOpen:!0,from:i,to:s,preserveWhitespace:!g.parent.type.spec.code||"full",editableContent:!0,findPositions:l,ruleFromNode:ge(v,g),context:g});if(l&&null!=l[0].pos){var w=l[0].pos,b=l[1]&&l[1].pos;null==b&&(b=w),y={anchor:w+a,head:b+a}}return{doc:x,sel:y,from:a,to:c}}function ge(e,t){return function(n){var r=n.pmViewDesc;if(r)return r.parseRule();if("BR"==n.nodeName&&n.parentNode){if(Ct.safari&&/^(ul|ol)$/i.test(n.parentNode.nodeName))return e.matchTag(document.createElement("li"),t);if(n.parentNode.lastChild==n||Ct.safari&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if("IMG"==n.nodeName&&n.getAttribute("mark-placeholder"))return{ignore:!0}}}function ye(e,t,n,r){if(t<0){var o=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,s=ie(e,o);if(!e.state.selection.eq(s)){var a=e.state.tr.setSelection(s);"pointer"==o?a.setMeta("pointer",!0):"key"==o&&a.scrollIntoView(),e.dispatch(a)}}else{var c=e.state.doc.resolve(t),f=c.sharedDepth(n);t=c.before(f+1),n=e.state.doc.resolve(n).after(f+1);var l,p,u=e.state.selection,h=ve(e,t,n),d=e.state.doc,m=d.slice(h.from,h.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(l=e.state.selection.to,p="end"):(l=e.state.selection.from,p="start"),e.lastKeyCode=null;var v=Se(m.content,h.doc.content,h.from,l,p);if(v){e.domChangeCount++,e.state.selection.from<e.state.selection.to&&v.start==v.endB&&e.state.selection instanceof Ee.TextSelection&&(v.start>e.state.selection.from&&v.start<=e.state.selection.from+2?v.start=e.state.selection.from:v.endA<e.state.selection.to&&v.endA>=e.state.selection.to-2&&(v.endB+=e.state.selection.to-v.endA,v.endA=e.state.selection.to));var g,y=h.doc.resolveNoCache(v.start-h.from),x=h.doc.resolveNoCache(v.endB-h.from);if(!(!y.sameParent(x)&&y.pos<h.doc.content.size&&(g=Ee.Selection.findFrom(h.doc.resolve(y.pos+1),1,!0))&&g.head==x.pos&&e.someProp("handleKeyDown",function(t){return t(e,i(13,"Enter"))}))){if(e.state.selection.anchor>v.start&&be(d,v.start,v.endA,y,x)&&e.someProp("handleKeyDown",function(t){return t(e,i(8,"Backspace"))}))return void(Ct.android&&Ct.chrome&&e.domObserver.suppressSelectionUpdates());var w,b,k,S,M=v.start,O=v.endA;if(y.sameParent(x)&&y.parent.inlineContent)if(y.pos==x.pos)Ct.ie&&Ct.ie_version<=11&&0==y.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(function(){return se(e)},20)),w=e.state.tr.delete(M,O),b=d.resolve(v.start).marksAcross(d.resolve(v.endA));else if(v.endA==v.endB&&(S=d.resolve(v.start))&&(k=we(y.parent.content.cut(y.parentOffset,x.parentOffset),S.parent.content.cut(S.parentOffset,v.endA-S.start()))))w=e.state.tr,"add"==k.type?w.addMark(M,O,k.mark):w.removeMark(M,O,k.mark);else if(y.parent.child(y.index()).isText&&y.index()==x.index()-(x.textOffset?0:1)){var C=y.parent.textBetween(y.parentOffset,x.parentOffset);if(e.someProp("handleTextInput",function(t){return t(e,M,O,C)}))return;w=e.state.tr.insertText(C,M,O)}if(w||(w=e.state.tr.replace(M,O,h.doc.slice(v.start-h.from,v.endB-h.from))),h.sel){var T=xe(e,w.doc,h.sel);T&&w.setSelection(T)}b&&w.ensureMarks(b),e.dispatch(w.scrollIntoView())}}else if(!(r&&u instanceof Ee.TextSelection&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){var E=xe(e,e.state.doc,h.sel);E&&!E.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(E))}}else{var N=e.state,j=N.selection;e.dispatch(N.tr.replaceSelectionWith(N.schema.text(N.doc.textBetween(j.from,j.to)),!0).scrollIntoView())}}}function xe(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:ue(e,t.resolve(n.anchor),t.resolve(n.head))}function we(e,t){for(var n,r,o,i=e.firstChild.marks,s=t.firstChild.marks,a=i,c=s,f=0;f<s.length;f++)a=s[f].removeFromSet(a);for(var l=0;l<i.length;l++)c=i[l].removeFromSet(c);if(1==a.length&&0==c.length)r=a[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=a.length||1!=c.length)return null;r=c[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var p=[],u=0;u<t.childCount;u++)p.push(o(t.child(u)));if(re.Fragment.from(p).eq(e))return{mark:r,type:n}}function be(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||ke(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var s=e.resolve(ke(i,!0,!0));return!(!s.parent.isTextblock||s.pos>n||ke(s,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function ke(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function Se(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var s=e.findDiffEnd(t,n+e.size,n+t.size),a=s.a,c=s.b;if("end"==o){var f=Math.max(0,i-Math.min(a,c));r-=a+f-i}if(a<i&&e.size<t.size){var l=r<=i&&r>=a?i-r:0;i-=l,c=i+(c-a),a=i}else if(c<i){var p=r<=i&&r>=c?i-r:0;i-=p,a=i+(a-c),c=i}return{start:i,endA:a,endB:c}}function Me(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var s=r.firstChild;n.push(s.type.name,s.type.hasRequiredAttrs()?s.attrs:null),r=s.content}var a=e.someProp("clipboardSerializer")||re.DOMSerializer.fromSchema(e.state.schema),c=Ae(),f=c.createElement("div");f.appendChild(a.serializeFragment(r,{document:c}));for(var l,p=f.firstChild;p&&1==p.nodeType&&(l=sn[p.nodeName.toLowerCase()]);){for(var u=l.length-1;u>=0;u--){for(var h=c.createElement(l[u]);f.firstChild;)h.appendChild(f.firstChild);f.appendChild(h)}p=f.firstChild}p&&1==p.nodeType&&p.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n));var d=e.someProp("clipboardTextSerializer",function(e){return e(t)})||t.content.textBetween(0,t.content.size,"\n\n");return{dom:f,text:d}}function Oe(e,t,n,r,o){var i,s,a=o.parent.type.spec.code;if(!n&&!t)return null;var c=t&&(r||a||!n);if(c){if(e.someProp("transformPastedText",function(e){t=e(t)}),a)return new re.Slice(re.Fragment.from(e.state.schema.text(t)),0,0);var f=e.someProp("clipboardTextParser",function(e){return e(t,o)});f?s=f:(i=document.createElement("div"),t.trim().split(/(?:\r\n?|\n)+/).forEach(function(e){i.appendChild(document.createElement("p")).textContent=e}))}else e.someProp("transformPastedHTML",function(e){n=e(n)}),i=Re(n);var l=i&&i.querySelector("[data-pm-slice]"),p=l&&/^(\d+) (\d+) (.*)/.exec(l.getAttribute("data-pm-slice"));if(!s){var u=e.someProp("clipboardParser")||e.someProp("domParser")||re.DOMParser.fromSchema(e.state.schema);s=u.parseSlice(i,{preserveWhitespace:!(!c&&!p),context:o})}return s=p?Ie(Pe(s,+p[1],+p[2]),p[3]):re.Slice.maxOpen(Ce(s.content,o),!1),e.someProp("transformPasted",function(e){s=e(s)}),s}function Ce(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n),o=r.contentMatchAt(t.index(n)),i=void 0,s=[];if(e.forEach(function(e){if(s){var t,n=o.findWrapping(e.type);if(!n)return s=null;if(t=s.length&&i.length&&je(n,i,e,s[s.length-1],0))s[s.length-1]=t;else{s.length&&(s[s.length-1]=ze(s[s.length-1],i.length));var r=Ne(e,n);s.push(r),o=o.matchType(r.type,r.attrs),i=n}}}),s)return{v:re.Fragment.from(s)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}function Ne(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,re.Fragment.from(e));return e}function je(e,t,n,r,o){if(o<e.length&&o<t.length&&e[o]==t[o]){var i=je(e,t,n,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));var s=r.contentMatchAt(r.childCount);if(s.matchType(o==e.length-1?n.type:e[o+1]))return r.copy(r.content.append(re.Fragment.from(Ne(n,e,o+1))))}}function ze(e,t){if(0==t)return e;var n=e.content.replaceChild(e.childCount-1,ze(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(re.Fragment.empty,!0);return e.copy(n.append(r))}function De(e,t,n,r,o,i){var s=t<0?e.firstChild:e.lastChild,a=s.content;return o<r-1&&(a=De(a,t,n,r,o+1,i)),o>=n&&(a=t<0?s.contentMatchAt(0).fillBefore(a,e.childCount>1||i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(re.Fragment.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,s.copy(a))}function Pe(e,t,n){return t<e.openStart&&(e=new re.Slice(De(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new re.Slice(De(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}function Ae(){return an||(an=document.implementation.createHTMLDocument("title"))}function Re(e){var t=/(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=Ae().createElement("div"),o=/(?:<meta [^>]*>)*<([a-z][^>\s]+)/i.exec(e),i=0;(n=o&&sn[o[1].toLowerCase()])&&(e=n.map(function(e){return"<"+e+">"}).join("")+e+n.map(function(e){return"</"+e+">"}).reverse().join(""),i=n.length),r.innerHTML=e;for(var s=0;s<i;s++)r=r.firstChild;return r}function Ie(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(t){return e}for(var o=e.content,i=e.openStart,s=e.openEnd,a=n.length-2;a>=0;a-=2){var c=r.nodes[n[a]];if(!c||c.hasRequiredAttrs())break;o=re.Fragment.from(c.create(n[a+1],o)),i++,s++}return new re.Slice(o,i,s)}function Ve(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new pn(e,function(t,n,r){return ye(e,t,n,r)}),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var n=un[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!_e(e,t)||Fe(e,t)||!e.editable&&t.type in hn||n(e,t)})};for(var n in un)t(n);Ct.safari&&e.dom.addEventListener("input",function(){return null}),$e(e)}function Be(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function Le(e){e.domObserver.stop();for(var t in e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout)}function $e(e){e.someProp("handleDOMEvents",function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(t){return Fe(e,t)})})}function Fe(e,t){return e.someProp("handleDOMEvents",function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function _e(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function qe(e,t){Fe(e,t)||!un[t.type]||!e.editable&&t.type in hn||un[t.type](e,t)}function Je(e){return{left:e.clientX,top:e.clientY}}function Ke(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}function He(e,t,n,r,o){if(r==-1)return!1;for(var i=e.state.doc.resolve(r),s=function(r){if(e.someProp(t,function(t){return r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)}))return{v:!0}},a=i.depth+1;a>0;a--){var c=s(a);if(c)return c.v}return!1}function We(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function Ue(e,t){if(t==-1)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Ee.NodeSelection.isSelectable(r))&&(We(e,new Ee.NodeSelection(n),"pointer"),!0)}function Ge(e,t){if(t==-1)return!1;var n,r,o=e.state.selection;o instanceof Ee.NodeSelection&&(n=o.node);for(var i=e.state.doc.resolve(t),s=i.depth+1;s>0;s--){var a=s>i.depth?i.nodeAfter:i.node(s);if(Ee.NodeSelection.isSelectable(a)){r=n&&o.$from.depth>0&&s>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(s);break}}return null!=r&&(We(e,Ee.NodeSelection.create(e.state.doc,r),"pointer"),!0)}function Ze(e,t,n,r,o){return He(e,"handleClickOn",t,n,r)||e.someProp("handleClick",function(n){return n(e,t,r)})||(o?Ge(e,n):Ue(e,n))}function Xe(e,t,n,r){return He(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",function(n){return n(e,t,r)})}function Ye(e,t,n,r){return He(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",function(n){return n(e,t,r)})||Qe(e,n)}function Qe(e,t){var n=e.state.doc;if(t==-1)return!!n.inlineContent&&(We(e,Ee.TextSelection.create(n,0,n.content.size),"pointer"),!0);for(var r=n.resolve(t),o=r.depth+1;o>0;o--){var i=o>r.depth?r.nodeAfter:r.node(o),s=r.before(o);if(i.inlineContent)We(e,Ee.TextSelection.create(n,s+1,s+1+i.content.size),"pointer");else{if(!Ee.NodeSelection.isSelectable(i))continue;We(e,Ee.NodeSelection.create(n,s),"pointer")}return!0}}function et(e){return rt(e)}function tt(e,t){return!!e.composing||!!(Ct.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}function nt(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout(function(){return rt(e)},t))}function rt(e,t){for(e.composing=!1;e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty();return!(!t&&!e.docView.dirty)&&(e.updateState(e.state),!0)}function ot(e,t){var n=e.dom.ownerDocument,r=n.body.appendChild(n.createElement("div"));r.appendChild(t),r.style.cssText="position: fixed; left: -10000px; top: 10px";var o=getSelection(),i=n.createRange();i.selectNodeContents(t),e.dom.blur(),o.removeAllRanges(),o.addRange(i),setTimeout(function(){n.body.removeChild(r),e.focus()},50)}function it(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}function st(e,t){var n=e.dom.ownerDocument,r=e.shiftKey||e.state.selection.$from.parent.type.spec.code,o=n.body.appendChild(n.createElement(r?"textarea":"div"));r||(o.contentEditable="true"),o.style.cssText="position: fixed; left: -10000px; top: 10px",o.focus(),setTimeout(function(){e.focus(),n.body.removeChild(o),r?at(e,o.value,null,t):at(e,o.textContent,o.innerHTML,t)},50)}function at(e,t,n,r){var o=Oe(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",function(t){return t(e,r,o||re.Slice.empty)})||!o)return!0;var i=it(o),s=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(s.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function ct(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}function ft(e,t,n,r,o,i,s){for(var a=e.slice(),c=function(e,t,n,r){for(var s=0;s<a.length;s+=3){var c=a[s+1],f=void 0;c==-1||e>c+i||(t>=a[s]+i?a[s+1]=-1:(f=r-n-(t-e)+(i-o))&&(a[s]+=f,a[s+1]+=f))}},f=0;f<n.maps.length;f++)n.maps[f].forEach(c);for(var l=!1,p=0;p<a.length;p+=3)if(a[p+1]==-1){var u=n.map(a[p]+i),h=u-o;if(h<0||h>=r.content.size){l=!0;continue}var d=n.map(e[p+1]+i,-1),m=d-o,v=r.content.findIndex(h),g=v.index,y=v.offset,x=r.maybeChild(g);if(x&&y==h&&y+x.nodeSize==m){var w=a[p+2].mapInner(n,x,u+1,a[p]+i+1,s);w!=Nn?(a[p]=h,a[p+1]=m,a[p+2]=w):(a[p+1]=-2,l=!0)}else l=!0}if(l){var b=pt(a,e,t||[],n,o,i,s),k=dt(b,r,0,s);t=k.local;for(var S=0;S<a.length;S+=3)a[S+1]<0&&(a.splice(S,3),S-=3);for(var M=0,O=0;M<k.children.length;M+=3){for(var C=k.children[M];O<a.length&&a[O]<C;)O+=3;a.splice(O,0,k.children[M],k.children[M+1],k.children[M+2])}}return new En(t&&t.sort(mt),a)}function lt(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new Mn(o.from+t,o.to+t,o.type))}return n}function pt(e,t,n,r,o,i,s){function a(e,t){for(var i=0;i<e.local.length;i++){var c=e.local[i].map(r,o,t);c?n.push(c):s.onRemove&&s.onRemove(e.local[i].spec)}for(var f=0;f<e.children.length;f+=3)a(e.children[f+2],e.children[f]+t+1)}for(var c=0;c<e.length;c+=3)e[c+1]==-1&&a(e[c+2],t[c]+i+1);return n}function ut(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,s=void 0;i<e.length;i++)(s=e[i])&&s.from>n&&s.to<r&&((o||(o=[])).push(s),e[i]=null);return o}function ht(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function dt(e,t,n,r){var o=[],i=!1;t.forEach(function(t,s){var a=ut(e,t,s+n);if(a){i=!0;var c=dt(a,t,n+s+1,r);c!=Nn&&o.push(s,s+t.nodeSize,c)}});for(var s=lt(i?ht(e):e,-n).sort(mt),a=0;a<s.length;a++)s[a].type.valid(t,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new En(s,o):Nn}function mt(e,t){return e.from-t.from||e.to-t.to}function vt(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];{if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),gt(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),gt(t,o+1,i.copy(r.to,i.to)))}}}return t}function gt(e,t,n){for(;t<e.length&&mt(n,e[t])>0;)t++;e.splice(t,0,n)}function yt(e){var t=[];return e.someProp("decorations",function(n){var r=n(e.state);r&&r!=Nn&&t.push(r)}),e.cursorWrapper&&t.push(En.create(e.state.doc,[e.cursorWrapper.deco])),jn.from(t)}function xt(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r?t.class+=" "+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))}),[Mn.node(0,e.state.doc.content.size,t)]}function wt(e){var t=e.state.selection,n=t.$head,r=t.$anchor,o=t.visible;if(e.markCursor){var i=document.createElement("img");i.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:i,deco:Mn.widget(n.pos,i,{raw:!0,marks:e.markCursor})}}else if(o||n.pos!=r.pos)e.cursorWrapper=null;else{var s;!e.cursorWrapper||e.cursorWrapper.dom.childNodes.length?(s=document.createElement("div"),s.style.position="absolute",s.style.left="-100000px"):e.cursorWrapper.deco.pos!=n.pos&&(s=e.cursorWrapper.dom),s&&(e.cursorWrapper={dom:s,deco:Mn.widget(n.pos,s,{raw:!0})})}}function bt(e){return!e.someProp("editable",function(t){return t(e.state)===!1})}function kt(e){var t=e.getSelection(),n=t.focusOffset,r=t.focusNode;return r&&3!=r.nodeType?[r,n,1==r.nodeType?r.childNodes[n-1]:null,1==r.nodeType?r.childNodes[n]:null]:null}function St(e,t){var n=kt(t);if(!n||3==n[0].nodeType)return!1;for(var r=0;r<e.length;r++)if(n[r]!=e[r])return!0;return!1}function Mt(e){var t={};return e.someProp("nodeViews",function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}),t}function Ot(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r}Object.defineProperty(t,"__esModule",{value:!0});var Ct={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var Tt=/Edge\/(\d+)/.exec(navigator.userAgent),Et=/MSIE \d/.test(navigator.userAgent),Nt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);Ct.mac=/Mac/.test(navigator.platform);var jt=Ct.ie=!!(Et||Nt||Tt);Ct.ie_version=Et?document.documentMode||6:Nt?+Nt[1]:Tt?+Tt[1]:null,Ct.gecko=!jt&&/gecko\/(\d+)/i.test(navigator.userAgent),Ct.gecko_version=Ct.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var zt=!jt&&/Chrome\/(\d+)/.exec(navigator.userAgent);Ct.chrome=!!zt,Ct.chrome_version=zt&&+zt[1],Ct.ios=!jt&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Ct.android=/Android \d/.test(navigator.userAgent),Ct.webkit=!jt&&"WebkitAppearance"in document.documentElement.style,Ct.safari=/Apple Computer/.test(navigator.vendor),Ct.webkit_version=Ct.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var Dt=function(e){for(var t=0;;t++)if(e=e.previousSibling,!e)return t},Pt=function(e){var t=e.parentNode;return t&&11==t.nodeType?t.host:t},At=function(e,t,n){var r=document.createRange();return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},Rt=function(e,t,r,o){return r&&(n(e,t,r,o,-1)||n(e,t,r,o,1))},It=/^(img|br|input|textarea|hr)$/i,Vt=function(e){var t=e.isCollapsed;return t&&Ct.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t},Bt=/[\u0590-\u08ac]/,Lt=null,$t=null,Ft=!1,_t=0,qt=1,Jt=2,Kt=3,Ht=function(e,t,n,r){this.parent=e,this.children=t,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=_t},Wt={beforePosition:{},size:{},border:{},posBefore:{},posAtStart:{},posAfter:{},posAtEnd:{},contentLost:{}};Ht.prototype.matchesWidget=function(){return!1},Ht.prototype.matchesMark=function(){return!1},Ht.prototype.matchesNode=function(){return!1},Ht.prototype.matchesHack=function(){return!1},Wt.beforePosition.get=function(){return!1},Ht.prototype.parseRule=function(){return null},Ht.prototype.stopEvent=function(){return!1},Wt.size.get=function(){for(var e=this,t=0,n=0;n<this.children.length;n++)t+=e.children[n].size;return t},Wt.border.get=function(){return 0},Ht.prototype.destroy=function(){var e=this;this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var t=0;t<this.children.length;t++)e.children[t].destroy()},Ht.prototype.posBeforeChild=function(e){for(var t=this,n=0,r=this.posAtStart;n<this.children.length;n++){var o=t.children[n];if(o==e)return r;r+=o.size}},Wt.posBefore.get=function(){return this.parent.posBeforeChild(this)},Wt.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},Wt.posAfter.get=function(){return this.posBefore+this.size},Wt.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},Ht.prototype.localPosFromDOM=function(e,t,n){var r=this;if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var o,i;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&(!(i=o.pmViewDesc)||i.parent!=this);)o=o.previousSibling;return o?this.posBeforeChild(i)+i.size:this.posAtStart}var s,a;if(e==this.contentDOM)s=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;s=e.nextSibling}for(;s&&(!(a=s.pmViewDesc)||a.parent!=this);)s=s.nextSibling;return s?this.posBeforeChild(a):this.posAtEnd}var c;if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))c=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var f=e;;f=f.parentNode){if(f==r.dom){c=!1;break}if(f.parentNode.firstChild!=f)break}if(null==c&&t==e.childNodes.length)for(var l=e;;l=l.parentNode){if(l==r.dom){c=!0;break}if(l.parentNode.lastChild!=l)break}}return(null==c?n>0:c)?this.posAtEnd:this.posAtStart},Ht.prototype.nearestDesc=function(e,t){for(var n=this,r=!0,o=e;o;o=o.parentNode){var i=n.getDesc(o);if(i&&(!t||i.node)){if(!r||!i.nodeDOM||(1==i.nodeDOM.nodeType?i.nodeDOM.contains(e):i.nodeDOM==e))return i;r=!1}}},Ht.prototype.getDesc=function(e){for(var t=this,n=e.pmViewDesc,r=n;r;r=r.parent)if(r==t)return n},Ht.prototype.posFromDOM=function(e,t,n){for(var r=this,o=e;;o=o.parentNode){var i=r.getDesc(o);if(i)return i.localPosFromDOM(e,t,n)}},Ht.prototype.descAt=function(e){for(var t=this,n=0,r=0;n<this.children.length;n++){var o=t.children[n],i=r+o.size;if(r==e&&i!=r){for(;!o.border&&o.children.length;)o=o.children[0];return o}if(e<i)return o.descAt(e-r-o.border);r=i}},Ht.prototype.domFromPos=function(e){var t=this;if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0;;r++){if(n==e){for(;r<this.children.length&&(this.children[r].beforePosition||this.children[r].dom.parentNode!=this.contentDOM);)r++;return{node:t.contentDOM,offset:r==t.children.length?t.contentDOM.childNodes.length:Dt(t.children[r].dom)}}if(r==t.children.length)throw new Error("Invalid position "+e);var o=t.children[r],i=n+o.size;if(e<i)return o.domFromPos(e-n-o.border);n=i}},Ht.prototype.parseRange=function(e,t,n){var r=this;if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var o=-1,i=-1,s=n,a=0;;a++){var c=r.children[a],f=s+c.size;if(o==-1&&e<=f){var l=s+c.border;if(e>=l&&t<=f-c.border&&c.node&&c.contentDOM&&r.contentDOM.contains(c.contentDOM))return c.parseRange(e,t,l);e=s;for(var p=a;p>0;p--){var u=r.children[p-1];if(u.size&&u.dom.parentNode==r.contentDOM&&!u.emptyChildAt(1)){o=Dt(u.dom)+1;break}e-=u.size}o==-1&&(o=0)}if(o>-1&&t<=f){t=f;for(var h=a+1;h<this.children.length;h++){var d=r.children[h];if(d.size&&d.dom.parentNode==r.contentDOM&&!d.emptyChildAt(-1)){i=Dt(d.dom);break}t+=d.size}i==-1&&(i=r.contentDOM.childNodes.length);break}s=f}return{node:this.contentDOM,from:e,to:t,fromOffset:o,toOffset:i}},Ht.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},Ht.prototype.domAfterPos=function(e){var t=this.domFromPos(e),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]},Ht.prototype.setSelection=function(e,t,n,r){for(var o=this,i=Math.min(e,t),s=Math.max(e,t),a=0,c=0;a<this.children.length;a++){var f=o.children[a],l=c+f.size;if(i>c&&s<l)return f.setSelection(e-c-f.border,t-c-f.border,n,r);c=l}var p=this.domFromPos(e),u=this.domFromPos(t),h=n.getSelection(),d=document.createRange();if(r||!Rt(p.node,p.offset,h.anchorNode,h.anchorOffset)||!Rt(u.node,u.offset,h.focusNode,h.focusOffset)){if(h.extend)d.setEnd(p.node,p.offset),d.collapse(!1);else{if(e>t){var m=p;p=u,u=m}d.setEnd(u.node,u.offset),d.setStart(p.node,p.offset)}h.removeAllRanges(),h.addRange(d),h.extend&&h.extend(u.node,u.offset)}},Ht.prototype.ignoreMutation=function(e){return!this.contentDOM},Wt.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},Ht.prototype.markDirty=function(e,t){for(var n=this,r=0,o=0;o<this.children.length;o++){var i=n.children[o],s=r+i.size;if(r==s?e<=s&&t>=r:e<s&&t>r){var a=r+i.border,c=s-i.border;if(e>=a&&t<=c)return n.dirty=e==r||t==s?Jt:qt,void(e!=a||t!=c||!i.contentLost&&i.dom.parentNode==n.contentDOM?i.markDirty(e-a,t-a):i.dirty=Kt);i.dirty=Kt}r=s}this.dirty=Jt},Ht.prototype.markParentsDirty=function(){for(var e=this.parent;e;e=e.parent){var t=Jt;e.dirty<t&&(e.dirty=t)}},Object.defineProperties(Ht.prototype,Wt);var Ut=[],Gt=function(e){function t(t,n,r,o){var i,s=n.type.toDOM;if("function"==typeof s&&(s=s(r,function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o})),!n.type.spec.raw){if(1!=s.nodeType){var a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable=!1,s.classList.add("ProseMirror-widget")}e.call(this,t,Ut,s,null),this.widget=n,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={beforePosition:{}};return n.beforePosition.get=function(){return this.widget.type.side<0},t.prototype.matchesWidget=function(e){return this.dirty==_t&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},Object.defineProperties(t.prototype,n),t}(Ht),Zt=function(e){function t(t,n,r,o){e.call(this,t,Ut,n,null),this.textDOM=r,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,n),t}(Ht),Xt=function(e){function t(t,n,r,o){e.call(this,t,[],r,o),this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,n,r,o){var i=o.nodeViews[n.type.name],s=i&&i(n,o,r);return s&&s.dom||(s=re.DOMSerializer.renderSpec(document,n.type.spec.toDOM(n,r))),new t(e,n,s.dom,s.contentDOM||s.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return this.dirty!=Kt&&this.mark.eq(e)},t.prototype.markDirty=function(t,n){if(e.prototype.markDirty.call(this,t,n),this.dirty!=_t){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=_t}},t.prototype.slice=function(e,n,r){var o=t.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;n<s&&(i=_(i,n,s,r)),e>0&&(i=_(i,0,e,r));for(var a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o},t}(Ht),Yt=function(e){function t(t,n,r,o,i,s,a,c,f){e.call(this,t,n.isLeaf?Ut:[],i,s),this.nodeDOM=a,this.node=n,this.outerDeco=r,this.innerDeco=o,s&&this.updateChildren(c,f)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{},border:{}};return t.create=function(e,n,r,o,i,s){var a,c=i.nodeViews[n.type.name],f=c&&c(n,i,function(){return a?a.parent?a.parent.posBeforeChild(a):void 0:s},r),l=f&&f.dom,p=f&&f.contentDOM;if(n.isText)if(l){if(3!=l.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else l=document.createTextNode(n.text);else if(!l){var u;u=re.DOMSerializer.renderSpec(document,n.type.spec.toDOM(n)),l=u.dom,p=u.contentDOM}p||n.isText||"BR"==l.nodeName||(l.hasAttribute("contenteditable")||(l.contentEditable=!1),n.type.spec.draggable&&(l.draggable=!0));var h=l;return l=P(l,r,n),f?a=new tn(e,n,r,o,l,p,h,f,i,s+1):n.isText?new Qt(e,n,r,o,l,h,i):new t(e,n,r,o,l,p,h,i,s+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?re.Fragment.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,n){return this.dirty==_t&&e.eq(this.node)&&A(t,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var n=this,r=this.node.inlineContent,o=t,i=r&&e.composing&&this.localCompositionNode(e,t),s=new rn(this,i&&i.node);B(this.node,this.innerDeco,function(t,i){t.spec.marks?s.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&s.syncToMarks(i==n.node.childCount?re.Mark.none:n.node.child(i).marks,r,e),s.placeWidget(t,e,o)},function(t,n,i,a){s.syncToMarks(t.marks,r,e),s.findNodeMatch(t,n,i,a)||s.updateNextNode(t,n,i,e,a)||s.addNode(t,n,i,e,o),o+=t.nodeSize}),s.syncToMarks(Ut,r,e),this.node.isTextblock&&s.addTextblockHacks(),s.destroyRest(),(s.changed||this.dirty==Jt)&&(i&&this.protectLocalComposition(e,i),this.renderChildren())},t.prototype.renderChildren=function(){E(this.contentDOM,this.children,t.is),Ct.ios&&L(this.dom)},t.prototype.localCompositionNode=function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(!(e.state.selection instanceof Ee.TextSelection)||r<t||o>t+this.node.content.size)){var i=e.root.getSelection(),s=$(i.focusNode,i.focusOffset);if(s&&this.dom.contains(s.parentNode)){var a=s.nodeValue,c=F(this.node.content,a,r-t,o-t);return c<0?null:{node:s,pos:c,text:a}}}},t.prototype.protectLocalComposition=function(e,t){var n=this,r=t.node,o=t.pos,i=t.text;if(!this.getDesc(r)){for(var s=r;s.parentNode!=n.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=null)}var a=new Zt(this,s,r,i);e.compositionNodes.push(a),this.children=_(this.children,o,o+i.length,e,a)}},t.prototype.update=function(e,t,n,r){return!(this.dirty==Kt||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)},t.prototype.updateInner=function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=_t},t.prototype.updateOuterDeco=function(e){if(!A(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=z(this.dom,this.nodeDOM,j(this.outerDeco,this.node,t),j(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!1)},Object.defineProperties(t.prototype,n),t}(Ht),Qt=function(e){function t(t,n,r,o,i,s,a){e.call(this,t,n,r,o,i,null,s,a)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseRule=function(){return{skip:this.nodeDOM.parentNode||!0}},t.prototype.update=function(e,t){return!(this.dirty==Kt||this.dirty!=_t&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),this.dirty==_t&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text),this.node=e,this.dirty=_t,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,n,r)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,n,r){var o=this.node.cut(e,n),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},t}(Yt),en=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(){return this.dirty==_t},t}(Ht),tn=function(e){function t(t,n,r,o,i,s,a,c,f,l){e.call(this,t,n,r,o,i,s,a,f,l),this.spec=c}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,n,r,o){if(this.dirty==Kt)return!1;if(this.spec.update){var i=this.spec.update(t,n);return i&&this.updateInner(t,n,r,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,n,r,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,n,r,o){this.spec.setSelection?this.spec.setSelection(t,n,r):e.prototype.setSelection.call(this,t,n,r,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(Yt);N.prototype=Object.create(null);var nn=[new N],rn=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1;var n=I(e.node.content,e.children);this.preMatched=n.nodes,this.preMatchOffset=n.offset};rn.prototype.getPreMatch=function(e){return e>=this.preMatchOffset?this.preMatched[e-this.preMatchOffset]:null},rn.prototype.destroyBetween=function(e,t){var n=this;if(e!=t){for(var r=e;r<t;r++)n.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}},rn.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},rn.prototype.syncToMarks=function(e,t,n){for(var r=this,o=0,i=this.stack.length>>1,s=Math.min(i,e.length);o<s&&(o==i-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<i;)r.destroyRest(),r.top.dirty=_t,r.index=r.stack.pop(),r.top=r.stack.pop(),i--;for(;i<e.length;){r.stack.push(r.top,r.index+1);for(var a=-1,c=this.index;c<Math.min(this.index+3,this.top.children.length);c++)if(r.top.children[c].matchesMark(e[i])){a=c;break}if(a>-1)a>r.index&&(r.changed=!0,r.destroyBetween(r.index,a)),r.top=r.top.children[r.index];else{var f=Xt.create(r.top,e[i],t,n);r.top.children.splice(r.index,0,f),r.top=f,r.changed=!0}r.index=0,i++}},rn.prototype.findNodeMatch=function(e,t,n,r){var o=this,i=-1,s=r<0?void 0:this.getPreMatch(r),a=this.top.children;if(s&&s.matchesNode(e,t,n))i=a.indexOf(s);else for(var c=this.index,f=Math.min(a.length,c+5);c<f;c++){var l=a[c];if(l.matchesNode(e,t,n)&&o.preMatched.indexOf(l)<0){i=c;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},rn.prototype.updateNextNode=function(e,t,n,r,o){if(this.index==this.top.children.length)return!1;var i=this.top.children[this.index];if(i instanceof Yt){var s=this.preMatched.indexOf(i);if(s>-1&&s+this.preMatchOffset!=o)return!1;var a=i.dom,c=this.lock&&(a==this.lock||1==a.nodeType&&a.contains(this.lock.parentNode))&&!(e.isText&&i.node&&i.node.isText&&i.nodeDOM.nodeValue==e.text&&i.dirty!=Kt&&A(t,i.outerDeco));if(!c&&i.update(e,t,n,r))return i.dom!=a&&(this.changed=!0),this.index++,!0}return!1},rn.prototype.addNode=function(e,t,n,r,o){this.top.children.splice(this.index++,0,Yt.create(this.top,e,t,n,r,o)),this.changed=!0},rn.prototype.placeWidget=function(e,t,n){if(this.index<this.top.children.length&&this.top.children[this.index].matchesWidget(e))this.index++;else{var r=new Gt(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}},rn.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof Xt;)e=e.children[e.children.length-1];if(!e||!(e instanceof Qt)||/\n$/.test(e.node.text))if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack())this.index++;else{var t=document.createElement("br");this.top.children.splice(this.index++,0,new en(this.top,Ut,t,null)),this.changed=!0}};var on=Ct.safari||Ct.chrome&&Ct.chrome_version<63,sn={thead:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},an=null,cn={childList:!0,characterData:!0,attributes:!0,subtree:!0,characterDataOldValue:!0},fn=Ct.ie&&Ct.ie_version<=11,ln=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};ln.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},ln.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var pn=function(e,t){var n=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=!1,this.observer=window.MutationObserver&&new window.MutationObserver(function(e){for(var t=0;t<e.length;t++)n.queue.push(e[t]);Ct.ie&&Ct.ie_version<=11&&e.some(function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length})?n.flushSoon():n.flush()}),this.currentSelection=new ln,fn&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};pn.prototype.flushSoon=function(){var e=this;this.flushingSoon||(this.flushingSoon=!0,window.setTimeout(function(){e.flushingSoon=!1,e.flush()},20))},pn.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,cn),fn&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},pn.prototype.stop=function(){var e=this,t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)e.queue.push(t[n]);window.setTimeout(function(){return e.flush()},20)}this.observer&&this.observer.disconnect(),fn&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},pn.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},pn.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},pn.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout(function(){return e.suppressingSelectionUpdates=!1},50)},pn.prototype.onSelectionChange=function(){if(he(this.view)){if(this.suppressingSelectionUpdates)return se(this.view);if(Ct.ie&&Ct.ie_version<=11&&!this.view.state.selection.empty){var e=this.view.root.getSelection();if(e.focusNode&&Rt(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}},pn.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},pn.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})},pn.prototype.flush=function(){var e=this;if(this.view.docView&&!this.flushingSoon){var t=this.observer.takeRecords();this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);var n=this.view.root.getSelection(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&de(this.view)&&!this.ignoreSelectionChange(n),o=-1,i=-1,s=!1;if(this.view.editable)for(var a=0;a<t.length;a++){var c=e.registerMutation(t[a]);c&&(o=o<0?c.from:Math.min(c.from,o),i=i<0?c.to:Math.max(c.to,i),c.typeOver&&!e.view.composing&&(s=!0))}(o>-1||r)&&(o>-1&&this.view.docView.markDirty(o,i),this.handleDOMChange(o,i,s),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||se(this.view))}},pn.prototype.registerMutation=function(e){var t=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(t==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!t||t.ignoreMutation(e))return null;if("childList"==e.type){var n=e.previousSibling,r=e.nextSibling;if(Ct.ie&&Ct.ie_version<=11){for(;n&&"BR"==n.nodeName;)n=n.previousSibling;for(;r&&"BR"==r.nodeName;)r=r.previousSibling}var o=n&&n.parentNode==e.target?Dt(n)+1:0,i=t.localPosFromDOM(e.target,o,-1),s=r&&r.parentNode==e.target?Dt(r):e.target.childNodes.length,a=t.localPosFromDOM(e.target,s,1);return{from:i,to:a}}return"attributes"==e.type?{from:t.posAtStart-t.border,to:t.posAtEnd+t.border}:{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var un={},hn={};hn.keydown=function(e,t){e.shiftKey=16==t.keyCode||t.shiftKey,tt(e,t)||(e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),e.someProp("handleKeyDown",function(n){return n(e,t)})||oe(e,t)?t.preventDefault():Be(e,"key"))},hn.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},hn.keypress=function(e,t){if(!(tt(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||Ct.mac&&t.metaKey)){if(e.someProp("handleKeyPress",function(n){return n(e,t)}))return void t.preventDefault();var n=e.state.selection;if(!(n instanceof Ee.TextSelection&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",function(t){return t(e,n.$from.pos,n.$to.pos,r)})||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var dn=Ct.mac?"metaKey":"ctrlKey";un.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=et(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&Ke(t,e.lastClick)&&!t[dn]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(Je(t));i&&("singleClick"==o?e.mouseDown=new mn(e,i,t,n):("doubleClick"==o?Xe:Ye)(e,i.pos,i.inside,t)?t.preventDefault():Be(e,"pointer"))};var mn=function(e,t,n,r){var o=this;this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=n,this.flushed=r,this.selectNode=n[dn],this.allowDefault=n.shiftKey;var i,s;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{var a=e.state.doc.resolve(t.pos);i=a.parent,s=a.depth?a.before():0}this.mightDrag=null;var c=r?null:n.target,f=c?e.docView.nearestDesc(c,!0):null;this.target=f?f.dom:null,(i.type.spec.draggable&&i.type.spec.selectable!==!1||e.state.selection instanceof Ee.NodeSelection&&s==e.state.selection.from)&&(this.mightDrag={node:i,pos:s,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&Ct.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(function(){return o.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),Be(e,"pointer")};mn.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!1),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},mn.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Je(e))),this.allowDefault||!t?Be(this.view,"pointer"):Ze(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():!this.flushed&&(!Ct.chrome||this.view.state.selection instanceof Ee.TextSelection||t.pos!=this.view.state.selection.from&&t.pos!=this.view.state.selection.to)?Be(this.view,"pointer"):(We(this.view,Ee.Selection.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault())}},mn.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),Be(this.view,"pointer")},un.touchdown=function(e){et(e),Be(e,"pointer")},un.contextmenu=function(e){return et(e)};var vn=Ct.android?5e3:-1;hn.compositionstart=hn.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(function(e){return e.type.spec.inclusive===!1})))e.markCursor=e.state.storedMarks||n.marks(),rt(e,!0),e.markCursor=null;else if(rt(e),Ct.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var s=i<0?o.lastChild:o.childNodes[i-1];if(3==s.nodeType){r.collapse(s,s.nodeValue.length);break}o=s,i=-1}e.composing=!0}nt(e,vn)},hn.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,nt(e,20))};var gn=Ct.ie&&Ct.ie_version<15||Ct.ios&&Ct.webkit_version<604;un.copy=hn.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var o=gn?null:t.clipboardData,i=n.content(),s=Me(e,i),a=s.dom,c=s.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",c)):ot(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},hn.paste=function(e,t){var n=gn?null:t.clipboardData;n&&(at(e,n.getData("text/plain"),n.getData("text/html"),t)||n.files.length>0)?t.preventDefault():st(e,t)};var yn=function(e,t){this.slice=e,this.move=t},xn=Ct.mac?"altKey":"ctrlKey";un.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords(Je(t));if(o&&o.pos>=r.from&&o.pos<=(r instanceof Ee.NodeSelection?r.to-1:r.to));else if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(Ee.NodeSelection.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);if(!i||!i.node.type.spec.draggable||i==e.docView)return;e.dispatch(e.state.tr.setSelection(Ee.NodeSelection.create(e.state.doc,i.posBefore)))}var s=e.state.selection.content(),a=Me(e,s),c=a.dom,f=a.text;t.dataTransfer.clearData(),t.dataTransfer.setData(gn?"Text":"text/html",c.innerHTML),gn||t.dataTransfer.setData("text/plain",f),e.dragging=new yn(s,!t[xn])}},un.dragend=function(e){window.setTimeout(function(){return e.dragging=null},50)},hn.dragover=hn.dragenter=function(e,t){return t.preventDefault()},hn.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(Je(t));if(r){var o=e.state.doc.resolve(r.pos);if(o){var i=n&&n.slice||Oe(e,t.dataTransfer.getData(gn?"Text":"text/plain"),gn?null:t.dataTransfer.getData("text/html"),!1,o);if(i&&(t.preventDefault(),!e.someProp("handleDrop",function(r){return r(e,t,i,n&&n.move)}))){var s=i?Te.dropPoint(e.state.doc,o.pos,i):o.pos;null==s&&(s=o.pos);var a=e.state.tr;n&&n.move&&a.deleteSelection();var c=a.mapping.map(s),f=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,l=a.doc;if(f?a.replaceRangeWith(c,c,i.content.firstChild):a.replaceRange(c,c,i),!a.doc.eq(l)){var p=a.doc.resolve(c);f&&Ee.NodeSelection.isSelectable(i.content.firstChild)&&p.nodeAfter&&p.nodeAfter.sameMarkup(i.content.firstChild)?a.setSelection(new Ee.NodeSelection(p)):a.setSelection(ue(e,p,a.doc.resolve(a.mapping.map(s)))),e.focus(),e.dispatch(a.setMeta("uiEvent","drop"))}}}}}},un.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0)},un.blur=function(e){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),e.focused=!1)},un.beforeinput=function(e,t){if(Ct.chrome&&Ct.android&&"deleteContentBackward"==t.inputType){var n=e.domChangeCount;setTimeout(function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",function(t){return t(e,i(8,"Backspace"))}))){var t=e.state.selection,r=t.$cursor;r&&r.pos>0&&e.dispatch(e.state.tr.delete(r.pos-1,r.pos).scrollIntoView())}},50)}};for(var wn in hn)un[wn]=hn[wn];var bn=function(e,t){this.spec=t||Tn,this.side=this.spec.side||0,this.toDOM=e};bn.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos,s=o.deleted;return s?null:new Mn(i-n,i-n,this)},bn.prototype.valid=function(){return!0},bn.prototype.eq=function(e){return this==e||e instanceof bn&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&ct(this.spec,e.spec))};var kn=function(e,t){this.spec=t||Tn,this.attrs=e};kn.prototype.map=function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new Mn(o,i,this)},kn.prototype.valid=function(e,t){return t.from<t.to},kn.prototype.eq=function(e){return this==e||e instanceof kn&&ct(this.attrs,e.attrs)&&ct(this.spec,e.spec)},kn.is=function(e){return e.type instanceof kn};var Sn=function(e,t){this.spec=t||Tn,this.attrs=e};Sn.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new Mn(o.pos-n,i.pos-n,this)},Sn.prototype.valid=function(e,t){var n=e.content.findIndex(t.from),r=n.index,o=n.offset;return o==t.from&&o+e.child(r).nodeSize==t.to},Sn.prototype.eq=function(e){return this==e||e instanceof Sn&&ct(this.attrs,e.attrs)&&ct(this.spec,e.spec)};var Mn=function(e,t,n){this.from=e,this.to=t,this.type=n},On={spec:{}};Mn.prototype.copy=function(e,t){return new Mn(e,t,this.type)},Mn.prototype.eq=function(e){return this.type.eq(e.type)&&this.from==e.from&&this.to==e.to},Mn.prototype.map=function(e,t,n){return this.type.map(e,this,t,n)},Mn.widget=function(e,t,n){return new Mn(e,e,new bn(t,n))},Mn.inline=function(e,t,n,r){return new Mn(e,t,new kn(n,r))},Mn.node=function(e,t,n,r){return new Mn(e,t,new Sn(n,r))},On.spec.get=function(){return this.type.spec},Object.defineProperties(Mn.prototype,On);var Cn=[],Tn={},En=function(e,t){this.local=e&&e.length?e:Cn,this.children=t&&t.length?t:Cn};En.create=function(e,t){return t.length?dt(t,e,0,Tn):Nn},En.prototype.find=function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r},En.prototype.findInner=function(e,t,n,r,o){for(var i=this,s=0;s<this.local.length;s++){var a=i.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(var c=0;c<this.children.length;c+=3)if(i.children[c]<t&&i.children[c+1]>e){var f=i.children[c]+1;i.children[c+2].findInner(e-f,t-f,n,r+f,o)}},En.prototype.map=function(e,t,n){return this==Nn||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Tn)},En.prototype.mapInner=function(e,t,n,r,o){for(var i,s=this,a=0;a<this.local.length;a++){var c=s.local[a].map(e,n,r);c&&c.type.valid(t,c)?(i||(i=[])).push(c):o.onRemove&&o.onRemove(s.local[a].spec)}return this.children.length?ft(this.children,i,e,t,n,r,o):i?new En(i.sort(mt)):Nn},En.prototype.add=function(e,t){return t.length?this==Nn?En.create(e,t):this.addInner(e,t,0):this},En.prototype.addInner=function(e,t,n){var r,o=this,i=0;e.forEach(function(e,s){var a,c=s+n;if(a=ut(t,e,c)){for(r||(r=o.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,a,c+1):r.splice(i,0,s,s+e.nodeSize,dt(a,e,c+1,Tn)),i+=3}});var s=lt(i?ht(t):t,-n);return new En(s.length?this.local.concat(s).sort(mt):this.local,r||this.children)},En.prototype.remove=function(e){return 0==e.length||this==Nn?this:this.removeInner(e,0)},En.prototype.removeInner=function(e,t){for(var n=this,r=this.children,o=this.local,i=0;i<r.length;i+=3){for(var s=void 0,a=r[i]+t,c=r[i+1]+t,f=0,l=void 0;f<e.length;f++)(l=e[f])&&l.from>a&&l.to<c&&(e[f]=null,(s||(s=[])).push(l));if(s){r==n.children&&(r=n.children.slice());var p=r[i+2].removeInner(s,a+1);p!=Nn?r[i+2]=p:(r.splice(i,3),i-=3)}}if(o.length)for(var u=0,h=void 0;u<e.length;u++)if(h=e[u])for(var d=0;d<o.length;d++)o[d].type.eq(h.type)&&(o==n.local&&(o=n.local.slice()),o.splice(d--,1));return r==this.children&&o==this.local?this:o.length||r.length?new En(o,r):Nn},En.prototype.forChild=function(e,t){var n=this;if(this==Nn)return this;if(t.isLeaf)return En.empty;for(var r,o,i=0;i<this.children.length;i+=3)if(n.children[i]>=e){n.children[i]==e&&(r=n.children[i+2]);break}for(var s=e+1,a=s+t.content.size,c=0;c<this.local.length;c++){var f=n.local[c];if(f.from<a&&f.to>s&&f.type instanceof kn){var l=Math.max(s,f.from)-s,p=Math.min(a,f.to)-s;l<p&&(o||(o=[])).push(f.copy(l,p))}}if(o){var u=new En(o.sort(mt));return r?new jn([u,r]):u}return r||Nn},En.prototype.eq=function(e){var t=this;if(this==e)return!0;if(!(e instanceof En)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var n=0;n<this.local.length;n++)if(!t.local[n].eq(e.local[n]))return!1;for(var r=0;r<this.children.length;r+=3)if(t.children[r]!=e.children[r]||t.children[r+1]!=e.children[r+1]||!t.children[r+2].eq(e.children[r+2]))return!1;return!0},En.prototype.locals=function(e){return vt(this.localsInner(e))},En.prototype.localsInner=function(e){var t=this;if(this==Nn)return Cn;if(e.inlineContent||!this.local.some(kn.is))return this.local;for(var n=[],r=0;r<this.local.length;r++)t.local[r].type instanceof kn||n.push(t.local[r]);return n};var Nn=new En;En.empty=Nn,En.removeOverlap=vt;var jn=function(e){this.members=e};jn.prototype.forChild=function(e,t){var n=this;if(t.isLeaf)return En.empty;for(var r=[],o=0;o<this.members.length;o++){var i=n.members[o].forChild(e,t);i!=Nn&&(i instanceof jn?r=r.concat(i.members):r.push(i))}return jn.from(r)},jn.prototype.eq=function(e){var t=this;if(!(e instanceof jn)||e.members.length!=this.members.length)return!1;for(var n=0;n<this.members.length;n++)if(!t.members[n].eq(e.members[n]))return!1;return!0},jn.prototype.locals=function e(t){for(var n,r=this,o=!0,i=0;i<this.members.length;i++){var e=r.members[i].localsInner(t);if(e.length)if(n){o&&(n=n.slice(),o=!1);for(var s=0;s<e.length;s++)n.push(e[s])}else n=e}return n?vt(o?n:n.sort(mt)):Cn},jn.from=function(e){switch(e.length){case 0:return Nn;case 1:return e[0];default:return new jn(e)}};var zn=function(e,t){this._props=t,this.state=t.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=bt(this),this.markCursor=null,this.cursorWrapper=null,wt(this),this.nodeViews=Mt(this),this.docView=T(this.state.doc,xt(this),yt(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,Ve(this),this.pluginViews=[],this.updatePluginViews()},Dn={props:{},root:{}};Dn.props.get=function(){var e=this;if(this._props.state!=this.state){var t=this._props;this._props={};for(var n in t)e._props[n]=t[n];this._props.state=this.state}return this._props},zn.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&$e(this),this._props=e,this.updateStateInner(e.state,!0)},zn.prototype.setProps=function(e){var t=this,n={};for(var r in t._props)n[r]=t._props[r];n.state=this.state;for(var o in e)n[o]=e[o];this.update(n)},zn.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},zn.prototype.updateStateInner=function(e,t){var n=this,r=this.state,o=!1;if(this.state=e,t){var i=Mt(this);Ot(i,this.nodeViews)&&(this.nodeViews=i,o=!0),$e(this)}this.editable=bt(this),wt(this);var s=yt(this),a=xt(this),p=t?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",u=o||!this.docView.matchesNode(e.doc,a,s),h=u||!e.selection.eq(r.selection),d="preserve"==p&&h&&null==this.dom.style.overflowAnchor&&f(this);if(h){this.domObserver.stop();var m=!1;if(u){var v=Ct.chrome&&kt(this.root);!o&&this.docView.update(e.doc,a,s,this)||(this.docView.destroy(),this.docView=T(e.doc,a,s,this.dom,this)),v&&(m=!this.composing&&St(v,this.root)),Ct.ie&&Ct.ie_version<=11&&!r.selection.empty&&e.selection.empty&&e.doc.content.size<r.doc.content.size&&(m=!0)}m||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&me(this))?se(this,!1,m):(le(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==p)this.dom.scrollTop=0;else if("to selection"==p){var g=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",function(e){return e(n)})||(e.selection instanceof Ee.NodeSelection?c(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),g):c(this,this.coordsAtPos(e.selection.head),g))}else d&&l(d)},zn.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},zn.prototype.updatePluginViews=function(e){var t=this;if(e&&e.plugins==this.state.plugins)for(var n=0;n<this.pluginViews.length;n++){var r=t.pluginViews[n];r.update&&r.update(t,e)}else{this.destroyPluginViews();for(var o=0;o<this.state.plugins.length;o++){var i=t.state.plugins[o];i.spec.view&&t.pluginViews.push(i.spec.view(t))}}},zn.prototype.someProp=function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var s=o[i].props[e];if(null!=s&&(n=t?t(s):s))return n}},zn.prototype.hasFocus=function(){return this.root.activeElement==this.dom},zn.prototype.focus=function(){this.domObserver.stop(),se(this,!0),this.editable&&(this.dom.setActive?this.dom.setActive():this.dom.focus({preventScroll:!0})),this.domObserver.start()},Dn.root.get=function(){var e=this,t=this._root;if(null==t)for(var n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return e._root=n;return t||document},zn.prototype.posAtCoords=function(e){return y(this,e)},zn.prototype.coordsAtPos=function(e){return w(this,e)},zn.prototype.domAtPos=function(e){return this.docView.domFromPos(e)},zn.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},zn.prototype.posAtDOM=function(e,t,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},zn.prototype.endOfTextblock=function(e,t){return C(this,t||this.state,e)},zn.prototype.destroy=function(){this.docView&&(Le(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],yt(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},zn.prototype.dispatchEvent=function(e){return qe(this,e)},zn.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties(zn.prototype,Dn),t.EditorView=zn,t.Decoration=Mn,t.DecorationSet=En,t.__serializeForClipboard=Me,t.__parseFromClipboard=Oe,t.__endComposition=rt});r(Pe);var Ae=Pe.EditorView,Re=Pe.Decoration,Ie=Pe.DecorationSet,Ve=(Pe.__serializeForClipboard,Pe.__parseFromClipboard,Pe.__endComposition,o(function(e,t){function n(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function r(e,t,n){var r=e.selection,i=r.$cursor;if(!i||(n?!n.endOfTextblock("backward",e):i.parentOffset>0))return!1;var a=s(i);if(!a){var c=i.blockRange(),f=c&&Te.liftTarget(c);return null!=f&&(t&&t(e.tr.lift(c,f).scrollIntoView()),!0)}var l=a.nodeBefore;if(!l.type.spec.isolating&&k(e,a,t))return!0;if(0==i.parent.content.size&&(o(l,"end")||Ee.NodeSelection.isSelectable(l))){if(t){var p=e.tr.deleteRange(i.before(),i.after());p.setSelection(o(l,"end")?Ee.Selection.findFrom(p.doc.resolve(p.mapping.map(a.pos,-1)),-1):Ee.NodeSelection.create(p.doc,a.pos-l.nodeSize)),t(p.scrollIntoView())}return!0}return!(!l.isAtom||a.depth!=i.depth-1)&&(t&&t(e.tr.delete(a.pos-l.nodeSize,a.pos).scrollIntoView()),!0)}function o(e,t){for(;e;e="start"==t?e.firstChild:e.lastChild)if(e.isTextblock)return!0;return!1}function i(e,t,n){var r=e.selection,o=r.$cursor;if(!o||(n?!n.endOfTextblock("backward",e):o.parentOffset>0))return!1;var i=s(o),a=i&&i.nodeBefore;return!(!a||!Ee.NodeSelection.isSelectable(a))&&(t&&t(e.tr.setSelection(Ee.NodeSelection.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)}function s(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function a(e,t,n){var r=e.selection,i=r.$cursor;if(!i||(n?!n.endOfTextblock("forward",e):i.parentOffset<i.parent.content.size))return!1;var s=f(i);if(!s)return!1;var a=s.nodeAfter;if(k(e,s,t))return!0;if(0==i.parent.content.size&&(o(a,"start")||Ee.NodeSelection.isSelectable(a))){if(t){var c=e.tr.deleteRange(i.before(),i.after());c.setSelection(o(a,"start")?Ee.Selection.findFrom(c.doc.resolve(c.mapping.map(s.pos)),1):Ee.NodeSelection.create(c.doc,c.mapping.map(s.pos))),t(c.scrollIntoView())}return!0}return!(!a.isAtom||s.depth!=i.depth-1)&&(t&&t(e.tr.delete(s.pos,s.pos+a.nodeSize).scrollIntoView()),!0)}function c(e,t,n){var r=e.selection,o=r.$cursor;if(!o||(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size))return!1;var i=f(o),s=i&&i.nodeAfter;return!(!s||!Ee.NodeSelection.isSelectable(s))&&(t&&t(e.tr.setSelection(Ee.NodeSelection.create(e.doc,i.pos)).scrollIntoView()),!0)}function f(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function l(e,t){var n,r=e.selection,o=r instanceof Ee.NodeSelection;if(o){if(r.node.isTextblock||!Te.canJoin(e.doc,r.from))return!1;n=r.from}else if(n=Te.joinPoint(e.doc,r.from,-1),null==n)return!1;if(t){var i=e.tr.join(n);o&&i.setSelection(Ee.NodeSelection.create(i.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(i.scrollIntoView())}return!0}function p(e,t){var n,r=e.selection;if(r instanceof Ee.NodeSelection){if(r.node.isTextblock||!Te.canJoin(e.doc,r.to))return!1;n=r.to}else if(n=Te.joinPoint(e.doc,r.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0}function u(e,t){var n=e.selection,r=n.$from,o=n.$to,i=r.blockRange(o),s=i&&Te.liftTarget(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}function h(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}function d(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),s=r.indexAfter(-1),a=i.contentMatchAt(s).defaultType;if(!i.canReplaceWith(s,s,a))return!1;if(t){var c=r.after(),f=e.tr.replaceWith(c,c,a.createAndFill());f.setSelection(Ee.Selection.near(f.doc.resolve(c),1)),t(f.scrollIntoView())}return!0}function m(e,t){var n=e.selection,r=n.$from,o=n.$to;if(r.parent.inlineContent||o.parent.inlineContent)return!1;var i=r.parent.contentMatchAt(o.indexAfter()).defaultType;if(!i||!i.isTextblock)return!1;if(t){var s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=e.tr.insert(s,i.createAndFill());a.setSelection(Ee.TextSelection.create(a.doc,s+1)),t(a.scrollIntoView())}return!0}function v(e,t){var n=e.selection,r=n.$cursor;if(!r||r.parent.content.size)return!1;if(r.depth>1&&r.after()!=r.end(-1)){var o=r.before();if(Te.canSplit(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}var i=r.blockRange(),s=i&&Te.liftTarget(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)}function g(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof Ee.NodeSelection&&e.selection.node.isBlock)return!(!r.parentOffset||!Te.canSplit(e.doc,r.pos))&&(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,s=e.tr;e.selection instanceof Ee.TextSelection&&s.deleteSelection();var a=0==r.depth?null:r.node(-1).contentMatchAt(r.indexAfter(-1)).defaultType,c=i&&a?[{type:a}]:null,f=Te.canSplit(s.doc,r.pos,1,c);c||f||!Te.canSplit(s.doc,s.mapping.map(r.pos),1,a&&[{type:a}])||(c=[{type:a}],f=!0),f&&(s.split(s.mapping.map(r.pos),1,c),i||r.parentOffset||r.parent.type==a||!r.node(-1).canReplace(r.index(-1),r.indexAfter(-1),re.Fragment.from(a.create(),r.parent))||s.setNodeMarkup(s.mapping.map(r.before()),a)),t(s.scrollIntoView())}return!0}function y(e,t){return g(e,t&&function(n){var r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();r&&n.ensureMarks(r),t(n)})}function x(e,t){var n,r=e.selection,o=r.$from,i=r.to,s=o.sharedDepth(i);return 0!=s&&(n=o.before(s),t&&t(e.tr.setSelection(Ee.NodeSelection.create(e.doc,n))),!0)}function w(e,t){return t&&t(e.tr.setSelection(new Ee.AllSelection(e.doc))),!0}function b(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!!(r&&o&&r.type.compatibleContent(o.type))&&(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(i,i+1)||!o.isTextblock&&!Te.canJoin(e.doc,t.pos))&&(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0))}function k(e,t,n){var r,o,i=t.nodeBefore,s=t.nodeAfter;if(i.type.spec.isolating||s.type.spec.isolating)return!1;if(b(e,t,n))return!0;if(t.parent.canReplace(t.index(),t.index()+1)&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(s.type))&&o.matchType(r[0]||s.type).validEnd){if(n){for(var a=t.pos+s.nodeSize,c=re.Fragment.empty,f=r.length-1;f>=0;f--)c=re.Fragment.from(r[f].create(null,c));c=re.Fragment.from(i.copy(c));var l=e.tr.step(new Te.ReplaceAroundStep(t.pos-1,a,t.pos,a,new re.Slice(c,1,0),r.length,!0)),p=a+2*r.length;Te.canJoin(l.doc,p)&&l.join(p),n(l.scrollIntoView())}return!0}var u=Ee.Selection.findFrom(t,1),h=u&&u.$from.blockRange(u.$to),d=h&&Te.liftTarget(h);return null!=d&&d>=t.depth&&(n&&n(e.tr.lift(h,d).scrollIntoView()),!0)}function S(e,t){return function(n,r){var o=n.selection,i=o.$from,s=o.$to,a=i.blockRange(s),c=a&&Te.findWrapping(a,e,t);return!!c&&(r&&r(n.tr.wrap(a,c).scrollIntoView()),!0)}}function M(e,t){return function(n,r){var o=n.selection,i=o.from,s=o.to,a=!1;return n.doc.nodesBetween(i,s,function(r,o){if(a)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)a=!0;else{var i=n.doc.resolve(o),s=i.index();a=i.parent.canReplaceWith(s,s+1,e)}}),!!a&&(r&&r(n.tr.setBlockType(i,s,e,t).scrollIntoView()),!0)}}function O(e,t,n){for(var r=function(r){var o=t[r],i=o.$from,s=o.$to,a=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,s.pos,function(e){return!a&&void(a=e.inlineContent&&e.type.allowsMarkType(n))}),a)return{v:!0}},o=0;o<t.length;o++){var i=r(o);if(i)return i.v}return!1}function C(e,t){return function(n,r){var o=n.selection,i=o.empty,s=o.$cursor,a=o.ranges;if(i&&!s||!O(n.doc,a,e))return!1;if(r)if(s)r(e.isInSet(n.storedMarks||s.marks())?n.tr.removeStoredMark(e):n.tr.addStoredMark(e.create(t)));else{for(var c=!1,f=n.tr,l=0;!c&&l<a.length;l++){var p=a[l],u=p.$from,h=p.$to;c=n.doc.rangeHasMark(u.pos,h.pos,e)}for(var d=0;d<a.length;d++){var m=a[d],v=m.$from,g=m.$to;c?f.removeMark(v.pos,g.pos,e):f.addMark(v.pos,g.pos,e.create(t))}r(f.scrollIntoView())}return!0}}function T(e,t){return function(n){if(!n.isGeneric)return e(n);for(var r=[],o=0;o<n.mapping.maps.length;o++){for(var i=n.mapping.maps[o],s=0;s<r.length;s++)r[s]=i.map(r[s]);i.forEach(function(e,t,n,o){return r.push(n,o)});}for(var a=[],c=0;c<r.length;c+=2)for(var f=r[c],l=r[c+1],p=n.doc.resolve(f),u=p.sharedDepth(l),h=p.node(u),d=p.indexAfter(u),m=p.after(u+1);m<=l;++d){var v=h.maybeChild(d);if(!v)break;if(d&&a.indexOf(m)==-1){var g=h.child(d-1);g.type==v.type&&t(g,v)&&a.push(m)}m+=v.nodeSize}a.sort(function(e,t){return e-t});for(var y=a.length-1;y>=0;y--)Te.canJoin(n.doc,a[y])&&n.join(a[y]);e(n)}}function E(e,t){if(Array.isArray(t)){var n=t;t=function(e){return n.indexOf(e.type.name)>-1}}return function(n,r){return e(n,r&&T(r,t))}}function N(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}Object.defineProperty(t,"__esModule",{value:!0});var j=N(n,r,i),z=N(n,a,c),D={Enter:N(h,m,v,g),"Mod-Enter":d,Backspace:j,"Mod-Backspace":j,Delete:z,"Mod-Delete":z,"Mod-a":w},P={"Ctrl-h":D.Backspace,"Alt-Backspace":D["Mod-Backspace"],"Ctrl-d":D.Delete,"Ctrl-Alt-Backspace":D["Mod-Delete"],"Alt-Delete":D["Mod-Delete"],"Alt-d":D["Mod-Delete"]};for(var A in D)P[A]=D[A];var R="undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform(),I=R?P:D;t.deleteSelection=n,t.joinBackward=r,t.selectNodeBackward=i,t.joinForward=a,t.selectNodeForward=c,t.joinUp=l,t.joinDown=p,t.lift=u,t.newlineInCode=h,t.exitCode=d,t.createParagraphNear=m,t.liftEmptyBlock=v,t.splitBlock=g,t.splitBlockKeepMarks=y,t.selectParentNode=x,t.selectAll=w,t.wrapIn=S,t.setBlockType=M,t.toggleMark=C,t.autoJoin=E,t.chainCommands=N,t.pcBaseKeymap=D,t.macBaseKeymap=P,t.baseKeymap=I}));r(Ve);var Be=(Ve.deleteSelection,Ve.joinBackward,Ve.selectNodeBackward,Ve.joinForward,Ve.selectNodeForward,Ve.joinUp,Ve.joinDown,Ve.lift,Ve.newlineInCode,Ve.exitCode,Ve.createParagraphNear,Ve.liftEmptyBlock,Ve.splitBlock,Ve.splitBlockKeepMarks),Le=(Ve.selectParentNode,Ve.selectAll,Ve.wrapIn,Ve.setBlockType,Ve.toggleMark),$e=(Ve.autoJoin,Ve.chainCommands),Fe=(Ve.pcBaseKeymap,Ve.macBaseKeymap,Ve.baseKeymap),_e=200,qe=function(){};qe.prototype.append=function(e){return e.length?(e=qe.from(e),!this.length&&e||e.length<_e&&this.leafAppend(e)||this.length<_e&&e.leafPrepend(this)||this.appendInner(e)):this},qe.prototype.prepend=function(e){return e.length?qe.from(e).append(this):this},qe.prototype.appendInner=function(e){return new Ke(this,e)},qe.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?qe.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},qe.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},qe.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},qe.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},qe.from=function(e){return e instanceof qe?e:e&&e.length?new Je(e):qe.empty};var Je=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(e(this.values[o],r+o)===!1)return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(e(this.values[o],r+o)===!1)return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=_e)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=_e)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(qe);qe.empty=new Je([]);var Ke=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&this.left.forEachInner(e,t,Math.min(n,o),r)===!1)&&(!(n>o&&this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o)===!1)&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o)===!1)&&(!(n<o&&this.left.forEachInvertedInner(e,Math.min(t,o),n,r)===!1)&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(qe),He=qe,We=o(function(e,n){function r(e){return e&&"object"===t(e)&&"default"in e?e.default:e}function o(e,t){var n;return e.forEach(function(e,r){if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}function i(e,t,n,r){var o,i=n.getMeta(O);if(i)return i.historyState;n.getMeta(C)&&(e=new b(e.done,e.undone,null,0));var f=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(f&&f.getMeta(O))return f.getMeta(O).redo?new b(e.done.addTransform(n,null,r,l(t)),e.undone,a(n.mapping.maps[n.steps.length-1]),e.prevTime):new b(e.done,e.undone.addTransform(n,null,r,l(t)),null,e.prevTime);if(n.getMeta("addToHistory")===!1||f&&f.getMeta("addToHistory")===!1)return(o=n.getMeta("rebased"))?new b(e.done.rebased(n,o),e.undone.rebased(n,o),c(e.prevRanges,n.mapping),e.prevTime):new b(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),c(e.prevRanges,n.mapping),e.prevTime);var p=e.prevTime<(n.time||0)-r.newGroupDelay||!f&&!s(n,e.prevRanges),u=f?c(e.prevRanges,n.mapping):a(n.mapping.maps[n.steps.length-1]);return new b(e.done.addTransform(n,p?t.selection.getBookmark():null,r,l(t)),x.empty,u,n.time)}function s(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach(function(e,r){for(var o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)}),n}function a(e){var t=[];return e.forEach(function(e,n,r,o){return t.push(r,o)}),t}function c(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}function f(e,t,n,r){var o=l(t),i=O.get(t).spec.config,s=(r?e.undone:e.done).popEvent(t,o);if(s){var a=s.selection.resolve(s.transform.doc),c=(r?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,o),f=new b(r?c:s.remaining,r?s.remaining:c,null,0);n(s.transform.setSelection(a).setMeta(O,{redo:r,historyState:f}).scrollIntoView())}}function l(e){var t=e.plugins;if(M!=t){S=!1,M=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){S=!0;break}}return S}function p(e){return e.setMeta(C,!0)}function u(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new Ee.Plugin({key:O,state:{init:function(){return new b(x.empty,x.empty,null,0)},apply:function(t,n,r){return i(n,r,t,e)}},config:e})}function h(e,t){var n=O.getState(e);return!(!n||0==n.done.eventCount)&&(t&&f(n,e,t,!1),!0)}function d(e,t){var n=O.getState(e);return!(!n||0==n.undone.eventCount)&&(t&&f(n,e,t,!0),!0)}function m(e){var t=O.getState(e);return t?t.done.eventCount:0}function v(e){var t=O.getState(e);return t?t.undone.eventCount:0}Object.defineProperty(n,"__esModule",{value:!0});var g=r(He),y=500,x=function(e,t){this.items=e,this.eventCount=t};x.prototype.popEvent=function(e,t){var n=this;if(0==this.eventCount)return null;for(var r=this.items.length;;r--){var o=n.items.get(r-1);if(o.selection){--r;break}}var i,s;t&&(i=this.remapping(r,this.items.length),s=i.maps.length);var a,c,f=e.tr,l=[],p=[];return this.items.forEach(function(e,t){if(!e.step)return i||(i=n.remapping(r,t+1),s=i.maps.length),s--,void p.push(e);if(i){p.push(new w(e.map));var o,u=e.step.map(i.slice(s));u&&f.maybeStep(u).doc&&(o=f.mapping.maps[f.mapping.maps.length-1],l.push(new w(o,null,null,l.length+p.length))),s--,o&&i.appendMap(o,s)}else f.maybeStep(e.step);return e.selection?(a=i?e.selection.map(i.slice(s)):e.selection,c=new x(n.items.slice(0,r).append(p.reverse().concat(l)),n.eventCount-1),!1):void 0},this.items.length,0),{remaining:c,transform:f,selection:a}},x.prototype.addTransform=function(e,t,n,r){for(var i=[],s=this.eventCount,a=this.items,c=!r&&a.length?a.get(a.length-1):null,f=0;f<e.steps.length;f++){var l=e.steps[f].invert(e.docs[f]),p=new w(e.mapping.maps[f],l,t),u=void 0;(u=c&&c.merge(p))&&(p=u,f?i.pop():a=a.slice(0,a.length-1)),i.push(p),t&&(s++,t=null),r||(c=p)}var h=s-n.depth;return h>k&&(a=o(a,h),s-=h),new x(a.append(i),s)},x.prototype.remapping=function(e,t){var n=new Te.Mapping;return this.items.forEach(function(t,r){var o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?o=n.maps.length-t.mirrorOffset:null;n.appendMap(t.map,o)},e,t),n},x.prototype.addMaps=function(e){return 0==this.eventCount?this:new x(this.items.append(e.map(function(e){return new w(e)})),this.eventCount)},x.prototype.rebased=function(e,t){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,s=this.eventCount;this.items.forEach(function(e){e.selection&&s--},r);var a=t;this.items.forEach(function(t){var r=o.getMirror(--a);if(null!=r){i=Math.min(i,r);var c=o.maps[r];if(t.step){var f=e.steps[r].invert(e.docs[r]),l=t.selection&&t.selection.map(o.slice(a,r));l&&s++,n.push(new w(c,f,l))}else n.push(new w(c))}},r);for(var c=[],f=t;f<i;f++)c.push(new w(o.maps[f]));var l=this.items.slice(0,r).append(c).append(n),p=new x(l,s);return p.emptyItemCount()>y&&(p=p.compress(this.items.length-n.length)),p},x.prototype.emptyItemCount=function(){var e=0;return this.items.forEach(function(t){t.step||e++}),e},x.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach(function(i,s){if(s>=e)r.push(i),i.selection&&o++;else if(i.step){var a=i.step.map(t.slice(n)),c=a&&a.getMap();if(n--,c&&t.appendMap(c,n),a){var f=i.selection&&i.selection.map(t.slice(n));f&&o++;var l,p=new w(c.invert(),a,f),u=r.length-1;(l=r.length&&r[u].merge(p))?r[u]=l:r.push(p)}}else i.map&&n--},this.items.length,0),new x(g.from(r.reverse()),o)},x.empty=new x(g.empty,0);var w=function(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r};w.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new w(t.getMap().invert(),t,this.selection)}};var b=function(e,t,n,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r},k=20,S=!1,M=null,O=new Ee.PluginKey("history"),C=new Ee.PluginKey("closeHistory");n.HistoryState=b,n.closeHistory=p,n.history=u,n.undo=h,n.redo=d,n.undoDepth=m,n.redoDepth=v});r(We);for(var Ue=(We.HistoryState,We.closeHistory,We.history),Ge=We.undo,Ze=We.redo,Xe=(We.undoDepth,We.redoDepth,{8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"}),Ye={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Qe="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),et="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),tt="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),nt="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),rt="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),ot=Qe&&(nt||+Qe[1]<57)||tt&&nt,it=0;it<10;it++)Xe[48+it]=Xe[96+it]=String(it);for(var it=1;it<=24;it++)Xe[it+111]="F"+it;for(var it=65;it<=90;it++)Xe[it]=String.fromCharCode(it+32),Ye[it]=String.fromCharCode(it);for(var st in Xe)Ye.hasOwnProperty(st)||(Ye[st]=Xe[st]);var at,ct,ft="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),lt=function(){var e=null;return function(t,n,r){return n=n||100,r=r||this,clearTimeout(e),e=setTimeout(function(){t.apply(r,arguments)},n)}},pt="\0",ut=lt(),ht=lt(),dt=function(){return{active:!1,range:{from:0,to:0},type:"",text:"",suggestions:[],index:0}},mt={group:"inline",inline:!0,atom:!0,isText:!0,attrs:{name:{default:void 0},zuid:{default:void 0},email:""},selectable:!1,draggable:!1,toDOM:function(e){if(e.attrs.zuid)var t=e.attrs.zuid,n=editor.doc.userData[t]&&editor.doc.userData[t].fname||e.attrs.name;else var t="",n=e.attrs.name;var r=e.attrs.email,o=n||r;return["a",{"data-mention-zuid":t,"data-mention-name":n,"data-mention-email":r,href:"mailto:"+r,title:r,class:"prosemirror-mention-node"},"@"+o]},parseDOM:[{tag:"a[data-mention-email]",getAttrs:function(e){var t=e.getAttribute("data-mention-zuid")||null,n=e.getAttribute("data-mention-name"),r=e.getAttribute("data-mention-email");return{zuid:t,name:n,email:r}}}]},vt={group:"inline",inline:!0,atom:!0,attrs:{tag:""},selectable:!1,draggable:!1,toDOM:function(e){return["span",{"data-tag":e.attrs.tag,class:"prosemirror-tag-node"},"#"+e.attrs.tag]},parseDOM:[{tag:"span[data-tag]",getAttrs:function(e){var t=e.getAttribute("data-tag");return{tag:t}}}]},gt={inline:!0,attrs:{emojiName:""},group:"inline",atom:!0,selectable:!0,toDOM:function(e){var t=e.attrs.emojiName,n="zw-zomoji zomoji-w-24-"+t;return["span",{"emoji-name":t,class:n}]},parseDOM:[{tag:"span[class][emoji-name]",getAttrs:function(e){var t=e.getAttribute("emoji-name");return{emojiName:t}}}]},yt={":grinning:":["&#x1f600"],":grin:":["&#x1f601"],":joy:":["&#x1f602"],":smiley:":["&#x1f603"],":smile:":["&#x1f604"],":sweat-smile:":["&#x1f605"],":laughing:":["&#x1f606"],":wink:":["&#x1f609"],":blush:":["&#x1f60a"],":yum:":["&#x1f60b"],":sunglasses:":["&#x1f60e"],":heart-eyes:":["&#x1f60d"],":kissing-heart:":["&#x1f618"],":kissing:":["&#x1f617"],":kissing-smiling-eyes:":["&#x1f619"],":kissing-closed-eyes:":["&#x1f61a"],":slight-smile:":["&#x1f642"],":hug:":["&#x1f917"],":thinking:":["&#x1f914"],":neutral-face:":["&#x1f610"],":expressionless:":["&#x1f611"],":no-mouth:":["&#x1f636"],":rolling-eyes:":["&#x1f644"],":smirk:":["&#x1f60f"],":persevere:":["&#x1f623"],":cry:":["&#x1f622"],":open-mouth:":["&#x1f62e"],":zipper-mouth:":["&#x1f910"],":hushed:":["&#x1f62f"],":sleepy:":["&#x1f62a"],":tired-face:":["&#x1f62b"],":sleeping:":["&#x1f634"],":relieved:":["&#x1f60c"],":stuck-out-tongue:":["&#x1f61b"],":stuck-out-tongue-winking-eye:":["&#x1f61c"],":stuck-out-tongue-closed-eyes:":["&#x1f61d"],":unamused:":["&#x1f612"],":sweat:":["&#x1f613"],":pensive:":["&#x1f614"],":confused:":["&#x1f615"],":upside-down:":["&#x1f643"],":money-mouth:":["&#x1f911"],":astonished:":["&#x1f632"],":slight-frowning:":["&#x1f641"],":sad:":["&#x1f641"],":confounded:":["&#x1f616"],":disappointed:":["&#x1f61e"],":worried:":["&#x1f61f"],":triumph:":["&#x1f624"],":disappointed-relieved:":["&#x1f625"],":sob:":["&#x1f62d"],":frowning-with-open-mouth:":["&#x1f626"],":anguished:":["&#x1f627"],":fearful:":["&#x1f628"],":weary:":["&#x1f629"],":grimacing:":["&#x1f62c"],":cold-sweat:":["&#x1f630"],":scream:":["&#x1f631"],":flushed:":["&#x1f633"],":dizzy-face:":["&#x1f635"],":rage:":["&#x1f621"],":angry:":["&#x1f620"],":mask:":["&#x1f637"],":sick:":["&#x1f912"],":head-bandaged:":["&#x1f915"],":halo-smiling:":["&#x1f607"],":nerd:":["&#x1f913"],":smiling-with-horns:":["&#x1f608"],":imp:":["&#x1f47f"],":japanese-ogre:":["&#x1f479"],":japanese-goblin:":["&#x1f47a"],":skull:":["&#x1f480"],":ghost:":["&#x1f47b"],":alien:":["&#x1f47d"],":robot:":["&#x1f916"],":hankey:":["&#x1f4a9"],":smiley-cat:":["&#x1f63a"],":smile-cat:":["&#x1f638"],":joy-cat:":["&#x1f639"],":heart-eyes-cat:":["&#x1f63b"],":smirk-cat:":["&#x1f63c"],":kissing-cat:":["&#x1f63d"],":scream-cat:":["&#x1f640"],":crying-cat-face:":["&#x1f63f"],":pouting-cat:":["&#x1f63e"],":baby:":["&#x1f476"],":girl:":["&#x1f467"],":boy:":["&#x1f466"],":woman:":["&#x1f469"],":man:":["&#x1f468"],":older-woman:":["&#x1f475"],":older-man:":["&#x1f474"],":man-with-gua-pi-mao:":["&#x1f472"],":man-with-turban:":["&#x1f473"],":person-with-blond-hair:":["&#x1f471"],":cop:":["&#x1f46e"],":construction-worker:":["&#x1f477"],":guardsman:":["&#x1f482"],":detective:":["&#x1f575"],":bride-in-veil:":["&#x1f470"],":princess:":["&#x1f478"],":santa:":["&#x1f385"],":angel:":["&#x1f47c"],":bow:":["&#x1f647"],":information-desk-person:":["&#x1f481"],":no-good:":["&#x1f645"],":ok-woman:":["&#x1f646"],":raising-hand:":["&#x1f64b"],":person-with-pouting-face:":["&#x1f64e"],":person-frowning:":["&#x1f64d"],":haircut:":["&#x1f487"],":massage:":["&#x1f486"],":nail-care:":["&#x1f485"],":dancer:":["&#x1f483"],":dancers:":["&#x1f46f"],":levitating-man:":["&#x1f574"],":walking:":["&#x1f6b6"],":runner:":["&#x1f3c3"],":couple:":["&#x1f46b"],":boys:":["&#x1f46c"],":girls:":["&#x1f46d"],":couplekiss:":["&#x1f48f"],":couple-with-heart:":["&#x1f491"],":boyskiss:":["&#x1f468","&#x200d","&#x2764","&#xfe0f","&#x200d","&#x1f48b","&#x200d","&#x1f468"],":boys-with-heart:":["&#x1f468","&#x200d","&#x2764","&#xfe0f","&#x200d","&#x1f468"],":girlskiss:":["&#x1f469","&#x200d","&#x2764","&#xfe0f","&#x200d","&#x1f48b","&#x200d","&#x1f469"],":girls-with-heart:":["&#x1f469","&#x200d","&#x2764","&#xfe0f","&#x200d","&#x1f469"],":family:":["&#x1f46a"],":family-man-woman-girl:":["&#x1f468","&#x200d","&#x1f469","&#x200d","&#x1f467"],":family-man-woman-girl-boy:":["&#x1f468","&#x200d","&#x1f469","&#x200d","&#x1f467","&#x200d","&#x1f466"],":family-man-woman-boy-boy:":["&#x1f468","&#x200d","&#x1f469","&#x200d","&#x1f466","&#x200d","&#x1f466"],":family-man-woman-girl-girl:":["&#x1f468","&#x200d","&#x1f469","&#x200d","&#x1f467","&#x200d","&#x1f467"],":family-man-man-boy:":["&#x1f468","&#x200d","&#x1f468","&#x200d","&#x1f466"],":family-man-man-girl:":["&#x1f468","&#x200d","&#x1f468","&#x200d","&#x1f467"],":family-man-man-girl-boy:":["&#x1f468","&#x200d","&#x1f468","&#x200d","&#x1f467","&#x200d","&#x1f466"],":family-man-man-boy-boy:":["&#x1f468","&#x200d","&#x1f468","&#x200d","&#x1f466","&#x200d","&#x1f466"],":family-man-man-girl-girl:":["&#x1f468","&#x200d","&#x1f468","&#x200d","&#x1f467","&#x200d","&#x1f467"],":family-woman-woman-girl-boy:":["&#x1f469","&#x200d","&#x1f469","&#x200d","&#x1f467","&#x200d","&#x1f466"],":family-woman-woman-boy-boy:":["&#x1f469","&#x200d","&#x1f469","&#x200d","&#x1f466","&#x200d","&#x1f466"],":family-woman-woman-girl-girl:":["&#x1f469","&#x200d","&#x1f469","&#x200d","&#x1f467","&#x200d","&#x1f467"],":family-woman-woman-boy:":["&#x1f469","&#x200d","&#x1f469","&#x200d","&#x1f466"],":family-woman-woman-girl:":["&#x1f469","&#x200d","&#x1f469","&#x200d","&#x1f467"],":see-no-evil:":["&#x1f648"],":hear-no-evil:":["&#x1f649"],":speak-no-evil:":["&#x1f64a"],":fire:":["&#x1f525"],":sparkles:":["&#x2728"],":star2:":["&#x1f31f"],":droplet:":["&#x1f4a7"],":tophat:":["&#x1f3a9"],":crown:":["&#x1f451"],":womans-hat:":["&#x1f452"],":athletic-shoe:":["&#x1f45f"],":mans-shoe:":["&#x1f45e"],":sandal:":["&#x1f461"],":high-heel:":["&#x1f460"],":boot:":["&#x1f462"],":shirt:":["&#x1f455"],":necktie:":["&#x1f454"],":womans-clothes:":["&#x1f45a"],":dress:":["&#x1f457"],":running-shirt-with-sash:":["&#x1f3bd"],":jeans:":["&#x1f456"],":kimono:":["&#x1f458"],":bikini:":["&#x1f459"],":briefcase:":["&#x1f4bc"],":handbag:":["&#x1f45c"],":pouch:":["&#x1f45d"],":purse:":["&#x1f45b"],":eyeglasses:":["&#x1f453"],":ribbon:":["&#x1f380"],":closed-umbrella:":["&#x1f302"],":gem:":["&#x1f48e"],":speech-balloon:":["&#x1f4ac"],":open-hands:":["&#x1f450"],":raised-hands:":["&#x1f64c"],":clap:":["&#x1f44f"],":thumbsup:":["&#x1f44d"],":thumbsdown:":["&#x1f44e"],":oncoming-fist:":["&#x1f44A"],":fist:":["&#x270A"],":sign-of-horns:":["&#x1f918"],":ok-hand:":["&#x1f44c"],":point-left:":["&#x1f448"],":point-right:":["&#x1f449"],":point-up-2:":["&#x1f446"],":point-down:":["&#x1f447"],":raised-hand:":["&#x270B"],":spayed-fingers:":["&#x1f590"],":vulcan-salute:":["&#x1f596"],":wave:":["&#x1f44b"],":muscle:":["&#x1f4aa"],":middle-finger:":["&#x1f595"],":pray:":["&#x1f64f"],":ring:":["&#x1f48d"],":lipstick:":["&#x1f484"],":kiss:":["&#x1f48b"],":lips:":["&#x1f444"],":tongue:":["&#x1f445"],":ear:":["&#x1f442"],":nose:":["&#x1f443"],":footprints:":["&#x1f463"],":eye:":["&#x1f441"],":eyes:":["&#x1f440"],":speaking-head:":["&#x1f5e3"],":bust-in-silhouette:":["&#x1f464"],":busts-in-silhouette:":["&#x1f465"],":dog:":["&#x1f436"],":wolf:":["&#x1f43a"],":cat:":["&#x1f431"],":mouse:":["&#x1f42d"],":hamster:":["&#x1f439"],":rabbit:":["&#x1f430"],":frog:":["&#x1f438"],":tiger:":["&#x1f42f"],":koala:":["&#x1f428"],":bear:":["&#x1f43b"],":pig:":["&#x1f437"],":pig-nose:":["&#x1f43d"],":cow:":["&#x1f42e"],":boar:":["&#x1f417"],":monkey-face:":["&#x1f435"],":monkey:":["&#x1f412"],":horse:":["&#x1f434"],":sheep:":["&#x1f411"],":elephant:":["&#x1f418"],":panda-face:":["&#x1f43c"],":penguin:":["&#x1f427"],":bird:":["&#x1f426"],":baby-chick:":["&#x1f424"],":hatched-chick:":["&#x1f425"],":hatching-chick:":["&#x1f423"],":chicken:":["&#x1f414"],":snake:":["&#x1f40d"],":turtle:":["&#x1f422"],":bug:":["&#x1f41b"],":bee:":["&#x1f41d"],":ant:":["&#x1f41c"],":beetle:":["&#x1f41e"],":snail:":["&#x1f40c"],":octopus:":["&#x1f419"],":shell:":["&#x1f41a"],":tropical-fish:":["&#x1f420"],":fish:":["&#x1f41f"],":dolphin:":["&#x1f42c"],":whale:":["&#x1f433"],":racehorse:":["&#x1f40e"],":dragon-face:":["&#x1f432"],":blowfish:":["&#x1f421"],":camel:":["&#x1f42b"],":poodle:":["&#x1f429"],":feet:":["&#x1f43e"],":bouquet:":["&#x1f490"],":cherry-blossom:":["&#x1f338"],":tulip:":["&#x1f337"],":four-leaf-clover:":["&#x1f340"],":rose:":["&#x1f339"],":sunflower:":["&#x1f33b"],":hibiscus:":["&#x1f33a"],":maple-leaf:":["&#x1f341"],":leaves:":["&#x1f343"],":fallen-leaf:":["&#x1f342"],":herb:":["&#x1f33f"],":ear-of-rice:":["&#x1f33e"],":mushroom:":["&#x1f344"],":cactus:":["&#x1f335"],":palm-tree:":["&#x1f334"],":chestnut:":["&#x1f330"],":seedling:":["&#x1f331"],":blossom:":["&#x1f33c"],":new-moon:":["&#x1f311"],":first-quarter-moon:":["&#x1f313"],":moon:":["&#x1f314"],":full-moon:":["&#x1f315"],":first-quarter-moon-with-face:":["&#x1f31b"],":crescent-moon:":["&#x1f319"],":earth-asia:":["&#x1f30f"],":volcano:":["&#x1f30b"],":milky-way:":["&#x1f30c"],":stars:":["&#x1f320"],":partly-sunny:":["&#x26C5"],":snowman:":["&#x26C4"],":cyclone:":["&#x1f300"],":foggy:":["&#x1f301"],":rainbow:":["&#x1f308"],":ocean:":["&#x1f30a"],":house:":["&#x1f3e0"],":house-with-garden:":["&#x1f3e1"],":school:":["&#x1f3eb"],":office:":["&#x1f3e2"],":post-office:":["&#x1f3e3"],":hospital:":["&#x1f3e5"],":bank:":["&#x1f3e6"],":convenience-store:":["&#x1f3ea"],":love-hotel:":["&#x1f3e9"],":hotel:":["&#x1f3e8"],":wedding:":["&#x1f492"],":church:":["&#x26EA"],":department-store:":["&#x1f3ec"],":city-sunrise:":["&#x1f307"],":city-sunset:":["&#x1f306"],":japanese-castle:":["&#x1f3ef"],":european-castle:":["&#x1f3f0"],":tent:":["&#x26FA"],":factory:":["&#x1f3ed"],":tokyo-tower:":["&#x1f5fc"],":japan:":["&#x1f5fe"],":mount-fuji:":["&#x1f5fb"],":sunrise-over-mountains:":["&#x1f304"],":sunrise:":["&#x1f305"],":night-with-stars:":["&#x1f303"],":statue-of-liberty:":["&#x1f5fd"],":bridge-at-night:":["&#x1f309"],":carousel-horse:":["&#x1f3a0"],":ferris-wheel:":["&#x1f3a1"],":fountain:":["&#x26F2"],":roller-coaster:":["&#x1f3a2"],":ship:":["&#x1f6a2"],":boat:":["&#x26F5"],":speedboat:":["&#x1f6a4"],":rocket:":["&#x1f680"],":seat:":["&#x1f4ba"],":station:":["&#x1f689"],":high-speed-train:":["&#x1f684"],":bullet-train:":["&#x1f685"],":metro:":["&#x1f687"],":railway-car:":["&#x1f683"],":bus:":["&#x1f68c"],":blue-car:":["&#x1f699"],":car:":["&#x1f697"],":taxi:":["&#x1f695"],":truck:":["&#x1f69a"],":rotating-light:":["&#x1f6a8"],":police-car:":["&#x1f693"],":fire-engine:":["&#x1f692"],":ambulance:":["&#x1f691"],":bike:":["&#x1f6b2"],":barber-pole:":["&#x1f488"],":busstop:":["&#x1f68f"],":ticket:":["&#x1f3ab"],":traffic-light:":["&#x1f6a5"],":construction:":["&#x1f6a7"],":beginner:":["&#x1f530"],":fuelpump:":["&#x26FD"],":izakaya-lantern:":["&#x1f3ee"],":slot-machine:":["&#x1f3b0"],":moyai:":["&#x1f5ff"],":circus-tent:":["&#x1f3aa"],":performing-arts:":["&#x1f3ad"],":round-pushpin:":["&#x1f4cd"],":triangular-flag-on-post:":["&#x1f6a9"],":red-heart:":["&#x2764","&#xfe0f"],":yellow-heart:":["&#x1f49b"],":blue-heart:":["&#x1f499"],":purple-heart:":["&#x1f49c"],":green-heart:":["&#x1f49a"],":broken-heart:":["&#x1f494"],":heart-exclamation:":["&#x2763","&#xfe0f"],":two-hearts:":["&#x1f495"],":revolving-hearts:":["&#x1f49e"],":heartbeat:":["&#x1f493"],":heartpulse:":["&#x1f497"],":sparkling-heart:":["&#x1f496"],":cupid:":["&#x1f498"],":gift-heart:":["&#x1f49d"],":heart-decoration:":["&#x1f49f"],":love-letter:":["&#x1f48c"],":dizzy:":["&#x1f4ab"],":boom:":["&#x1f4a5"],":anger:":["&#x1f4a2"],":sweat-drops:":["&#x1f4a6"],":zzz:":["&#x1f4a4"],":dash:":["&#x1f4a8"],":hole:":["&#x1f573","&#xfe0f"],":peace-symbol:":["&#x262e","&#xfe0f"],":latin-cross:":["&#x271d","&#xfe0f"],":crescent-and-star:":["&#x262a","&#xfe0f"],":om:":["&#x1f549","&#xfe0f"],":wheel-of-dharma:":["&#x2638","&#xfe0f"],":star-of-david:":["&#x2721","&#xfe0f"],":star-with-middle-point:":["&#x1f52f"],":menorah:":["&#x1f54e"],":yin-yang:":["&#x262f","&#xfe0f"],":orthodox-cross:":["&#x2626","&#xfe0f"],":place-of-workship:":["&#x1f6d0"],":ophiuchus:":["&#x26ce"],":aries:":["&#x2648"],":taurus:":["&#x2649"],":gemini:":["&#x264a"],":cancer:":["&#x264b"],":leo:":["&#x264c"],":virgo:":["&#x264d"],":libra:":["&#x264e"],":scorpius:":["&#x264f"],":sagittarius:":["&#x2650"],":capricorn:":["&#x2651"],":aquarius:":["&#x2652"],":pisces:":["&#x2653"],":squared-id:":["&#x1f194"],":atom:":["&#x269b","&#xfe0f"],":japanese-vacancy-button:":["&#x1f233"],":japanese-discount-button:":["&#x1f239"],":radioactive:":["&#x2622","&#xfe0f"],":biohazard:":["&#x2623","&#xfe0f"],":japanese-not-free-of-charge-button:":["&#x1f236"],":japanese-free-of-charge-button:":["&#x1f21a"],":japanese-application-button:":["&#x1f238"],":japanese-open-for-business-button:":["&#x1f23a"],":japanese-monthly-amount:":["&#x1f237","&#xfe0f"],":eight-pointed-star:":["&#x2734","&#xfe0f"],":vs-button:":["&#x1f19a"],":japanese-acceptable-button:":["&#x1f251"],":white-flower:":["&#x1f4ae"],":japanese-bargain-button:":["&#x1f250"],":japanese-secret-button:":["&#x3299","&#xfe0f"],":japanese-congratulations-button:":["&#x3297","&#xfe0f"],":japanese-passing-grade-button:":["&#x1f234"],":japanese-no-vacancy-button:":["&#x1f235"],":japanese-prohibited-button:":["&#x1f232"],":baby-symbol:":["&#x1f6bc"],":a-group-blood":["&#x1f170","&#xfe0f"],":b-group-blood:":["&#x1f171","&#xfe0f"],":o-group-blood:":["&#x1f17e","&#xfe0f"],":cl-button:":["&#x1f191"],":sos-button:":["&#x1f198"],":no-entry:":["&#x26d4"],":name-badge:":["&#x1f4db"],":heavy-circle:":["&#x2b55"],":prohibited:":["&#x1f6ab"],":muted:":["&#x1f507"],":bell-with-slash:":["&#x1f515"],":no-smoking:":["&#x1f6ad"],":no-pedestrains:":["&#x1f6b7"],":no-littering:":["&#x1f6af"],":no-bicycle:":["&#x1f6b3"],":non-potable-water:":["&#x1f6b1"],":no-one-under-18:":["&#x1f51e"],":no-mobile-phones:":["&#x1f4f5"],":exclamation-mark:":["&#x2757"],":white-exclamation-mark:":["&#x2755"],":question-mark:":["&#x2753"],":white-question-mark:":["&#x2754"],":hundred-points:":["&#x1f4af"],":dim-button:":["&#x1f505"],":bright-button:":["&#x1f506"],":trident:":["&#x1f531"],":fleur-de-lis:":["&#x269c","&#xfe0f"],":part-alternation-mark:":["&#x303d","&#xfe0f"],":warning:":["&#x26a0","&#xfe0f"],":children-crossing:":["&#x1f6b8"],":japanese-beginner-button:":["&#x1f530"],":recycling:":["&#x267b","&#xfe0f"],":japanese-reserved-button:":["&#x1f22f"],":chart-increasing-with-yen:":["&#x1f4b9"],":sparkle:":["&#x2747","&#xfe0f"],":eight-spoked-asterisk:":["&#x2733","&#xfe0f"],":white-heavy-check-mark:":["&#x2705"],":cross-mark:":["&#x274c"],":diamond-with-dot:":["&#x1f4a0"],":globe-with-meridians:":["&#x1f310"],":circled-m:":["&#x24c2","&#xfe0f"],":japanese-service-charge-button:":["&#x1f202","&#xfe0f"],":double-curly-loop:":["&#x27bf"],":passport-control:":["&#x1f6c2"],":customs:":["&#x1f6c3"],":baggage-claim:":["&#x1f6c4"],":left-luggage:":["&#x1f6c5"],":wheel-chair:":["&#x267f"],":water-closet:":["&#x1f6be"],":p-button:":["&#x1f17f","&#xfe0f"],":potable-water:":["&#x1f6b0"],":men-room:":["&#x1f6b9"],":women-room:":["&#x1f6ba"],":restroom:":["&#x1f6bb"],":litter-in-bin:":["&#x1f6ae"],":antenna-bars:":["&#x1f4f6"],":japanese-here-button:":["&#x1f201"],":ng-button:":["&#x1f196"],":ok-button:":["&#x1f197"],":up-button:":["&#x1f199"],":cool-button:":["&#x1f192"],":new-button:":["&#x1f195"],":free-button:":["&#x1f193"],":input-number:":["&#x1f522"],":pause-button:":["&#x23f8","&#xfe0f"],":pause-or-play-button:":["&#x23ef","&#xfe0f"],":stop-button:":["&#x23f9","&#xfe0f"],":record-button:":["&#x23fa"],":next-track-button:":["&#x23ed","&#xfe0f"],":last-track-button:":["&#x23ee","&#xfe0f"],":fast-forward:":["&#x23e9"],":fast-reverse:":["&#x23ea"],":shuffle-tracks-button:":["&#x1f500"],":repeat-button:":["&#x1f501"],":repeat-once-button:":["&#x1f502"],":reverse-button:":["&#x25c0","&#xfe0f"],":fast-up-button:":["&#x23eb"],":fast-down-button:":["&#x23ec"],":right-arrow:":["&#x27a1","&#xfe0f"],":left-arrow:":["&#x2b05","&#xfe0f"],":up-arrow:":["&#x2b06","&#xfe0f"],":down-arrow:":["&#x2b07","&#xfe0f"],":up-right-arrow:":["&#x2197","&#xfe0f"],":down-left-arrow:":["&#x2199","&#xfe0f"],":counter-clockwise-arrows:":["&#x1f504"],":left-arrow-curving-right:":["&#x21aa","&#xfe0f"],":right-arrow-curving-left:":["&#x21a9","&#xfe0f"],":right-arrow-curving-up:":["&#x2934","&#xfe0f"],":right-arrow-curving-down:":["&#x2935","&#xfe0f"],":info-button:":["&#x2139","&#xfe0f"],":input-latin-letters:":["&#x1f524"],":input-latin-lowercase:":["&#x1f521"],":input-latin-uppercase:":["&#x1f520"],":input-symbols:":["&#x1f523"],":play-button:":["&#x25b6","&#xfe0f"],":eject-button:":["&#x23cf","&#xfe0f"],":down-right-arrow:":["&#x2198","&#xfe0f"],":up-left-arrow:":["&#x2196","&#xfe0f"],":clockwise-vertical-arrows:":["&#x1f503"],":on-arrow:":["&#x1f51b"],":top-arrow:":["&#x1f51d"],":soon-arrow:":["&#x1f51c"],":ballot-box-with-check:":["&#x2611","&#xfe0f"],":end-arrow:":["&#x1f51a"],":back-arrow:":["&#x1f519"],":wavy-dash:":["&#x3030","&#xfe0f"],":curly-loop:":["&#x27b0"],":heavy-check-mark:":["&#x2714","&#xfe0f"],":heavy-dollar-sign:":["&#x1f4b2"],":currency-exchange:":["&#x1f4b1"],":heavy-plus-sign:":["&#x2795"],":heavy-minus-sign:":["&#x2796"],":heavy-multiplication-sign:":["&#x2716","&#xfe0f"],":heavy-division-sign:":["&#x2797"],":copyright:":["&#xa9","&#xfe0f"],":registered:":["&#xae","&#xfe0f"],":trade-mark:":["&#x2122","&#xfe0f"],":radio-button:":["&#x1f518"],":white-circle:":["&#x26aa"],":black-circle:":["&#x26ab"],":red-circle:":["&#x1f534"],":blue-circle:":["&#x1f535"],":small-orange-diamond:":["&#x1f538"],":small-blue-diamond:":["&#x1f539"],":large-orange-diamond:":["&#x1f536"],":large-blue-diamond:":["&#x1f537"],":red-triangle-pointed-up:":["&#x1f53a"],":red-triangle-pointed-down:":["&#x1f53b"],":upwards-button:":["&#x1f53c"],":downwards-button:":["&#x1f53d"],":black-medium-small-square:":["&#x25fe"],":white-medium-small-square:":["&#x25fd"],":black-large-square:":["&#x2b1b"],":white-large-square:":["&#x2b1c"],":black-medium-square:":["&#x25fc","&#xfe0f"],":white-medium-square:":["&#x25fb","&#xfe0f"],":black-small-square:":["&#x25aa","&#xfe0f"],":white-small-square:":["&#x25ab","&#xfe0f"],":black-square-button:":["&#x1f533"],":white-square-button:":["&#x1f532"],":twelve-o-clock:":["&#x1f55b"],":twelve-thirty:":["&#x1f567"],":one-o-clock:":["&#x1f550"],":one-thirty:":["&#x1f55c"],":two-o-clock:":["&#x1f551"],":two-thirty:":["&#x1f55d"],":three-o-clock:":["&#x1f552"],":three-thirty:":["&#x1f55e"],":four-o-clock:":["&#x1f553"],":four-thirty:":["&#x1f55f"],":five-o-clock:":["&#x1f554"],":five-thirty:":["&#x1f560"],":six-o-clock:":["&#x1f555"],":six-thirty:":["&#x1f561"],":seven-o-clock:":["&#x1f556"],":seven-thirty:":["&#x1f562"],":eight-o-clock:":["&#x1f557"],":eight-thirty:":["&#x1f563"],":nine-o-clock:":["&#x1f558"],":nine-thirty:":["&#x1f564"],":ten-o-clock:":["&#x1f559"],":ten-thirty:":["&#x1f565"],":eleven-o-clock:":["&#x1f55a"],":eleven-thirty:":["&#x1f566"],":keep-quiet:":["&#x1F92B"],":victory:":["&#x0270C"],":coffee-cup:":["&#x02615"]},xt=(at={":)":":smile:",":-)":":smile:",":^)":":smile:",":]":":smile:",":(":":sad:",":-(":":sad:",":[":":sad:",":D":":happy:",":d":":happy:",":-D":":happy:",":))":":happy:",":-))":":happy:","X-(":":angry:",":-@":":angry:",":@":":angry:",":P":":razz:",":-p":":razz:",":p":":razz:",";)":":wink:",";-)":":wink:",":/":":smirk:",":-/":":smirk:",":o":":surprise:",":-o":":surprise:",":O":":surprise:",":-O":":surprise:",":-s":":worry:",":s":":worry:",":-S":":worry:",":S":":worry:","I-)":":sleepy:","|-)":":sleepy:",":-X":":keep-quiet:",":-x":":keep-quiet:",":-#":":keep-quiet:","(a)":":peace:","(A)":":peace:","O-)":":peace:","O:)":":peace:","O:-)":":peace:",":+1:":":thumbsup:","(y)":":thumbsup:","(Y)":":thumbsup:",":x-":":thumbsup:",":yes:":":thumbsup:",":agree:":":thumbsup:",":like:":":thumbsup:",":-1:":":thumbsdown:","(N)":":thumbsdown:","(n)":":thumbsdown:",":no:":":thumbsdown:",":disagree:":":thumbsdown:",":dislike:":":thumbsdown:","B-)":":cool:",":xs":":love:",":-?":":thinking:","*-:)":":idea:","-_-":":relaxed:","D:":":anxious:","-.-":":stressed-out:","(=_=)":":tired:","?D":":doubt:"},n(at,"?D",":thinking:"),n(at,"(6.6)",":faint:"),n(at,"(({..}))",":headache:"),n(at,"+o(",":sick:"),n(at,":-{}",":feeling-cold:"),n(at,":v:",":victory:"),n(at,"C(_)",":coffee-cup:"),at),wt={":smile:":"zomoji-w-24-smile",":happy:":"zomoji-w-24-happy",":joy:":"zomoji-w-24-joy",":grinning:":"zomoji-w-24-grinning",":cool:":"zomoji-w-24-cool",":love:":"zomoji-w-24-love",":curious:":"zomoji-w-24-curious",":awe:":"zomoji-w-24-awe",":thinking:":"zomoji-w-24-thinking",":search:":"zomoji-w-24-search",":idea:":"zomoji-w-24-idea",":wink:":"zomoji-w-24-wink",":razz:":"zomoji-w-24-razz",":relaxed:":"zomoji-w-24-relaxed",":peace:":"zomoji-w-24-peace",":yummy:":"zomoji-w-24-yummy",":yuck:":"zomoji-w-24-yuck",":sad:":"zomoji-w-24-sad",":blush:":"zomoji-w-24-blush",":upset:":"zomoji-w-24-upset",":anxious:":"zomoji-w-24-anxious",":worry:":"zomoji-w-24-worry",":stressed-out:":"zomoji-w-24-stressed-out",":angry:":"zomoji-w-24-angry",":tensed:":"zomoji-w-24-tensed",":tired:":"zomoji-w-24-tired",":bored:":"zomoji-w-24-bored",":sleepy:":"zomoji-w-24-sleepy",":jealous:":"zomoji-w-24-jealous",":evil:":"zomoji-w-24-evil",":facepalm:":"zomoji-w-24-facepalm",":doubt:":"zomoji-w-24-doubt",":surprise:":"zomoji-w-24-surprise",":faint:":"zomoji-w-24-faint",":headache:":"zomoji-w-24-headache",":sick:":"zomoji-w-24-sick",":injured:":"zomoji-w-24-injured",":neutral:":"zomoji-w-24-neutral",":smirk:":"zomoji-w-24-smirk",":keep-quiet:":"zomoji-w-24-keep-quiet",":feeling-warm:":"zomoji-w-24-feeling-warm",":feeling-cold:":"zomoji-w-24-feeling-cold",":thumbsup:":"zomoji-w-24-thumbsup",":thumbsdown:":"zomoji-w-24-thumbsdown",":namaste:":"zomoji-w-24-namaste",":super:":"zomoji-w-24-super",":victory:":"zomoji-w-24-victory",":yoyo:":"zomoji-w-24-yoyo",":raising-hand:":"zomoji-w-24-raising-hand",":clap:":"zomoji-w-24-clap",":bye-bye:":"zomoji-w-24-bye-bye",":fist:":"zomoji-w-24-fist",":biceps:":"zomoji-w-24-biceps",":flag:":"zomoji-w-24-flag",":target:":"zomoji-w-24-target",":foosball:":"zomoji-w-24-foosball",":pingpong:":"zomoji-w-24-pingpong",":coffee-cup:":"zomoji-w-24-coffee-cup",":food:":"zomoji-w-24-food",":chicken:":"zomoji-w-24-chicken",":gift-box:":"zomoji-w-24-gift-box",":champagne:":"zomoji-w-24-champagne",":party:":"zomoji-w-24-party",":poop:":"zomoji-w-24-poop",":peanuts:":"zomoji-w-24-peanuts",":birthday:":"zomoji-w-24-birthday",":fireworks:":"zomoji-w-24-fireworks",":christmas-tree:":"zomoji-w-24-christmas-tree",":santa-hat:":"zomoji-w-24-santa-hat",":eid-mubarak:":"zomoji-w-24-eid-mubarak",":kaaba:":"zomoji-w-24-kaaba",":new-year:":"zomoji-w-24-new-year",":singing:":"zomoji-w-24-singing",":break-boy:":"zomoji-w-24-break-boy",":break-girl:":"zomoji-w-24-break-girl",":woman-dancing:":"zomoji-w-24-woman-dancing",":man-dancing:":"zomoji-w-24-man-dancing",":yoga:":"zomoji-w-24-yoga",":karate:":"zomoji-w-24-karate",":medicine:":"zomoji-w-24-medicine",":first-aid-box:":"zomoji-w-24-first-aid-box",":fire-extinguisher:":"zomoji-w-24-fire-extinguisher",":fire:":"zomoji-w-24-fire",":man-cycling:":"zomoji-w-24-man-cycling",":woman-cycling:":"zomoji-w-24-woman-cycling",":woman-running:":"zomoji-w-24-woman-running",":man-running:":"zomoji-w-24-man-running",":man-swimming:":"zomoji-w-24-man-swimming",":woman-swimming:":"zomoji-w-24-woman-swimming",":football:":"zomoji-w-24-football",":basketball:":"zomoji-w-24-basketball",":volleyball:":"zomoji-w-24-volleyball",":tennis:":"zomoji-w-24-tennis",":badminton:":"zomoji-w-24-badminton",":table-tennis:":"zomoji-w-24-table-tennis",":cricket:":"zomoji-w-24-cricket",":baseball:":"zomoji-w-24-baseball",":hockey:":"zomoji-w-24-hockey",":golf:":"zomoji-w-24-golf",":snooker:":"zomoji-w-24-snooker",":chess:":"zomoji-w-24-chess",":football-player:":"zomoji-w-24-football-player",":basketball-player:":"zomoji-w-24-basketball-player",":male-volleyball-player:":"zomoji-w-24-male-volleyball-player",":female-volleyball-player:":"zomoji-w-24-female-volleyball-player",":female-tennis-player:":"zomoji-w-24-female-tennis-player",":male-tennis-player:":"zomoji-w-24-male-tennis-player",":badminton-player:":"zomoji-w-24-badminton-player",":male-tabletennis-player:":"zomoji-w-24-male-tabletennis-player",":female-tabletennis-player:":"zomoji-w-24-female-tabletennis-player",":batsman:":"zomoji-w-24-batsman",":bowler:":"zomoji-w-24-bowler",":batter:":"zomoji-w-24-batter",":pitcher:":"zomoji-w-24-pitcher",":hockey-player:":"zomoji-w-24-hockey-player",":golfer:":"zomoji-w-24-golfer",":gymnast:":"zomoji-w-24-gymnast",":snooker-player:":"zomoji-w-24-snooker-player",":chess-player:":"zomoji-w-24-chess-player",":gold-medal:":"zomoji-w-24-gold-medal",":silver-medal:":"zomoji-w-24-silver-medal",":bronze-medal:":"zomoji-w-24-bronze-medal",":refugee-olympic-team:":"zomoji-w-24-refugee-olympic-team",":athlete:":"zomoji-w-24-athlete",":hurdler:":"zomoji-w-24-hurdler",":high-jump:":"zomoji-w-24-high-jump",":long-jump:":"zomoji-w-24-long-jump",":pole-vault:":"zomoji-w-24-pole-vault",":discus-throw:":"zomoji-w-24-discus-throw",":hammer-throw:":"zomoji-w-24-hammer-throw",":javelin-throw:":"zomoji-w-24-javelin-throw",":shotput-throw:":"zomoji-w-24-shotput-throw",":boxer:":"zomoji-w-24-boxer",":fencer:":"zomoji-w-24-fencer",":judo:":"zomoji-w-24-judo",":weightlifting:":"zomoji-w-24-weightlifting",":wrestling:":"zomoji-w-24-wrestling",":archer:":"zomoji-w-24-archer",":shooter:":"zomoji-w-24-shooter",":equestrian:":"zomoji-w-24-equestrian",":canoeing:":"zomoji-w-24-canoeing",":diver:":"zomoji-w-24-diver",":rhythmic-gymnastics:":"zomoji-w-24-rhythmic-gymnastics",":bicycle:":"zomoji-w-24-bicycle",":sports-bike:":"zomoji-w-24-sports-bike",":cruiser-bike:":"zomoji-w-24-cruiser-bike",":motor-scooter:":"zomoji-w-24-motor-scooter",":car:":"zomoji-w-24-car",":taxi:":"zomoji-w-24-taxi",":bus:":"zomoji-w-24-bus",":train:":"zomoji-w-24-train",":police-car:":"zomoji-w-24-police-car",":ambulance:":"zomoji-w-24-ambulance",":fire-engine:":"zomoji-w-24-fire-engine",":aeroplane:":"zomoji-w-24-aeroplane",":passenger-ship:":"zomoji-w-24-passenger-ship",":parking:":"zomoji-w-24-parking",":cafeteria:":"zomoji-w-24-cafeteria",":bug:":"zomoji-w-24-bug",":milestone:":"zomoji-w-24-milestone",":security:":"zomoji-w-24-security",":calendar:":"zomoji-w-24-calendar",":processor:":"zomoji-w-24-processor",":laptop:":"zomoji-w-24-laptop",":server:":"zomoji-w-24-server",":garden:":"zomoji-w-24-garden",":playground:":"zomoji-w-24-playground",":home:":"zomoji-w-24-home",":office:":"zomoji-w-24-office",":library:":"zomoji-w-24-library",":auditorium:":"zomoji-w-24-auditorium",":store:":"zomoji-w-24-store",":mail-room:":"zomoji-w-24-mail-room",":pharmacy:":"zomoji-w-24-pharmacy",":task:":"zomoji-w-24-task",":report:":"zomoji-w-24-report",":gym:":"zomoji-w-24-gym",":americas:":"zomoji-w-24-americas",":europe-africa:":"zomoji-w-24-europe-africa",":asia-pacific:":"zomoji-w-24-asia-pacific",":hi:":"zomoji-w-24-hi"},bt=function(e){var t=[],n=[];if(e){for(var r in yt)if(r.includes(e)){var o={name:ee(r),code:yt[r].join("")};t.push(o),n.push(r)}for(var i in xt)if(i.includes(e)){var s=xt[i];if(n.indexOf(s)<0&&yt[s]){var o={name:ee(s),code:yt[s].join("")};t.push(o),n.push(s)}}}else for(var a in yt){var o={name:ee(a),code:yt[a].join("")};t.push(o)}return t},kt=function(e){var t=[],n=[];if(e){for(var r in wt)if(r.includes(e)){var o={name:ee(r),className:wt[r]};t.push(o),n.push(r)}for(var i in xt)if(i.includes(e)){var s=xt[i];if(n.indexOf(s)<0&&wt[s]){var o={name:ee(s),className:wt[s]};t.push(o),n.push(s)}}}else for(var a in wt){var o={name:a.slice(1,a.length-1),className:wt[a]};t.push(o)}return t},St={EditorState:je,Plugin:ze,PluginKey:De,TextSelection:Ne},Mt={EditorView:Ae,Decoration:Re,DecorationSet:Ie},Ot=(ct={Node:oe,Schema:ce,DOMSerializer:le},n(ct,"DOMSerializer",le),n(ct,"Fragment",ie),n(ct,"Slice",se),ct),Ct={baseKeymap:Fe,toggleMark:Le,splitBlockKeepMarks:Be,chainCommands:$e},Tt={history:Ue,undo:Ge,redo:Ze},Et={keymap:$},Nt={getMentionsPlugin:K,addMentionNodes:H,addTagNodes:W},jt={getWordBeforeCurPos:_},zt={debounce:lt},Dt={addEmojiNode:U,getEmojiCode:Z,getEmojiList:X,getEmojiPlugin:te,getMatchedEmojiList:G,getShortCutList:Y,getZomojiList:Q,getTrimmedEmojiName:ee};return e.State=St,e.View=Mt,e.Model=Ot,e.Commands=Ct,e.History=Tt,e.Keymap=Et,e.Mentions=Nt,e.PluginUtils=jt,e.Utils=zt,e.Emoji=Dt,e}({}),RTEConstants=function(){return{BOLD:"strong",ITALIC:"em",LINK:"link",HIGHLIGHT:"highlight",UNDERLINE:"underline",ATMENTION:"mentions",EMOJI:"emoji",PROOFING:"proofing",MERGEFIELD:"mergefield",STRIKETHROUGH:"strikeThrough"}}(),Schema=function(){var e={doc:{content:"block+"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:function(){return["p",{style:"margin: 0px; line-height: 22px;"},0]}},text:{group:"inline"},br:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}},mergefield:{group:"inline",inline:!0,atom:!0,selectable:!1,draggable:!1,attrs:{fieldId:"",fieldName:"",type:{default:void 0},contentType:{default:void 0},props:{default:void 0},meta:{default:void 0}},toDOM:function(e){var t,n=e.attrs.fieldId,r=e.attrs.fieldName,o=e.attrs.type,i=e.attrs.contentType,s=e.attrs.props,a=e.attrs.meta,c="span",f={"mm-field-id":n,"mm-field-name":r,type:o,"content-type":i};if(a&&(f["data-field-info"]=JSON.stringify(a)),"qrcode"===i){var l={};l.src=s.src,f.title=s.title,l.width=s.width,l.height=s.height,f.class="fgImgOuterDiv js-image-field ui-display-inblock",toDom=["span",f,["img",l],["span",{class:"ui-brokenImg-cont ui-flex-container ui-flex-center"},["span",{class:"ui-brokenImg-innercont"},["span",{class:"ui-emergefield-placeholder"},r]]]]}else{var p=s&&s.class;p&&(f.class=p),t="autofield"===o?r:""+r+"",toDom=[c,f,t]}return toDom},parseDOM:[{tag:"span.js-image-field",ignore:!0},{tag:"span[mm-field-id][mm-field-name]",getAttrs:function(e){var t,n=e.getAttribute("mm-field-id"),r=e.getAttribute("mm-field-name"),o=e.getAttribute("type"),i=e.getAttribute("content-type"),s=e.getAttribute("class");s&&(t={class:s});var a=e.getAttribute("data-field-info"),c={fieldId:n,fieldName:r};return a&&(c.meta=a),t&&(c.props=a),o&&(c.type=o),i&&(c.contentType=i),c}}]}},t={link:{attrs:{href:""},inclusive:!0,parseDOM:[{tag:"a[href]",getAttrs:function(e){var t=e.getAttribute("data-mention-email");return!t&&{href:e.getAttribute("href")}}}],toDOM:function(e){var t=e.attrs.href;return["a",{href:t,target:"_blank",rel:"noreferrer",class:"rte-link"}]}},em:{content:"text",parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em"]}},underline:{parseDOM:[{tag:"u"},{style:"text-decoration = underline"}],toDOM:function(){return["u"]}},strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!=e.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return["strong"]}},highlight:{parseDOM:[{tag:"span[style]",getAttrs:function(e){var t=["rgb(255, 255, 0)"];return t.indexOf(e.style.backgroundColor)>-1}}],toDOM:function(){return["span",{style:"background-color: rgb(255, 255, 0)"}]}},strikeThrough:{parseDOM:[{tag:"s"},{style:"text-decoration = line-through"}],toDOM:function(){return["s"]}}};return{nodes:e,marks:t}}(),RTELink=function(){var e=function(e){var t=e.state.selection.ranges[0],n=t.$from.pos,r=t.$to.pos;if(n===r){var o=e.state.doc.nodeAt(n);o&&e.state.schema.marks.link.isInSet(o.marks)&&(linkRange=c(e,n),n=linkRange.start,r=linkRange.end)}return{start:n,end:r}},t=function(t,n){var r=/^((ht|f)tp(s?)\:\/\/){0,1}[-.\w]*(\/?)([a-zA-Z0-9\|\(\)~\-\.\!\?\,\:\'\/\\\+=&amp;%\$#_@\P{InBasicLatin}]*)?$/,o=r.test(t);if(o){var i=n.state.schema.marks.link,s=e(n);n.state.tr.removeMark(s.start,s.end,i);var a=n.state.schema;if(s.start===s.end){var c=n.state.doc.nodeAt(s.start),f=c&&c.storedMarks||[],l=a.mark("link",{href:t});f.push(l);var p=a.text(t,l),u=n.state.tr.replaceWith(s.start,s.end,p);n.dispatch(u)}else n.dispatch(n.state.tr.addMark(s.start,s.end,n.state.schema.marks.link.create({href:t})))}},n=function(e){var t=e.state.selection.ranges[0],n=t.$from.pos,r=t.$to.pos;if(n===r){var o=e.state.doc.nodeAt(n);e.state.schema.marks.link.isInSet(o.marks)&&(t=c(e,n),n=t.start,r=t.end)}e.dispatch(e.state.tr.removeMark(n,r,e.state.schema.marks.link))},r=function(e){var t=e.state.doc.nodeAt(e.state.selection.$from.pos);return t&&e.state.schema.marks.link.isInSet(t.marks)?t.marks.get("link",function(e,t){return e.type.name===t}).attrs.href:""},o=function(e){return e.marks.filter(function(e){return"link"===e.type.name})[0]},i=function(e){var t=[];e.state.doc.content.nodesBetween(0,e.state.doc.content.size,function(e,n){e.isLeaf&&t.push({node:e,pos:n})});var n=[],r=null;return t.forEach(function(t){var i=t.node,s=t.pos;if(e.state.schema.marks.link.isInSet(i.marks)){var a=o(i);r?r.href===a.attrs.href&&r.end===s?r.end=r.end+i.nodeSize:(n.push(r),r={href:a.attrs.href,start:s,end:s+i.nodeSize}):r={href:a.attrs.href,start:s,end:s+i.nodeSize}}else r&&(n.push(r),r=null)}),r&&n.push(r),n},s=function(e,t){var n=e.reduce(function(e,n){var r=e.pop();return r?n.start-r.end!==2||t.state.doc.resolve(r.end).nodeAfter||r.href!==n.href?(e.push(r),e.push(n)):(r.end=n.end,e.push(r)):e.push(n),e},[]);return n},a=function(e){var t=i(e);return s(t,e)},c=function(e,t){var n=a(e),r=n.filter(function(e){return t>=e.start&&t<=e.end})[0];return r};return{addLink:t,removeLink:n,getLink:r,getSurroundingLinkRange:c,getLinkRange:e}}(),Shortcuts=function(e){var t=function(t,n){function r(e,t){i[e]=t}var o="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),i={};r("Mod-z",e.History.undo),r("Mod-Z",e.History.undo),r("Shift-Mod-z",e.History.redo),r("Shift-Mod-Z",e.History.redo),r("Shift-Enter",function(e,t,n){var r=n.state.selection.ranges[0].$from.pos,o=n.state.schema.node("br"),i=n.state.selection.ranges[0].$from.marks(),s=n.state.tr.insert(r,o);return s=s.setStoredMarks(i),n.dispatch(s),!0}),o||(r("Mod-y",e.History.undo),r("Mod-Y",e.History.undo)),t.marks.strong&&(r("Mod-b",e.Commands.toggleMark(t.marks.strong)),r("Mod-B",e.Commands.toggleMark(t.marks.strong))),t.marks.em&&(r("Mod-i",e.Commands.toggleMark(t.marks.em)),r("Mod-I",e.Commands.toggleMark(t.marks.em))),t.marks.underline&&(r("Mod-u",e.Commands.toggleMark(t.marks.underline)),r("Mod-U",e.Commands.toggleMark(t.marks.underline))),t.marks.link&&(r("Mod-k",function(e,t,r){return n.menubar.showLinkInput(),!0}),r("Mod-K",function(e,t,r){return n.menubar.showLinkInput(),!0})),t.marks.strikeThrough&&(r("Shift-Mod-x",e.Commands.toggleMark(t.marks.strikeThrough)),r("Shift-Mod-X",e.Commands.toggleMark(t.marks.strikeThrough)));var s=e.Commands.chainCommands;return i.Enter=s(e.Commands.splitBlockKeepMarks),i};return{generate:t}}(ProseMirror),MenubarView=function e(t,n,r,o){var i=function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},s=function(e,t){var r=n.Commands.toggleMark(t);r(e.state,e.dispatch)},a={strong:"rte-bold",em:"rte-italic",underline:"rte-underline",highlight:"rte-highlight",link:"rte-link",strikeThrough:"rte-strikethrough"},c=function(e){var t=e.state.tr,r=e.state.selection.$cursor;if(!r){var o=e.state.selection.ranges[0];o.$to.pos===e.state.doc.content.size?cursorPositionObject=e.state.doc.resolve(o.$to.pos-1):cursorPositionObject=o.$to;var i=new n.State.TextSelection(cursorPositionObject);e.dispatch(t.setSelection(i))}},e=function(e,n){this.editorView=e,this.options=n,this.el=this.createElement(),this.doPostRenderingActions(),this.$el=t(this.el),this.events={"click #rte-bold":this.applyStyle.bind(this,this.editorView.state.schema.marks.strong),"click #rte-italic":this.applyStyle.bind(this,this.editorView.state.schema.marks.em),"click #rte-underline":this.applyStyle.bind(this,this.editorView.state.schema.marks.underline),"click #rte-highlight":this.applyStyle.bind(this,this.editorView.state.schema.marks.highlight),"click #rte-strikethrough":this.applyStyle.bind(this,this.editorView.state.schema.marks.strikeThrough),"click #rte-emoji":this.addEmoji.bind(this),"click #rte-link":this.showLinkInput.bind(this),"click #rte-link-sbmt-btn":this.addLink.bind(this),"click #rte-link-rmv-btn":this.removeLink.bind(this),"click #rte-link-cncl-btn":this.cancelLink.bind(this),"keydown #rte-link-input":this.listenToKeyboardShortcuts.bind(this)},this.addEventListeners(),this.addModelEventListeners()};return prototype={addEventListeners:function(){for(var e in this.events){var t=e.split(" ")[0],n=e.split(" ")[1],r=this.events[e];this.$el.on(t+".richtext-events",n,r)}},removeEventListeners:function(){for(var e in this.events){var t=(e.split(" ")[0],e.split(" ")[1]),n=this.events[e];this.$el.off(".richtext-events",t,n)}},createElement:function(){var e=document.querySelector("#richtexteditor-menubar-view").innerHTML,t=document.createElement("div");t.setAttribute("id","rte-menubar");var n=Handlebars.compile(e),r=[],s={},a=[o.BOLD,o.ITALIC,o.UNDERLINE,o.HIGHLIGHT,o.STRIKETHROUGH,o.LINK,o.ATMENTION,o.EMOJI];a.forEach(function(e){s[e]=!1});for(var c in this.editorView.state.schema.marks)s[c]=!0;var f=this.options.features||[];return f.forEach(function(e){"string"==typeof e?s[e]=!0:e.mount?(r.push(e.name),s.mount=r):s[e.name]=!0},this),t.innerHTML=n(s),i(this.editorView.dom,t),t},doPostRenderingActions:function(){var e=0;if(this.options.features.forEach(function(t){t.mount&&e++}),e){var t=this.el.querySelector("#rte-fixed-icons"),n=this.el.querySelector("#rte-mount-icon-seperator");t.style.right=28*e+"px",n.style.right=28*e+"px"}},addModelEventListeners:function(){this.editorView.dom.addEventListener("activateMarks",this.activateButtons.bind(this)),this.editorView.dom.addEventListener("deactivateMarks",this.deactivateButtons.bind(this)),this.editorView.dom.addEventListener("editorFocusedOnClick",this.cancelLink.bind(this))},listenToKeyboardShortcuts:function(e){27===e.keyCode?(this.cancelLink(),e.preventDefault(),e.stopPropagation()):13===e.keyCode&&(this.addLink(),e.preventDefault(),e.stopPropagation())},applyStyle:function(e){s(this.editorView,e),this.editorView.focus()},activateButtons:function(e){this.marks=e.detail,this.marks.forEach(function(e){this.$el.find("#"+a[e]).addClass("is-applied")},this)},deactivateButtons:function(e){this.marks=e.detail,this.marks.forEach(function(e){this.$el.find("#"+a[e]).removeClass("is-applied")},this)},drawDecorations:function(e,t,n){RTECustomPlugins.highlight.apply(e,t,n)},removeDecorations:function(e){RTECustomPlugins.highlight.remove(e)},addEmoji:function(){var e=this.editorView.state.tr.setMeta("showEmojiDropDown",{});this.editorView.dispatch(e)},showLinkInput:function(){var e=r.getLink(this.editorView),t=r.getLinkRange(this.editorView);if(!e){var n=this.editorView.state.doc.textBetween(t.start,t.end);n=n.trim();var o=/(^|\s)(https?|www\.)(:\/\/)?[\-.\w]+(\/?)([a-zA-Z0-9;\-\.\?\,\:\'\~\/\\\+=&amp;!()?%<>\$#_@*^]*)?$/,i=n.match(o);if(i)return void r.addLink(n,this.editorView)}this.drawDecorations(this.editorView,t.start,t.end),this.$el.find("#rte-link-input").val(e),this.$el.find("#rte-link-container").show(),this.editorView.dom.dispatchEvent(new CustomEvent("linkInputOpen")),e&&this.$el.find("#rte-link-rmv-btn").show()||this.$el.find("#rte-link-rmv-btn").hide(),this.$el.find("#rte-link-input").focus()},addLink:function(){this.$el.find("#rte-link-container").hide(),this.editorView.dom.dispatchEvent(new CustomEvent("linkInputClose"));var e=this.$el.find("#rte-link-input").val();if(e){var t="https?://",n=new RegExp(t),o=new RegExp("mailto:");null==e.match(n)&&null==e.match(o)&&(e="http://"+e),e&&r.addLink(e,this.editorView)}this.removeDecorations(this.editorView),this.editorView.focus(),c(this.editorView)},removeLink:function(){this.$el.find("#rte-link-container").hide(),this.editorView.dom.dispatchEvent(new CustomEvent("linkInputClose")),r.removeLink(this.editorView),this.removeDecorations(this.editorView),this.editorView.focus(),c(this.editorView)},cancelLink:function(){this.$el.find("#rte-link-container").hide(),this.editorView.dom.dispatchEvent(new CustomEvent("linkInputClose")),this.$el.find("#rte-link-input").val(""),this.removeDecorations(this.editorView),this.editorView.focus(),c(this.editorView)},destroy:function(){this.$el.find("#rte-link-container").hide(),this.editorView.dom.dispatchEvent(new CustomEvent("linkInputClose")),this.removeEventListeners(),this.$el.remove(),this.removeDecorations(this.editorView)}},e.prototype.createElement=prototype.createElement,e.prototype.addEventListeners=prototype.addEventListeners,e.prototype.addModelEventListeners=prototype.addModelEventListeners,e.prototype.activateButtons=prototype.activateButtons,e.prototype.deactivateButtons=prototype.deactivateButtons,e.prototype.showLinkInput=prototype.showLinkInput,e.prototype.addEmoji=prototype.addEmoji,e.prototype.addLink=prototype.addLink,e.prototype.removeLink=prototype.removeLink,e.prototype.cancelLink=prototype.cancelLink,e.prototype.applyStyle=prototype.applyStyle,e.prototype.listenToKeyboardShortcuts=prototype.listenToKeyboardShortcuts,e.prototype.destroy=prototype.destroy,e.prototype.drawDecorations=prototype.drawDecorations,e.prototype.removeDecorations=prototype.removeDecorations,e.prototype.removeEventListeners=prototype.removeEventListeners,e.prototype.doPostRenderingActions=prototype.doPostRenderingActions,e}(jQuery,ProseMirror,RTELink,RTEConstants),NodeSerializer=function(e,t,n){var r=function(e,t,n){var r=[];n.length&&(r=r.concat(n));var o=t.marks.link.isInSet(r);return o||r.push(t.mark("link",{href:e})),a(e,r)},o=function(e){var t=e.content,n=[];return t.forEach(function(e){if(e.isLeaf&&e.isText){var t=[e];t=s(t),n=n.concat(t)}else e.isLeaf&&!e.isText?n.push(e):n.push(i(this.serializeFragment(e.content),e.type.name))},this),ProseMirror.Model.Fragment.fromArray(n)},i=function(t,n){return e.node(n,null,t)},s=function(e){var n=[],r=u[t].replaceNodesMatchingRegex;return e.forEach(function(e){n=n.concat(r(e))},this),n},a=function(t,n){var r;return r=n?e.text(t,n):e.text(t)},c=function(t){for(var n,o=t.text,i=/(https?|www\.)(:\/\/)?[\-.\w]+(\/?)([a-zA-Z0-9;\-\.\?\,\:\'\/\\\+=&amp;!()?%<>\$#_@*^]*)?/,s=o.match(i),c=null,f=null,l=[],p=t.marks;s;)c=s.index,f=s[0].length,textElement=o.slice(0,c),n=o.slice(c,c+f),textElement&&l.push(a(textElement,p)),l.push(r(n,e,p)),o=o.slice(c+f),s=o.match(i);return o&&l.push(a(o,p)),l},f=function(e){var t=e.text,r=e.marks,o=t.split(" "),i=[],s="",c=n.hasZomoji,f=ProseMirror.Emoji.getShortCutList(),u=ProseMirror.Emoji.getEmojiList(),h=c?ProseMirror.Emoji.getZomojiList():{};return o.forEach(function(e,t){var n=f[e]||e,o=u[n],c=h[n];o?(s&&(i.push(a(s,r)),s=""),t&&i.push(a(" ",r)),i.push(l(o))):c?(s&&(i.push(a(s,r)),s=""),t&&i.push(a(" ",r)),i.push(p(n))):s+=t?" "+e:e}),s&&i.push(a(s,r)),i},l=function(t){var n=t.map(function(e){return"0"+e.slice(2)}),r=e.text(String.fromCodePoint.apply(null,n));return r},p=function(t){t=ProseMirror.Emoji.getTrimmedEmojiName(t);var n=e.nodes.emoji.create({emojiName:t});return n},u={link:{replaceNodesMatchingRegex:c},emoji:{replaceNodesMatchingRegex:f}};return{serializeFragment:o}},RTECustomPlugins=function(){var e=function(){return new ProseMirror.State.Plugin({props:{handleDOMEvents:{keydown:function(e,t){t.stopPropagation()}}}})},t=function(e){return new ProseMirror.State.Plugin({props:{handleDOMEvents:{keydown:function(t,n){e(n)}}}})},n=function(e){return new ProseMirror.State.Plugin({state:{init:function(){return{placeholder:e}},apply:function(e,t){return e.getMeta("setPlaceholder")?(placeholder=e.getMeta("setPlaceholder"),{placeholder:placeholder}):t}},props:{decorations:function(e){var t=e.doc,n=this.getState(e).placeholder,r=function(e){if(1===t.childCount&&e.isTextblock&&0===e.content.size)return ProseMirror.View.DecorationSet.create(t,[ProseMirror.View.Decoration.node(0,e.nodeSize,{class:"rte-placeholder","data-text":n})])};return r(t.firstChild)}}})},r=function(e){var t=function(e,t){if(t.state.selection.$from.pos===t.state.selection.$to.pos){var n=t.state.selection.$cursor;return e.isInSet(t.state.storedMarks||n&&n.marks())}return t.state.doc.rangeHasMark(t.state.selection.$from.pos,t.state.selection.$to.pos,e)},n=function(n){var r=[],o=e.marks;for(var i in o)t(o[i],n)&&r.push(i);return r};return new ProseMirror.State.Plugin({view:function(){return{update:function(t){var r=n(t),o=[];for(var i in e.marks)r.indexOf(i)<0&&o.push(i);t.dom.dispatchEvent(new CustomEvent("activateMarks",{detail:r})),t.dom.dispatchEvent(new CustomEvent("deactivateMarks",{detail:o}))}}}})},o={apply:function(e,t,n){var r=e.state.tr.setMeta("drawDecorations",{fromPos:t,toPos:n,type:"apply"});e.dispatch(r)},remove:function(e){var t=e.state.tr.setMeta("drawDecorations",{type:"remove"});e.dispatch(t)}},i=function(){var e=ProseMirror.View.Decoration,t=ProseMirror.View.DecorationSet;return new ProseMirror.State.Plugin({state:{init:function(){return t.empty},apply:function(n,r){if(n.getMeta("drawDecorations")){var o=n.getMeta("drawDecorations"),i=o.fromPos,s=o.toPos,a=o.type;return"apply"===a?t.create(n.doc,[e.inline(i,s,{class:"rte-link-decoration"})]):"remove"===a?t.empty:void 0}}},props:{decorations:function(e){return this.getState(e)}}})},s=function(e){var t=NodeSerializer(e,"link"),n=/(^|\s)(https?|www\.)(:\/\/)?[\-.\w]+(\/?)([a-zA-Z0-9;\-\.\?\,\:\'\~\/\\\+=&amp;!()?%<>\$#_@*^]*)?$/;return new ProseMirror.State.Plugin({props:{transformPasted:function(e){var n=t.serializeFragment(e.content),r=new ProseMirror.Model.Slice(n,e.openStart,e.openEnd);return r}},appendTransaction:function(e,t,r){var o=ProseMirror.PluginUtils.getWordBeforeCurPos(e,t,r);if(o){var i=o.word,s=o.end,a=i.match(n);if(a){var c=a[0].trim(),f="https?://",l=new RegExp(f),p=new RegExp("mailto:");null==c.match(l)&&null==c.match(p)&&(c="http://"+c);var u=r.tr.addMark(s-a[0].length,s,r.schema.marks.link.create({href:c}));return u}}}})},a=function(){return new ProseMirror.State.Plugin({props:{handleClick:function(e){e.dom.dispatchEvent(new CustomEvent("editorFocusedOnClick"))}}})};return{SandboxKeyDownEventsPlugin:e,keyEventHandlersPlugin:t,placeholderPlugin:n,ActiveMarksPlugin:r,drawDecorationsPlugin:i,highlight:o,throwDomEventsPlugin:a,LinkDetectionPlugin:s}}(),RichTextEditorView=function e(t,n,r,o,i){var s={formats:[o.BOLD,o.HIGHLIGHT,o.ITALIC,o.UNDERLINE,o.LINK,o.STRIKETHROUGH],features:[],menubar:!0,placeholder:""},a=function(e){var t={},n=e.options;t.schema=e.generateSchema(n),t.plugins=m(n,t.schema,e);var r=n.content;return"object"==typeof r?t.doc=ProseMirror.Model.Node.fromJSON(t.schema,r):"string"==typeof r&&(t.doc=k(r,t.schema)),ProseMirror.State.EditorState.create(t)},c=function(e){var t={style:""};return t.class=e.className?e.className+" ui-rte-editor":"ui-rte-editor",t},f={};!function(){f[o.ATMENTION]="autosuggestions",f[o.EMOJI]="emoji"}();var l=function(e,t){var n=new ProseMirror.State.PluginKey(f[e]);return t.pluginKeys[e]=n,n},p={mentions:{addNodes:function(e){return ProseMirror.Mentions.addMentionNodes(ProseMirror.Mentions.addTagNodes(e.spec.nodes))},getPlugin:function(e,t){var n=null,r={hashtagTrigger:!1,getSuggestions:e.getSuggestions,getSuggestionsHTML:function(e,t){if("mention"===t){var r={};if(r.suggestions=e,!n){var o=document.getElementById("atmention-dropdown-container").innerHTML;n=Handlebars.compile(o)}return n(r)}},extras:e.extras};return ProseMirror.Mentions.getMentionsPlugin(r,t)},addPlugin:function(e,t,n){l(o.ATMENTION,n);var r=this.getPlugin(t,n);e.push(r)}},emoji:{addNodes:function(e,t){return t.hasZomoji?ProseMirror.Emoji.addEmojiNode(e.spec.nodes):e.spec.nodes},getPlugin:function(e,t,n){return ProseMirror.Emoji.getEmojiPlugin(t,n,e.hasZomoji)},addPlugin:function(e,t,n,r){l(o.EMOJI,n);var i=this.getPlugin(t,n,r);e.push(i)}}},u=function(e,t){return new ProseMirror.Model.Schema({nodes:e,marks:t})},h=function(e,t){var n=t.features;return n.forEach(function(t){var n=p[t.name];n&&n.addNodes&&(nodes=n.addNodes(e,t),e=u(nodes,e.spec.marks))}),e},d=function(e,t){var n={},r=t.formats;return r.forEach(function(t){n[t]=e[t]}),n},m=function(e,t,r){var o=[];o.push(ProseMirror.History.history());var s=e.features;return s.forEach(function(e){var n=p[e.name];n&&n.addPlugin&&n.addPlugin(o,e,r,t)}),e.onKeyPress&&o.push(i.keyEventHandlersPlugin(e.onKeyPress)),o.push(i.drawDecorationsPlugin()),o.push(i.throwDomEventsPlugin()),o.push(ProseMirror.Keymap.keymap(n.generate(t,r))),o.push(ProseMirror.Keymap.keymap(ProseMirror.Commands.baseKeymap)),o.push(i.SandboxKeyDownEventsPlugin()),e.menubar&&o.push(i.ActiveMarksPlugin(t)),e.placeholder&&o.push(i.placeholderPlugin(e.placeholder)),o.push(i.LinkDetectionPlugin(t)),o},v=function(e,t){var n=[];return t.content.nodesBetween(0,t.content.size,function(t,r,o,i){t.type.name===e&&n.push(t.attrs)}),n},g=function(e,t){return t.text(e)},y=function(e,t){var n={name:e.split("@")[1],email:e.slice(1)};return t.node("mention",n)},x=function(e,t){var n=t.mark("link",{href:e});return t.text(e,n)},w=function(e){for(var t=[],n=/@([\w\.\+-]+)@([\w-]+)\.([a-zA-Z\.]{2,22}(\.[a-zA-Z]{2}){0,2})/g,r=n.exec(e);null!==r;r=n.exec(e))t.push({start:r.index,end:r.index+r[0].length,type:"mention"});return t},b=function(e){for(var t=[],n=/(^|\s)((http|ftp|https|www\.)(:\/\/|)[\w-]+(\.[\w-]+)+([\w.,@?^=\(\)%&amp;:\/~+#-]*[\w@?^\(\)=%&amp;\/~+#-])?)($|\s)/g,r=n.exec(e);null!==r;r=n.exec(e)){var o=r[1].length,i=r[2],s=o+r.index;t.push({start:s,end:s+i.length,type:"link"})}return t},k=function(e,t){var n=/\n/,r=e.split(n),o=[];return r.forEach(function(e){for(var n=w(e),r=b(e),i=n.concat(r).sort(function(e){return e.start}),s=[],a="",c=function(e){return i.filter(function(t){return t.start===e})[0]},f=0;f<=e.length;){var l=c(f),p=f===e.length-1;if(l&&a&&(s.push(g(a,t)),a=""),l&&"mention"===l.type){var u=y(e.substring(l.start,l.end),t);s.push(u),f+=l.end-l.start}else if(l&&"link"===l.type){var h=x(e.substring(l.start,l.end),t);s.push(h),f+=l.end-l.start}else a+=e[f],f++;p&&a&&(s.push(g(a,t)),a="")}o.push(S("paragraph",s,t))}),S("doc",o,t)},S=function(e,t,n){return t?n.node(e,null,t):n.node(e)},M=function(e){var t={};return e.forEach(function(e){t[e.name]=e}),t},O=function(e,t){var n=t.selection.ranges[0],r=t.doc.content.size,o=t.selection.$cursor,i=n.$from.pos<=1,s=n.$to.pos<r&&n.$to.pos+1;if(s&&o){var a=t.storedMarks||o.marks(),c=e.state.schema.marks.link.isInSet(a);c&&(i&&!t.docChanged||!e.state.schema.marks.link.isInSet(t.doc.resolve(s).marks()))&&t.removeStoredMark(c)}return t},C=function(e){this.state.schema.marks.link&&(e=O(this,e)),this.updateState(this.state.apply(e))},T=function(){return{ignoreMutation:function(e){return"attributes"==e.type&&"id"===e.attributeName}}},E=function(){return{paragraph:T}},N=function(e){var t=e.editorView.state,n=NodeSerializer(t.schema,"emoji",{hasZomoji:e._featureMap.emoji.hasZomoji}),r=n.serializeFragment(t.doc.content),o=t.tr.replaceWith(0,t.doc.content.size,r);e.editorView.dispatch(o)},e=function(e,t){this.options=Object.assign({},s,t),this.pluginKeys={},this.proofing=null,this._featureMap=M(this.options.features),this.init(e)},j={init:function(e){var t=a(this),n=c(this.options);if(e.innerHTML="",this.editorView=new ProseMirror.View.EditorView(e,{state:t,attributes:n,dispatchTransaction:C,nodeViews:E()}),this.options.menubar!==!1&&(this.menubar=new r(this.editorView,this.options)),this._featureMap[o.PROOFING]){var i=this;this.initializeProofing(this.editorView.dom,function(e){var t=i._featureMap[o.PROOFING].afterInit;t&&t(e),i.proofing=e})}},initializeProofing:function(e,t){ZBluePencil.onLoad(function(){var n=ZBluePencil.getInstance(e,{show_card_icon:!1});t(n)})},getJSON:function(){var e=this.editorView.state.doc.toJSON();try{this._featureMap.emoji&&N(this),e=this.editorView.state.doc.toJSON()}catch(e){ZWLogger.log("Error in RichtextEditor While serialising nodes :: "+e.stack)}return e},focus:function(){this.editorView.focus()},setEditable:function(e){this.editorView.setProps({editable:function(){return e}})},reset:function(e){if(e){this.options.content=e;var t=a(this);this.editorView.updateState(t)}else{var n=this.editorView.state.tr.delete(0,this.editorView.state.doc.content.size);this.editorView.dispatch(n)}},remove:function(){if(this.menubar.destroy(this.editorView),this.editorView.destroy(),this._featureMap[o.PROOFING]){var e=this._featureMap[o.PROOFING].beforeDestroy;this.proofing&&(e(this.proofing),this.proofing.stopProofing(),delete this.proofing),this._featureMap=null}Object.keys(this).forEach(function(e){delete this[e]},this)},isEmpty:function(){var e=this.editorView.state.doc,t=1===e.childCount&&e.firstChild.isTextblock&&0===e.firstChild.content.size;return t},getText:function(e){var t="",n=this.getNodeFromJSON(e,this.options);return n.content.nodesBetween(0,n.content.size,function(e,n,r,o){if("paragraph"===e.type.name&&0!=o&&(t+="\n"),"text"===e.type.name){var i=e.marks.filter(function(e){return"link"===e.type.name}),s=i.length;s?(t+="["+e.text+"]",t+="("+i[0].attrs.href+")"):t+=e.text}else"mention"===e.type.name?t+="@"+e.attrs.email:"br"===e.type.name?t+="\n":"mergefield"===e.type.name?t+=""+e.attrs.fieldId+"":"emoji"===e.type.name&&(t+=":"+e.attrs.emojiName+":")}),t},getNodeAttrsFromJSON:function(e,t){var n=this.getNodeFromJSON(t,this.options);return v(e,n)},generateSchema:function(e){e||(e=Object.assign({},s,e));var n=new ProseMirror.Model.Schema({nodes:t.nodes,marks:d(t.marks,e)});return n=h(n,e)},getNodeFromJSON:function(e,t){var n=this.generateSchema(t),r=ProseMirror.Model.Node.fromJSON(n,e);return r},setproofing:function(e){this.proofing=e},getproofing:function(){return this.proofing},removeproofing:function(){this.proofing=null},hasproofing:function(){return!!this.proofing},getRTEElement:function(){return this.editorView.dom},setPlaceholder:function(e){var t=this.editorView.state.tr.setMeta("setPlaceholder",e);this.editorView.dispatch(t)},insertMergeField:function(e){var t=this.editorView;if(t.state.schema.nodes.mergefield){var n=t.state.schema.nodes.mergefield.create(e),r=t.state.tr.replaceWith(t.state.selection.$from.pos,t.state.selection.$to.pos,n),o=t.state.apply(r);t.updateState(o),t.focus()}},getMountedNode:function(e){var t="#rte-mount-"+e;return this.menubar.el.querySelector(t)},handleScroll:function(){Object.keys(this.pluginKeys).forEach(function(e){var t=this.pluginKeys[e].get(this.editorView.state);t.props.handleExternalScroll&&t.props.handleExternalScroll()},this)}};return e.prototype.init=j.init,e.prototype.getJSON=j.getJSON,e.prototype.focus=j.focus,e.prototype.setEditable=j.setEditable,e.prototype.reset=j.reset,e.prototype.remove=j.remove,e.prototype.isEmpty=j.isEmpty,e.prototype.getText=j.getText,e.prototype.getNodeAttrsFromJSON=j.getNodeAttrsFromJSON,e.prototype.generateSchema=j.generateSchema,e.prototype.getNodeFromJSON=j.getNodeFromJSON,e.prototype.isViewDestroyed=j.isViewDestroyed,e.prototype.getRTEElement=j.getRTEElement,e.prototype.initializeProofing=j.initializeProofing,e.prototype.insertMergeField=j.insertMergeField,e.prototype.getMountedNode=j.getMountedNode,e.prototype.setPlaceholder=j.setPlaceholder,e.prototype.handleScroll=j.handleScroll,e}(Schema,Shortcuts,MenubarView,RTEConstants,RTECustomPlugins),RichTextEditor=function(e,t,n){var r=function(t,r){var o=n.prototype.getNodeFromJSON(t,r),i=document.createElement("div"),s=n.prototype.generateSchema(r);i.style.display="none";var a=e.Model.DOMSerializer.nodesFromSchema(s),c=e.Model.DOMSerializer.marksFromSchema(s);a.paragraph=function(e){return e.content.size?["p",{style:"margin: 0px; line-height: 22px;"},0]:["p",{style:"margin: 0px; line-height: 22px;"},["br"]]};var f=new e.Model.DOMSerializer(a,c);return f.serializeFragment(o.content,window.document,i),i.innerHTML},o=function(e,t){return new n(e,t)};return{init:o,getHTML:r,CONST:t}}(ProseMirror,RTEConstants,RichTextEditorView);ZWRichTextEditor=function(){var e=!1,t=function(){return{fromEditor:!!editor.getView,zcUser:!(!editor.getView||!ReviewUtil.isZohoCorpUser()),forHTML:!1,isRemoteEdtior:!(!Macros||!Macros.isRemote())}},n={strong:{type:"formats",add:function(e,t){e.formats.push(t)}},em:{type:"formats",add:function(e,t){e.formats.push(t)}},underline:{type:"formats",add:function(e,t){e.formats.push(t)}},strikeThrough:{type:"formats",add:function(e,t){e.formats.push(t)}},highlight:{type:"formats",add:function(e,t){e.formats.push(t)}},link:{type:"formats",add:function(e,t){e.formats.push(t)}},proofing:{type:"features",canAdd:function(e){return e.fromEditor&&!e.forHTML&&c()},add:function(e,t,n){this.canAdd(n)&&e.features.push(i())}},mergefield:{type:"features",add:function(e,t,n){e.features.push(t)}},emoji:{type:"features",canAdd:function(e){return!e.isRemoteEdtior},add:function(e,t,n){this.canAdd(n)&&("string"==typeof t?e.features.push({name:t}):e.features.push(t))}}},r=function(e,r){var o=e.includes||[],i=e.excludes||[];e.formats=e.formats||[],e.features=e.features||[];var s=[RTEConstants.BOLD,RTEConstants.ITALIC,RTEConstants.UNDERLINE,RTEConstants.STRIKETHROUGH,RTEConstants.LINK,RTEConstants.HIGHLIGHT,RTEConstants.PROOFING,RTEConstants.EMOJI];o.forEach(function(e){var t="string"==typeof e?e:e.name,n=s.indexOf(t);n>-1?s[n]=e:s.push(e)}),i.forEach(function(e){var t="string"==typeof e?e:e.name,n=s.indexOf(t);n>-1&&s.splice(n,1)});var a=t();return a.forHTML=r,s.forEach(function(t){var r="string"==typeof t?t:t.name;n[r].add(e,t,a)}),delete e.includes,delete e.excludes,e},o=function(t,n){editor.getView&&!e&&l();var n=n||{};return r(n),RichTextEditor.init(t,n)},i=function(){var e=null;return{name:RichTextEditor.CONST.PROOFING,afterInit:function(t){a(t),e=s(t)},beforeDestroy:function(){e&&e(),e=null}}},s=function(e){var t=function(){a(e)},n=function(t){Proofing.isSupportedLanguage(t)?a(e):e.stopProofing()};return PubSub.subscribe(["Document/SpellCheck/Toggled","Document/Grammar/Toggled"],t),PubSub.subscribe("Document/LanguageChanged",n),function(){PubSub.unsubscribe(["Document/SpellCheck/Toggled","Document/Grammar/Toggled"],t),PubSub.unsubscribe("Document/LanguageChanged",n)}},a=function(e){var t=Proofing.getLanguage();Proofing.isSpellCheckEnabled()&&Proofing.isGrammarEnabled()&&Proofing.isGrammarSupportedLanguage(t)?e.checkGrammar(t):Proofing.isSpellCheckEnabled()?e.checkSpell(t):e.stopProofing()},c=function(){return editor.getRole().permissions.can("document.edit")&&"undefined"!=typeof ZBluePencil},f=function(){ZWP.PopupUtils.hideAllCards()},l=function(){!e&&c()&&ZBluePencil.onLoad(function(){PubSub.subscribe(["Document/ScrollEvent","Commentpane/ScrollEvent"],f),e=!0})},p=function(e,t){t=t||{},t.includes=t.includes||[],t.includes.push({name:"mergefield"});var n=u(e,t),r=document.createElement("div");return r.innerHTML=n,r.childNodes.forEach(function(e){var t=e.querySelectorAll("span[mm-field-name][mm-field-id]:not(.js-image-field)");t.forEach(function(e){e.innerText=""+e.getAttribute("mm-field-id")+""})}),r.innerHTML},u=function(e,t){var t=t||{};return r(t,!0),RichTextEditor.getHTML(e,t)};return{init:o,getRTEProofing:i,subscribeProofingEvents:l,isProofingEnabled:c,getHTMLforMergeField:p,getHTML:u}}();